var __originalDefine;
if (typeof define==="function" && define.amd) {
  __originalDefine = define;
  define = undefined; 
}
var __originalRequireJs;
if (typeof requirejs==="function" && requirejs.load) {
  __originalRequireJs = requirejs;
  requirejs = undefined; 
}

(function() {
var require=function(){function t(t){this.name="CircularDependencyError",this.message=t}function n(t){this.name="ArgumentError",this.message=t}function e(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function o(t,n,e){Q.push.apply(Q,arguments)}function r(){try{for(;Q.length;){var t=Q.shift();t()}W=!1}finally{W=Q.length>0,Q.length&&setTimeout(r,0)}}function i(){!W&&Q.length>0&&(Y?(W=!0,setTimeout(r,0)):r())}function u(t){try{W=!0,t(),W=!1,i()}finally{W=!1,Q.length&&setTimeout(i,0)}}function c(t){var n=t.match(ot),e=n&&{scheme:n[2],host:n[4],path:n[5],query:n[7],fragment:n[9]};return e}function a(t){var n="";return t.scheme&&(n+=t.scheme+":"),t.host&&(n+="//"+t.host),t.host&&t.path&&"/"!=t.path.charAt(0)&&(url+="/"),t.path&&(n+=t.path),t.query&&(n+="?"+t.query),n.fragment&&(n+="#"+t.fragment),n}function f(t){var n="undefined"==typeof location?{}:c(location.toString()),t=c(t);return!t.scheme&&!t.host||t.scheme===n.scheme&&t.host===n.host}function s(t){var n="undefined"==typeof location?{}:c(location.toString()),t=c(t);return t.scheme=n.scheme,t.host=n.host,a(t)}function l(t){for(var n,e=t.split("/"),o=[],r=0,i=e.length;r<i;r++)switch(n=e[r]){case"":0!=r&&r!=i-1||o.push(n);break;case".":break;case"..":if(o.length>1||1==o.length&&""!=o[0]&&"."!=o[0]){o.pop();break}default:o.push(n)}return o.join("/")}function h(t,n){var e=t;return"."==t.charAt(0)&&("/"==t.charAt(1)||"."==t.charAt(1)&&"/"==t.charAt(2))&&(n?"/"!=n.charAt(n.length-1)&&(n+="/"):n="",e=n+t),e}function d(t){if(!t)throw new n("Invalid root URI.");tt="/"==t.charAt(t.length-1)?t.slice(0,-1):t}function p(t){nt="/"==t.charAt(t.length-1)?t:t+"/"}function m(t){for(var n=t.split("/"),e=0,o=n.length;e<o;e++)n[e]=encodeURIComponent(n[e]);if(t=n.join("/"),"/"==t.charAt(0)){if(!tt)throw new Error('Attempt to retrieve the root module "'+t+'" but no root URI is defined.');return tt+t}if(!nt)throw new Error('Attempt to retrieve the library module "'+t+'" but no libary URI is defined.');return nt+t}function v(t,n){return new Function(t)}function y(t,n){var e=ut._compileFunction||v;return e.apply(this,arguments)}function g(t){if(t==parseInt(t),!(t>0))throw new n("Value must be a positive integer.");J=t,j()}function w(t){Z=t}function b(){for(var t=!1,n=0,e=rt.length;n<e;n++){try{t=rt[n]()}catch(o){continue}break}return t}function A(t,n,e,o){function r(t){200==t.status?e(void 0,t.responseText):e(!0,void 0)}var o=o||b();if(!o)throw new Error("Error making remote request.");o.open("GET",t,!!n),n?(o.onreadystatechange=function(t){4==o.readyState&&r(o)},o.send(null)):(o.send(null),r(o))}function E(t,n){var e=new XDomainRequest;e.open("GET",t),e.error(function(){n(!0,void 0)}),e.onload(function(){n(void 0,request.responseText)}),e.send()}function T(t,n){var e=Z,o=function(n,o){if(n)O(t,null);else if(e)y(o,t)();else{var r=y("return (function (require, exports, module) {"+o+"\n})",t)();O(t,r)}},r=m(t);if(e&&(r+="?callback="+encodeURIComponent(Z+".define")),f(r))A(r,n,o);else{var i=b();i&&void 0!==i.withCredentials?A(r,n,o,i):n&&"undefined"!=typeof XDomainRequest?E(r,o):A(s(r),n,o)}}function R(t){var n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,e=document.createElement("script");if(void 0!==e.async?e.async="true":e.defer="true",e.type="application/javascript",e.src=m(t)+"?callback="+encodeURIComponent(Z+".define"),et<1/0){var o=setTimeout(function(){o=void 0,O(t,null)},et);N[t].unshift(function(){void 0===o&&clearTimeout(o)})}n.insertBefore(e,n.firstChild)}function x(t,n){e(N,t)?N[t].push(n):(N[t]=[n],q(t))}function q(t){V.push(t),j()}function j(){if(V.length>0&&z<J){var t=V.pop();z++,N[t].unshift(function(){z--,j()}),Z&&"undefined"!=typeof document&&document.readyState&&/^loaded|complete$/.test(document.readyState)?R(t):T(t,!0)}}function I(t,n){T(t,!1),n()}function M(t){return e(B,t)}function X(n,o){if(M(n)){var r=B[n];o(r)}else{if(e(K,n))throw new t("Encountered circular dependency.");if(!S(n))throw new Error("Attempt to load undefined module.");if(null===$[n])o(null);else{var i=$[n],u={id:n,exports:{}},c=it(n);G||(G=u);try{K[n]=!0,i(c,u.exports,u),B[n]=u,delete K[n],o(u)}finally{delete K[n]}}}}function U(t,n,e){var o=["",".js","/index.js"];"/"==t.charAt(t.length-1)&&(o=["index.js"]);var r=o.length,i=function(u){if(u<r){var c=t+o[u],a=function(){X(c,function(t){null===t?i(u+1):e(t)})};S(c)?a():n(c,a)}else e(null)};i(0)}function k(t,n){o(function(){U(t,x,n)})}function C(t){var n,e=Y;Y=!0;try{U(t,I,function(t){n=t})}finally{Y=e}return n}function S(t){return e($,t)}function _(t,e){if("string"!=typeof t||"function"!=typeof e&&null!==e)throw new n("Definition must be a (string, function) pair.");S(t)||($[t]=e)}function L(t){if("object"!=typeof t)throw new n("Mapping must be an object.");for(var o in t)e(t,o)&&_(o,t[o])}function O(t,r){var u;if(1==arguments.length)u=t,L(u);else{if(2!=arguments.length)throw new n("Expected 1 or 2 arguments, but got "+arguments.length+".");var c=t;_(t,r),u={},u[c]=r}for(var c in u)e(u,c)&&e(N,c)&&(o.apply(this,N[c]),delete N[c]);i()}function P(t,e){if(void 0===e){var o=C(t);if(!o)throw new Error('The module at "'+t+'" does not exist.');return o.exports}if("function"!=typeof e)throw new n("Continuation must be a function.");u(function(){k(t,function(t){e(t&&t.exports)})})}function D(t,n){var e=ut._designatedRequire||P;return e.apply(this,arguments)}function F(t,n,e){n=n.toString();var o=l(h(n,t));return D(o,e)}function H(t,e,o){function r(n){a.push(n),e.length>0?F(t,e.shift(),r):o.apply(this,a)}if("function"!=typeof o)throw new n("Final argument must be a continuation.");for(var i=[],u=0,c=e.length;u<c;u++)i[u]=e[u].toString();for(var a=[],u=0,c=e.length;u<c;u++)F(t,i[u],r)}var G=null,B={},$={},K={},N={},V=[],z=0,J=2,Q=[],W=!1,Y=void 0,Z=void 0,tt=void 0,nt=void 0,et=6e4;t.prototype=Error.prototype,n.prototype=Error.prototype;var ot=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,rt=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],it=function(t){function n(n,e){if(arguments.length>2){var o=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1];return H(t,o,e)}return F(t,n,e)}return t=t.replace(/[^\/]+$/,""),n.main=G,n},ut=it("/");return ut._modules=B,ut._definitions=$,ut._designatedRequire=P,ut._compileFunction=v,ut.define=O,ut.setRequestMaximum=g,ut.setGlobalKeyPath=w,ut.setRootURI=d,ut.setLibraryURI=p,ut}();require.define({
  "ep_etherpad-lite/static/js/ace2_common.js": function (require, exports, module) {
function isNodeText(a){return a.nodeType==3}function object(a){var b=function(){};return b.prototype=a,new b}function getAssoc(a,b){return a["_magicdom_"+b]}function setAssoc(a,b,c){a["_magicdom_"+b]=c}function binarySearch(a,b){if(a<1)return 0;if(b(0))return 0;if(!b(a-1))return a;var c=0,d=a-1;while(d-c>1){var e=Math.floor((c+d)/2);b(e)?d=e:c=e}return d}function binarySearchInfinite(a,b){var c=0;while(!b(c))c+=a;return binarySearch(c,b)}function htmlPrettyEscape(a){return Security.escapeHTML(a).replace(/\r?\n/g,"\\n")}var Security=require("./security"),userAgent=((function(){return this}().navigator||{}).userAgent||"node-js").toLowerCase(),browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit|trident)/.test(userAgent),windows:/windows/.test(userAgent),mobile:/mobile/.test(userAgent)||/android/.test(userAgent)},noop=function(){};exports.isNodeText=isNodeText,exports.object=object,exports.browser=browser,exports.getAssoc=getAssoc,exports.setAssoc=setAssoc,exports.binarySearch=binarySearch,exports.binarySearchInfinite=binarySearchInfinite,exports.htmlPrettyEscape=htmlPrettyEscape,exports.noop=noop
}
, "ep_etherpad-lite/static/js/ace2_inner.js": function (require, exports, module) {
function Ace2Inner(){function N(){K.apool=new f,k.enabled&&(k.apool=K.apool),M=a(L,K.apool,{withCallbacks:function(a,b){bv(a,function(){ca(1),b({clearText:function(a){bv("clearText",function(){cJ([0,0],[K.lines.length()-1,K.lines.atIndex(K.lines.length()-1).width-1],"")})},setDocumentAttributedText:function(a){document.DONT_INCORP=!1,bv("setDocAText",function(){bK(a)})},applyChangesetToDocument:function(a,b,c){var d=bt.editEvent.eventType;bt.startNewEvent("nonundoable"),cE(a,b,c),bt.startNewEvent(d)}})})}})}function bg(){return Math.round(bf*4/3)}function bi(){bh=d("dynamicsyntax")}function bj(a){O&&(O.style.height=a+"px")}function bl(a,c){if(typeof a!="string")throw new Error("setAuthorInfo: author ("+a+") is not a string");if(!c)delete bk[a],bh&&bh.removeSelectorStyle(bo(bm(a)));else{bk[a]=c;if(c.bgcolor&&bh){var d=c.bgcolor;typeof c.fade=="number"&&(d=br(d,c.fade));var e=bh.selectorStyle(bo(bm(a))),f=bh.selectorStyle(bo(bm(a))+" > a");e.backgroundColor=d,b.luminosity(b.css2triple(d))<.55?f.color=b.triple2css(b.complementary(b.css2triple(d))):f.color=null}}}function bm(a){return"author-"+a.replace(/[^a-y0-9]/g,function(a){return a=="."?"-":"z"+a.charCodeAt(0)+"z"})}function bn(a){return a.substring(0,7)=="author-"?a.substring(7).replace(/[a-y0-9]+|-|z.+?z/g,function(a){return a=="-"?".":a.charAt(0)=="z"?String.fromCharCode(Number(a.slice(1,-1))):a}):null}function bo(a){return".authorColors ."+a}function bp(){if(bh){var a=bh.selectorStyle("#"+A+" span");a.paddingTop="0px",a.paddingBottom="0px"}}function bq(a){var c=b.css2triple(a);return c=b.saturate(c),c=b.scaleColor(c,0,.5/b.luminosity(c)),b.triple2css(c)}function br(a,c){var d=b.css2triple(a);return d=b.blend(d,[1,1,1],c),b.triple2css(d)}function bs(a){L.setTimeout(function(){alert(a)},0)}function bu(a,b,c){function e(){d=!0,Y.profile()}function f(a){return{eventType:a,backset:null}}function g(a){if(K.selStart&&K.selEnd){var b=K.lines.offsetOfIndex(K.selStart[0])+K.selStart[1],c=K.lines.offsetOfIndex(K.selEnd[0])+K.selEnd[1];a.selStart=b,a.selEnd=c,a.selFocusAtStart=K.selFocusAtStart}if(k.enabled){var d=!1;try{a.eventType=="setup"||a.eventType=="importText"||a.eventType=="setBaseText"?k.clearHistory():a.eventType=="nonundoable"?a.changeset&&k.reportExternalChange(a.changeset):k.reportEvent(a),d=!0}finally{d||(k.enabled=!1)}}}function h(a,b){var c=bt.editEvent;return b||g(c),bt.editEvent=f(a),c}if(y)return;bt&&Y.error("Can't enter callstack "+a+", already in "+bt.type);var d=!1;c&&(a="noundoable"),bt={type:a,docTextChanged:!1,selectionAffected:!1,userChangedSelection:!1,domClean:!1,profileRest:e,isUserChange:!1,repChanged:!1,editEvent:f(a),startNewEvent:h};var i=!1,j;try{j=b(),hooks.callAll("aceEditEvent",{callstack:bt,editorInfo:z,rep:K,documentAttributeManager:Z}),i=!0}catch(l){throw w.push({error:l,time:+(new Date)}),bd(l.toString()),l}finally{var m=bt;i?(g(m.editEvent),m.domClean&&m.type!="setup"&&(m.selectionAffected&&dv(),(m.docTextChanged||m.userChangedSelection)&&m.type!="applyChangesToBase"&&ei(),m.docTextChanged&&m.type.indexOf("importText")<0&&I())):bt.type=="idleWorkTimer"&&cc.atLeast(1e3),bt=null,d&&Y.profileEnd()}return j}function bv(a,b,c){bt?b():bu(a,b,c)}function bw(a){if(K.lines.containsKey(a)){var b=K.lines.offsetOfKey(a),c=K.lines.atKey(a).width;cf(b,b+c)}}function bx(a){return K.lines.atOffset(a).key}function by(){y=!0,cc&&cc.never(),dK()}function bz(){function a(){throw new Error("checkALines")}return}function bA(a){R=a;var b="doesWrap";dT(O,"doesWrap",R),L.setTimeout(function(){bv("setWraps",function(){ca(7),bE(),dC()})},0)}function bB(a){var b=T;T=!!a,a!=b&&(a||bv("setStyled",function(){ca(12);var a=[];for(var b in cp)a.push([b,""]);cK(0,K.alltext.length,a)}))}function bC(a){be=a,O.style.fontFamily=be,E.style.fontFamily=be,L.setTimeout(function(){bp()},0)}function bD(a){bf=a,O.style.fontSize=bf+"px",O.style.lineHeight=bg()+"px",D.style.lineHeight=bg()+"px",E.style.fontSize=bf+"px",L.setTimeout(function(){bp()},0)}function bE(){cf(0,K.alltext.length)}function bF(a){var b=Q!=a;Q=a,Q?dL(!0):dL(!1),dT(O,"static",!Q),b&&ea("editable.change",Q)}function bG(){return Q}function bH(){bF(Q)}function bI(a,b,c){var d;if(c){if(a.charAt(a.length-1)!="\n")throw new Error("new raw text must end with newline");if(/[\r\t\xa0]/.exec(a))throw new Error("new raw text must not contain CR, tab, or nbsp");d=a.substring(0,a.length-1).split("\n")}else d=_.map(a.split("\n"),cX);var e="\n";d.length>0&&(e=d.join("\n")+"\n"),bv("importText"+(b?"Undoable":""),function(){bL(e)});if(c&&K.alltext!=a)throw new Error("mismatch error setting raw text in importText")}function bJ(a,b,c){a=g.cloneAText(a);if(b){var d=(new f).fromJsonable(b);a.attribs=g.moveOpsToNewPool(a.attribs,d,K.apool)}bv("importText"+(c?"Undoable":""),function(){bK(a)})}function bK(a){ca(8);var b=K.lines.totalWidth(),c=K.lines.length(),d=K.lines.offsetOfIndex(c-1),e=K.lines.atIndex(c-1).text.length,f=g.smartOpAssembler(),h=g.newOp("-");h.chars=d,h.lines=c-1,f.append(h),h.chars=e,h.lines=0,f.append(h),g.appendATextToAssembler(a,f);var i=b+f.getLengthChange(),j=g.checkRep(g.pack(b,i,f.toString(),a.text.slice(0,-1)));cE(j),cU(null,null),cc.atMost(100);if(K.alltext!=a.text)throw new Error("mismatch error setting raw text in setDocAText");dC(),ea("atext.set")}function bL(a){bK(g.makeAText(a))}function bM(){var a=K.alltext,b=a.length;return b>0&&b--,a.substring(0,b)}function bN(){var a=[];for(var b=0;b<K.alines.length;b++){var c=K.alines[b],d=g.opIterator(c);while(d.hasNext()){var e=d.next();if(e.attribs){var f=g.attribsAttributeValue(e.attribs,"img",K.apool);f&&a.push(f)}}}return a}function bO(){return bt&&!bt.domClean&&bv("exportText",function(){ca(2)}),bM()}function bP(){function b(c,d){if(c.hasChildNodes()){var e=c.firstChild;while(e){var f=e.nodeName.toLowerCase();if(f=="iframe"||e.nodeType!=1&&e.nodeType!=3){e=e.nextSibling;continue}if(f=="div"||f=="span"&&e.className||f=="body")b(e,d);else if(e.nodeType==3){var g=document.createTextNode(cA(e));d?d.appendChild(g):a.appendChild(g)}else{var h=document.createElement(f);e.className&&(h.className=e.className),f=="img"&&h.setAttribute("src",e.getAttribute("src")),f=="a"&&h.setAttribute("href",e.getAttribute("href"));if(e.getAttribute("style")){var i=e.getAttribute("style")||"";h.setAttribute("style",i.split("!important").join(""))}d?d.appendChild(h):a.appendChild(h),b(e,h)}if(f=="div"){var j=document.createElement("br");a.appendChild(j)}e=e.nextSibling}}}var a=document.createElement("div"),c=(cA(O)||"").split("\n").join("");return c?(b(O),a.innerHTML):""}function bQ(){dC()}function bR(a){G=a}function bS(a){F=a}function bT(a){I=a}function bU(){bt&&!bt.domClean&&bv("getFormattedCode",cn);var a=[];if(K.lines.length()>0){var b=K.lines.atIndex(0);while(b){var c=b.domInfo;a.push(c&&c.getInnerHTML()||e.processSpaces(e.escapeHTML(b.text),R)||"&nbsp;"),b=K.lines.next(b)}}return'<div class="syntax"><div>'+a.join("</div>\n<div>")+"</div></div>"}function bW(a){a=a.toLowerCase();var b=Array.prototype.slice.call(arguments,1);bV[a]&&bv(a,function(){ca(9),bV[a].apply(bV,b)})}function bX(a,b,c,d,e){bv("replaceRange",function(){cJ(a,b,c,d)},e)}function bY(a,b,c,d){x&&c&&c.push(["author",x]),bv("applyAttributesToRange",function(){Z.setAttributesOnRange(a,b,c)})}function bZ(){return(new Date).getTime()}function b$(a){var b=bZ(),c=0,d=!1,e=!1,f=function(){if(d)return e||(e=!0),!0;var f=bZ()-b;return f>a?(d=!0,!0):(c=f,!1)};return f.elapsed=function(){return bZ()-b},f}function b_(a){function d(){b&&L&&L.clearTimeout&&(L.clearTimeout(b),b=null)}function e(a){d(),c=a;var e=a-bZ();e<0&&(e=0),b=L.setTimeout(f,e)}function f(){b=null,a()}var b=null,c=0;return{atMost:function(a){var d=bZ()+a;(!b||c>d)&&e(d)},atLeast:function(a){var d=bZ()+a;(!b||c<d)&&e(d)},never:function(){d()}}}function ca(a){cn(b$(0))}function cb(){var a=cb,b=a.failures||0;if(b<5){var c=b$(40),d=cn(c);return c()&&(a.failures=b+1),!0}var e=a.skipCount||0;return e++,e==20&&(e=0,a.failures=0),a.skipCount=e,!1}function ce(a){var b=a.id;return b?b:a.id="magicdomid"+cd++}function cf(a,b,c,d){if(b<=a)return;if(a<0||a>=K.lines.totalWidth())return;var e=K.lines.atOffset(a),f=K.lines.offsetOfEntry(e),g=K.lines.indexOfEntry(e),h=!1,i=null,j=null;c=c||noop;var k,l=function(a,b,c){e.domInfo.appendSpan(a,b,c)};if(d){var m=l;l=function(a,b){d(a,b,m,k),k+=a.length}}while(e&&f<b&&!c()){var n=f+e.width;k=f,e.domInfo.clearSpans(),cg(e,l,f),e.domInfo.finishUpdate(),c_(e.lineNode);if(K.selStart&&K.selStart[0]==g||K.selEnd&&K.selEnd[0]==g)h=!0;i===null&&(i=g),j=g,f=n,e=K.lines.next(e),g++}h&&(bt.selectionAffected=!0)}function cg(a,b,c){var d=c;typeof d!="number"&&(d=K.lines.offsetOfEntry(a));var e=a.text,f=a.width;if(e.length===0){var g=i.getLineStyleFilter(0,"",b,K.apool);g("","")}else{var h=0,j=i.getFilterStack(e,b,browser),k=K.lines.indexOfEntry(a),l=K.alines[k];j=i.getLineStyleFilter(e.length,l,j,K.apool),j(e,"")}}function ci(){ch={cleanNodesNearChanges:{}}}function cj(a){var b=bc("getCleanNodeByKey",!1);b.extra=0;var c=P.getElementById(a);while(c&&da(c))b.extra++,c.id="",c=P.getElementById(a);return b.literal(b.extra,"extra"),b.end(),c}function ck(a){var b,c;if(!da(a)){b=a;var d=b.previousSibling,e=b.nextSibling;c=d&&da(d)||e&&da(e)}else{var f=a.previousSibling;while(f&&da(f))f=f.previousSibling;if(f)b=f;else{var g=a.nextSibling;while(g&&da(g))g=g.nextSibling;g&&(b=g)}if(!b)return;c=!0}if(c)ch.cleanNodesNearChanges["$"+ce(b)]=!0;else{var h=ce(b),d=b.previousSibling,e=b.nextSibling,i=d&&ce(d)||null,j=e&&ce(e)||null,k=K.lines.prev(K.lines.atKey(h)),l=K.lines.next(K.lines.atKey(h)),m=k&&k.key||null,n=l&&l.key||null;if(i!=m||j!=n)ch.cleanNodesNearChanges["$"+ce(b)]=!0}}function cl(){function c(a){if(!a||a==O)return null;while(a.parentNode!=O)a=a.parentNode;return a}if(bt.observedSelection)return;bt.observedSelection=!0;var a=bc("getSelection",!1),b=dz();a.end();if(b){var d=c(b.startPoint.node),e=c(b.endPoint.node);d&&ck(d),e&&d!=e&&ck(e)}}function cm(){if(O.getElementsByTagName){var a=O.getElementsByTagName("style");for(var b=0;b<a.length;b++){var c=a[b];while(c.parentNode&&c.parentNode!=O)c=c.parentNode;c.parentNode==O&&ck(c)}}}function cn(a){if(bt.domClean)return!1;dN=!1,bt.isUserChange=!0,a=a||function(){return!1};if(n&&window.DONT_INCORP||window.DEBUG_DONT_INCORP||document.DONT_INCORP)return!1;var b=bc("incorp",!1);O.firstChild||(O.innerHTML="<div><!-- --></div>"),b.mark("obs"),cl(),cm(),b.mark("dirty");var d=c$(),e=!0,f=0,g,h;while(f<d.length){g=d[f][0],h=d[f][1];if(g!==0&&!cj(K.lines.atIndex(g-1).key)||h!=K.lines.length()&&!cj(K.lines.atIndex(h).key)){e=!1;break}f++}if(!e){var i=O.childNodes.length;for(var j=0;j<i;j++){var k=O.childNodes.item(j);k.tagName&&(!k.id||!K.lines.containsKey(k.id))&&ck(k)}d=c$()}ci(),b.mark("getsel");var l=dz(),m,o,p=0,q=[],r=0,s=[];b.mark("ranges"),b.literal(d.length,"numdirt");var t=[];while(p<d.length){var u=d[p];g=u[0],h=u[1];var v=g===0&&O.firstChild||cj(K.lines.atIndex(g-1).key).nextSibling;v=v&&da(v)&&v;var w=h==K.lines.length()&&O.lastChild||cj(K.lines.atIndex(h).key).previousSibling;w=w&&da(w)&&w;if(v&&w){var x=c(T,browser,K.apool,null,bn);x.notifySelection(l);var y=[];for(var z=v;z&&(!z.previousSibling||z.previousSibling!=w);z=z.nextSibling){if(browser.msie)try{z.createTextRange().execCommand("unlink",!1,null)}catch(A){}x.collectContent(z),z.id!="etherpad-paste"&&y.push(z)}x.notifyNextNode(w.nextSibling);var B=x.getLines();if((B.length<=1||B[B.length-1]!=="")&&w.nextSibling){h++;var C=w.nextSibling;x.collectContent(C),s.push(C),x.notifyNextNode(C.nextSibling)}var D=x.finish(),E=D.selStart,F=D.selEnd;B=D.lines;var G=D.lineAttribs,H=D.linesWrapped;!(H>0),E[0]>=0&&(m=[E[0]+g+r,E[1]]),F[0]>=0&&(o=[F[0]+g+r,F[1]]);var I=[],L=w,M=new Array(B.length);for(var j=0;j<B.length;j++){var N=B[j],P=cC(N);I.push(P),M[j]=P.domInfo}t.push([L,M]),_.each(y,function(a){s.push(a)});var Q={};m&&(Q.selStart=m),o&&(Q.selEnd=o),q.push([g+r,h-g,I,G,Q]),r+=B.length-(h-g)}else h>g&&q.push([g+r,h-g,[],[]]);p++}var R=q.length>0;b.mark("splice"),_.each(q,function(a){cQ(a[0],a[1],a[2],a[3],a[4])}),b.mark("insert"),_.each(t,function(b){ct(b[0],b[1],a)}),b.mark("del"),_.each(s,function(a){a.parentNode.removeChild(a)}),b.mark("findsel"),l&&!m&&(m=cB(l.startPoint)),l&&!o&&(o=cB(l.endPoint));var S=K.lines.length();return m&&m[0]>=S&&(m[0]=S-1,m[1]=K.lines.atIndex(m[0]).text.length),o&&o[0]>=S&&(o[0]=S-1,o[1]=K.lines.atIndex(o[0]).text.length),b.mark("repsel"),l&&cV(m,o,l&&l.focusAtStart),b.mark("browsel"),l&&(R||cu())&&(bt.selectionAffected=!0),bt.domClean=!0,ea("incorp.changes",!!t.length),b.mark("fixview"),dC(),b.end("END"),J=!1,R}function co(a){var b=P.createElement("DIV");return b.appendChild(a),b.innerHTML}function cr(a){return!!cp[a]}function cs(a){return!!cp[a]||!!cq[a]}function ct(a,b,c){c=c||function(){return!1};var d,e;if(b.length<1)return;var f=K.lines.atKey(ce(b[0].node)),g=K.lines.atKey(ce(b[b.length-1].node)),h=K.lines.offsetOfEntry(f),i=K.lines.offsetOfEntry(g)+g.width;_.each(b,function(b){var f=bc("insertLine",!1),g=b.node,h=ce(g),i;f.mark("findEntry");if(d){var j=K.lines.next(d);j&&j.key==h&&(i=j,e+=d.width)}i?f.literal(0,"nonopt"):(f.literal(1,"nonopt"),i=K.lines.atKey(h),e=K.lines.offsetOfKey(h)),d=i,f.mark("spans"),cg(i,function(a,c,d){b.appendSpan(a,c,d)},e,c()),f.mark("addLine"),b.prepareForAdd(),i.lineMarker=b.lineMarker,a?O.insertBefore(g,a.nextSibling):O.insertBefore(g,O.firstChild),a=g,b.notifyAdded(),f.mark("markClean"),c_(g),f.end()})}function cu(){return K.selStart&&K.selEnd&&K.selStart[0]==K.selEnd[0]&&K.selStart[1]==K.selEnd[1]}function cv(){return K.selStart[0]}function cw(){return K.selStart[1]}function cx(){return K.lines.offsetOfIndex(cv())+cw()}function cy(){if(cu()&&cw()===0&&cv()>0){var a=cv(),b=K.lines.atIndex(a),c=K.lines.prev(b),d=c.text,e=/^ *(?:)/.exec(d)[0];/[\[\(\{]\s*$/.exec(d)&&(e+=p);var f=g.builder(K.lines.totalWidth()).keep(K.lines.offsetOfIndex(a),a).insert(e,[["author",x]],K.apool).toString();cE(f),cU([a,e.length],[a,e.length])}}function cz(a){var b=a[0],c=a[1],d=K.lines.atIndex(b);c-=d.lineMarker,c<0&&(c=0);var e=d.lineNode,f=e,g=!1,h=null;if(c===0){var i=0;return browser.msie&&b==K.lines.length()-1&&e.childNodes.length===0&&(i=1),{node:e,index:i,maxIndex:1}}while(f!=e||!g)if(g)f.nextSibling?(f=f.nextSibling,g=!1):f=f.parentNode;else if(isNodeText(f)){var j=f.nodeValue.length;if(c<=j)return{node:f,index:c,maxIndex:j};c-=j,g=!0}else z.countBlockNodes&&(h=/.*block\-node\-(\d+)(\s|$).*/.exec(f.className||""))&&h[1]&&c>h[1]?(c-=+h[1],g=!0):f.firstChild?f=f.firstChild:g=!0;return{node:e,index:1,maxIndex:1}}function cA(a){return a.innerText||a.textContent||a.nodeValue||""}function cB(a){if(a.node==O){if(a.index===0)return[0,0];var b=K.lines.length(),c=K.lines.atIndex(b-1);return[b-1,c.text.length]}var d=a.node,e=0;isNodeText(d)?e=a.index:a.index>0&&(e=cA(d).length);var f,g,h;while((f=d.parentNode)!=O)(g=d.previousSibling)?(d=g,z.countBlockNodes&&(h=/.*block\-node\-(\d+)(\s|$).*/.exec(g.className))&&h[1]?e+=+h[1]:e+=cA(d).length):d=f;d.id===""&&window.console.debug("BAD",d),d.firstChild&&cZ(d.firstChild)&&(e+=1);var i=K.lines.atKey(d.id),j=K.lines.indexOfEntry(i);return[j,e]}function cC(a){var b=cW(a.length>0),c=b.node;return{key:ce(c),text:a,lineNode:c,domInfo:b,lineMarker:0}}function cD(a){return g.oldLen(a)==K.alltext.length}function cE(a,b,c){function j(a,b,c,d,e){d=d||b$(50),e&&e[0]&&(e.numToAttrib=[],e.numToAttrib.push(e[0]));var f=[],g=[],h=!1;if(b>0){var i=K.lines.atIndex(a);for(var j=0;j<b;j++)f.push(i.key),i.domInfo.checkAttribs(e)&&g.push(i),i=K.lines.next(i)}if(g.length)for(var j=0,k;k=g[j];j++)h=k.domInfo.appendData(e);if(!h){var l=_.map(c,cC);cP(a,b,l);var m;a>0?m=cj(K.lines.atIndex(a-1).key):m=null,ct(m,_.map(l,function(a){return a.domInfo}),d),_.each(f,function(a){var b=P.getElementById(a);b.parentNode.removeChild(b)}),ea("incorp.changes",!0)}else g.length&&cP(a,b,g);if(K.selStart&&K.selStart[0]>=a&&K.selStart[0]<=a+b||K.selEnd&&K.selEnd[0]>=a&&K.selEnd[0]<=a+b)bt.selectionAffected=!0}cG(a,b);var d=null;if(K.selStart&&K.selEnd){var e=K.lines.offsetOfIndex(K.selStart[0])+K.selStart[1],f=K.lines.offsetOfIndex(K.selEnd[0])+K.selEnd[1],h=g.characterRangeFollow(a,e,f,b);d=[h[0],h[1],K.selFocusAtStart]}var i={splice:function(a,b,d){var e=Array.prototype.slice.call(arguments,2);j(a,b,_.map(e,function(a){return a.slice(0,-1)}),null,c)},get:function(a){return K.lines.atIndex(a).text+"\n"},length:function(){return K.lines.length()},slice_notused:function(a,b){return _.map(K.lines.slice(a,b),function(a){return a.text+"\n"})}};g.mutateTextLines(a,i),bz(),d&&cU(cH(d[0]),cH(d[1]),d[2])}function cF(a){return!0;var b,c,d,e}function cG(a,b){g.checkRep(a);if(g.oldLen(a)!=K.alltext.length)throw new Error("doRepApplyChangeset length mismatch: "+g.oldLen(a)+"/"+K.alltext.length);if(!cF(a))throw new Error("doRepApplyChangeset line break mismatch");(function(b){var c=bt.editEvent;if(c.eventType=="nonundoable")c.changeset?c.changeset=g.compose(c.changeset,b,K.apool):c.changeset=b;else{var d=g.inverse(b,{get:function(a){return K.lines.atIndex(a).text+"\n"},length:function(){return K.lines.length()}},K.alines,K.apool);c.backset?c.backset=g.compose(d,c.backset,K.apool):c.backset=d}})(a),g.mutateAttributionLines(a,K.alines,K.apool),M.isTracking()&&M.composeUserChangeset(a,x)}function cH(a){var b=K.lines.atOffset(a),c=K.lines.offsetOfEntry(b),d=K.lines.indexOfEntry(b);return[d,a-c]}function cI(a,b,c){if(a==b&&c.length===0)return;b==K.alltext.length&&(a==b?(a--,b--,c="\n"+c.substring(0,c.length-1)):c.length===0?(a--,b--):(b--,c=c.substring(0,c.length-1))),cJ(cH(a),cH(b),c)}function cJ(a,b,c,d){a===undefined&&(a=K.selStart),b===undefined&&(b=K.selEnd);var e=g.builder(K.lines.totalWidth());h.buildKeepToStartOfRange(K,e,a),h.buildRemoveRange(K,e,a,b);var f=["author",x];e.insert(c,[f].concat(d||[]),K.apool);var i=e.toString();cE(i,null,d)}function cK(a,b,c){b=Math.min(b,K.alltext.length-1),Z.setAttributesOnRange(cH(a),cH(b),c)}function cL(a,b){if(!K.selStart||!K.selEnd)return;Z.setAttributesOnRange(K.selStart,K.selEnd,[[a,b]])}function cM(a){function e(a){return d.test(a)}var b=!0,c=g.makeAttribsString("+",[[a,"true"]],K.apool),d=new RegExp(c.replace(/\*/g,"\\*")+"(\\*|$)"),f=K.selStart[0],h=K.selEnd[0];for(var i=f;i<=h;i++){var j=g.opIterator(K.alines[i]),k=0,l=0,m=K.lines.atIndex(i).text.length;i==f&&(l=K.selStart[1]),i==h&&(m=K.selEnd[1]);while(j.hasNext()){var n=j.next(),o=k,p=o+n.chars;if(!e(n.attribs)&&!(p<=l||o>=m)){b=!1;break}k=p}if(!b)break}return b}function cN(a,b){if(!K.selStart||!K.selEnd)return;b?H[a]="true":delete H[a],b?Z.setAttributesOnRange(K.selStart,K.selEnd,[[a,"true"]]):Z.setAttributesOnRange(K.selStart,K.selEnd,[[a,""]]),ea("ace.attributeChanged",a,!!b)}function cO(a){if(!K.selStart||!K.selEnd)return;cJ(K.selStart,K.selEnd,a)}function cP(a,b,c){_.each(c,function(a){a.width=a.text.length+1});var d=K.lines.offsetOfIndex(a),e=K.lines.offsetOfIndex(a+b),f=K.lines.offsetOfIndex(a),g=K.lines.offsetOfIndex(a+b);K.lines.splice(a,b,c),bt.docTextChanged=!0,bt.repChanged=!0;var h=K.lines.offsetOfIndex(a+c.length),i=_.map(c,function(a){return a.text+"\n"}).join("");K.alltext=K.alltext.substring(0,d)+i+K.alltext.substring(e,K.alltext.length),ea("ace.doc.check.isEmpty",K.alltext.replace(/^\s+|\s+$/g,"")=="")}function cQ(a,b,c,d,e){var f=K.lines.offsetOfIndex(a),h=K.lines.offsetOfIndex(a+b),i=K.lines.offsetOfIndex(a),j,k;e&&e.selStart&&(j=K.lines.offsetOfIndex(e.selStart[0])+e.selStart[1]-i),e&&e.selEnd&&(k=K.lines.offsetOfIndex(e.selEnd[0])+e.selEnd[1]-i);var l=_.map(c,function(a){return a.text+"\n"}).join(""),m=K.alltext.substring(f,h),n=K.alines.slice(a,a+b).join(""),o=d.join("|1+1")+"|1+1",p=cS(m,l,n,o,j,k),q=p[0],r=p[1],s=m.substring(q,m.length-r),t=l.substring(q,l.length-r),u=f+q,v=h-r,w=!1;s.charAt(s.length-1)=="\n"&&t.charAt(t.length-1)=="\n"&&(s=s.slice(0,-1),t=t.slice(0,-1),v--,r++),s.length===0&&u==K.alltext.length&&t.length>0&&(u--,v--,t="\n"+t.slice(0,-1),w=!0),v==K.alltext.length&&s.length>0&&t.length===0&&K.alltext.charAt(u-1)=="\n"&&(u--,v--);if(s.length!==0||t.length!==0){var y=K.alltext,z=y.length,A=K.lines.indexOfOffset(u),B=K.lines.offsetOfIndex(A),C=function(){var a=g.builder(z);return a.keep(B,A),a.keep(u-B),a},D=function(a,b){var c=g.opIterator(a),d=0,e=q,f=l.length-r-(w?1:0);while(c.hasNext()){var h=c.next(),i=d+h.chars;i<=e||d>=f||b(Math.max(e,d),Math.min(f,i),h.attribs),d=i}},E=t==s,F;if(E){var G=cR(function(a){return g.mapAttribNumbers(a,function(a){var b=K.apool.getAttribKey(a);return cr(b)?K.apool.putAttrib([b,""]):!1})}),I=C();w&&I.keep(1,1),D(n,function(a,b,c){I.keepText(l.substring(a,b),G(c))});var L=I.toString(),M=C();w&&M.keep(1,1),D(o,function(a,b,c){M.keepText(l.substring(a,b),c)});var N=M.toString();F=g.compose(L,N,K.apool)}else{var O=C(),P=K.lines.indexOfOffset(v),Q=K.lines.offsetOfIndex(P);Q>u?(O.remove(Q-u,P-A),O.remove(v-Q)):O.remove(v-u);var R=[];if(!J){var S=o,T={};o.replace(/\*([0-9a-z]+)/g,function(a,b){var c=K.apool.getAttrib(g.parseNum(b));return c&&c[0]&&cr(c[0])&&!T[c[0]]&&(S=(S||"").split("*"+b).join(""),T[b]=1),""}),o=S;for(var U in H)R.push([U,H[U]])}x&&R.push(["author",x]);var V=!1,W=g.makeAttribsString("+",R,K.apool),X=cR(function(a){return V?g.composeAttributes(W,a,!0,K.apool):g.composeAttributes(a,W,!0,K.apool)}),Y="";D(o,function(a,b,c){var d=g.attribsAttributeValue(c,"author",K.apool);d&&d!=Y&&(Y?V=!0:Y=d)}),w&&O.insert("\n",X("")),D(o,function(a,b,c){O.insert(l.substring(a,b),X(c))}),F=O.toString()}cG(F)}cP(a,b,c),bz()}function cR(a){var b={};return function(c){return b[c]||(b[c]=a(c)),b[c]}}function cS(a,b,c,d,e,f){function h(a){return cr(K.apool.getAttribKey(a))}function i(a){var b=[],c=[],d=g.opIterator(a);while(d.hasNext()){var e=d.next();b.push(e.chars),c.push(e.attribs)}return[b,c]}function j(a,b){var c=a[0],d=a[1],e=b?c.length-1:0,f=0;return function(){while(f>=c[e])b?e--:e++,f=0;var g=d[e];return f++,g}}var k=a.length,l=b.length,m=Math.min(k,l),n=i(g.filterAttribNumbers(c,h)),o=i(g.filterAttribNumbers(d,h)),p=0,q=j(n,!1),r=j(o,!1);while(p<m){if(a.charAt(p)!=b.charAt(p)||q()!=r())break;p++}var s=0,t=j(n,!0),u=j(o,!0);while(s<m)if(s===0)t(),u(),s++;else{if(a.charAt(k-1-s)!=b.charAt(l-1-s)||t()!=u())break;s++}var v=-1;typeof f=="number"&&(v=l-f);if(p+s>k){var w=k-p,x=s;v>=w&&v<=x?s=v:s=w,p=k-s}if(p+s>l){var w=l-p,x=s;v>=w&&v<=x?s=v:s=w,p=l-s}return[p,s]}function cT(a,b){return a?b?a[0]==b[0]&&a[1]==b[1]:!a:!b}function cU(a,b,c){cV(a,b,c)&&(bt.selectionAffected=!0)}function cV(a,b,c){c=!!c;var d=c&&(!a||!b||a[0]!=b[0]||a[1]!=b[1]);if(!cT(K.selStart,a)||!cT(K.selEnd,b)||K.selFocusAtStart!=d){K.selStart=a,K.selEnd=b,K.selFocusAtStart=d,ea("cursor.change",K.selStart?K.selStart[0]:null,K.selStart?K.selStart[1]:null,K.selEnd?K.selEnd[0]:null,K.selEnd?K.selEnd[1]:null);var e=z.links_determineSelection(!1);ea("text.selection.updated",e.isMultiline,e.selectedText,e.linkValue);var f=window.getSelection&&window.getSelection(),g=null,h=null,i=null;rHeight=null;if(f&&f.rangeCount>0){var j=f.getRangeAt(0).cloneRange(),k=j.getClientRects?j.getClientRects():null;k&&k[0]&&(g=k[0].top,h=k[0].left,i=k[0].width,rHeight=k[0].height)}return ea("text.selection.coords",h,g,i,rHeight),bt.repChanged=!0,!0}return!1}function cW(a){if(browser.msie&&!a){var b={node:null,appendSpan:noop,prepareForAdd:noop,notifyAdded:noop,clearSpans:noop,finishUpdate:noop,checkAttribs:noop,appendData:noop,lineMarker:0},c=P.createElement("div");b.node=c,b.notifyAdded=function(){c.innerHTML=" ",setAssoc(c,"shouldBeEmpty",!0),setAssoc(c,"unpasted",{}),c.innerHTML=""};var d="ace-line";b.appendSpan=function(a,b){!a&&b&&(d=e.addToLineClass(d,b))},b.clearSpans=function(){d=""};var f=function(){d!==null&&(c.className=d)};return b.prepareForAdd=f,b.finishUpdate=f,b.getInnerHTML=function(){return""},b}return e.createDomLine(a,R,browser,P)}function cX(a){return a.replace(/[\n\r ]/g," ").replace(/\xa0/g," ").replace(/\t/g,"        ")}function cZ(a){return!!cY[(a.tagName||"").toLowerCase()]}function c$(){function d(d){if(b[d]===undefined){a.forIndices++;var e;if(d<0||d>=c)e=!0;else{var f=K.lines.atIndex(d).key;e=cj(f)||!1}b[d]=e}return b[d]}function f(b){return e[b]===undefined&&(a.consecutives++,e[b]=function(){var a=d(b-1),c=d(b);return!a||!c?!1:a===!0&&c===!0?!O.firstChild:a===!0&&c.previousSibling?!1:c===!0&&a.nextSibling?!1:a===!0||c===!0?!0:a.nextSibling==c}()),e[b]}function g(a){return!!d(a)}function i(a){var b=-1;return _.each(h,function(c,d){return a>=c[1]?!1:a<c[0]?!0:(b=d,!0)}),b}function j(a,b){var c=h[a][0],d=h[a][1];c+1==d?h.splice(a,1):b==c?h[a][0]++:b==d-1?h[a][1]--:h.splice(a,1,[c,b],[b+1,d])}function k(a,b){var c=h[a][0],d=h[a][1];h.splice(a,1,[c,b],[b,d])}function m(b){if(l[b])return!0;a.corrections++,l[b]=!0;var c=i(b),d=g(b);if(c<0)return d&&window.console.debug("somehow lost clean line"),!0;if(!d)return j(c,b),!1;var e=h[c][0],m=h[c][1],n=!1;return e<b&&g(b-1)&&!f(b)&&(k(c,b),n=!0),m>b+1&&g(b+1)&&!f(b+1)&&(k(c,b+1),n=!0),!n}function n(a,b){var d=0,e=a;while(d<b&&e>=0)m(e)?d++:d=0,e--;d=0,e=a;while(d<b&&e<c)m(e)?d++:d=0,e++}var a=bc("getDirtyRanges",!1);a.forIndices=0,a.consecutives=0,a.corrections=0;var b={},c=K.lines.length(),e={},h=[[-1,c+1]],l={};if(c===0)a.cancel(),f(0)||k(0,0);else{a.mark("topbot"),n(0,1),n(c-1,1),a.mark("obs");for(var o in ch.cleanNodesNearChanges){var p=o.substring(1);if(K.lines.containsKey(p)){var q=K.lines.indexOfKey(p);n(q,2)}}a.mark("stats&calc"),a.literal(a.forIndices,"byidx"),a.literal(a.consecutives,"cons"),a.literal(a.corrections,"corr")}var r=[];for(var s=0;s<h.length-1;s++)r.push([h[s][1],h[s+1][0]]);return a.end(),r}function c_(a){var b={};b.nodeId=ce(a);var c=$(a);c.find(".ace-invisible").length&&(c=c.clone(!0),c.find(".ace-invisible").remove()),b.knownHTML=c.get(0).innerHTML,browser.msie&&(b.knownText=c.get(0).innerText),setAssoc(a,"dirtiness",b)}function da(a){var b=bc("cleanCheck",!1);if(a.parentNode!=O)return!0;var c=getAssoc(a,"dirtiness");if(!c)return!0;if(a.id!==c.nodeId)return!0;var d=$(a);return d.find(".ace-invisible").length&&(d=d.clone(!0),d.find(".ace-invisible").remove()),browser.msie&&d.get(0).innerText!==c.knownText?!0:d.get(0).innerHTML!==c.knownHTML?!0:(b.end(),!1)}function db(a,b){var c=a.lineNode,d=c.offsetTop,e=c.offsetHeight,f=b||{};return f.top=d,f.bottom=d+e,f}function dc(){var a=dF(),b=C.document,c=b.documentElement.clientHeight;return{top:a,bottom:a+c}}function dd(){var a=dc(),b={},c=K.lines.search(function(c){return db(c,b).bottom>a.top}),d=K.lines.search(function(c){return db(c,b).top>=a.bottom});return d<c&&(d=c),[c,d]}function de(){var a=dd();return[K.lines.offsetOfIndex(a[0]),K.lines.offsetOfIndex(a[1])]}function df(a){bv("handleClick",function(){cc.atMost(200)}),window.parent.parent.padeditbar&&window.parent.parent.padeditbar.toogleDropDown("none")}function dg(){if(!K.selStart||!K.selEnd)return;var a=K.selStart[0],b=ek(a);if(b){var c=K.lines.atIndex(a).text;b=/([a-z]+)([12345678])/.exec(b);var d=b[1],e=Number(b[2]);c==="*"&&d!=="indent"?e>1?el(a,d+(e-1)):(el(a,""),em(a+1)):a+1<K.lines.length()&&(cO("\n"),el(a+1,d+e))}else cO("\n"),cy();hooks.callAll("aceNewLineList",{line:K.lines.atIndex(a),lineNum:a,listType:d})}function dh(a){if(!K.selStart||!K.selEnd||K.selStart[0]==K.selEnd[0]&&K.selStart[1]==K.selEnd[1]&&K.selEnd[1]>1)return!1;var b,c;b=K.selStart[0],c=Math.max(b,K.selEnd[0]-(K.selEnd[1]===0?1:0));var d=[];for(var e=b;e<=c;e++){var f=ek(e),g="indent",h=0;f&&(f=/([a-z]+)([12345678])/.exec(f),f&&(g=f[1],h=Number(f[2])));var i=Math.max(0,Math.min(q,h+(a?-1:1)));h!=i&&d.push([e,i>0?g+i:""])}return _.each(d,function(a){el(a[0],a[1])}),!0}function di(a){dh(a)||cO(p)}function dj(a){var b=a||{},c=!1;if(K.selStart){if(cu()){var d=cv(),e=cw(),f=K.lines.atIndex(d),g=f.text,h=f.lineMarker;if(/^ +$/.exec(g.substring(h,e))){var i=e-h,j=p.length,k=(i-1)%j+1;cJ([d,e-k],[d,e],""),c=!0}}if(!c)if(cu()){var l=cv(),f=K.lines.atIndex(l);if(cw()<=f.lineMarker){var m="delete_newline",n=l>0?ek(l-1):"",o=ek(l),q=l>0&&K.lines.atIndex(l-1),r=q&&q.text.length==q.lineMarker,s=q&&q.domInfo.widgetDomline,t=Z.lineHasMarker(l);if(s){cJ([l-1,0],[l-1,q.text.length],"");return}o?r&&!n?cJ([l-1,q.text.length],[l,0],""):cJ([l,0],[l,f.lineMarker],""):t&&q?cJ([l-1,q.text.length],[l,f.lineMarker],""):l>0&&cJ([l-1,q.text.length],[l,0],"")}else{var u=cx();if(u>0)if(b.metaKey||b.ctrlKey||b.altKey){var v=u-1;while(v>f.lineMarker&&dm(K.alltext.charAt(v-1)))v--;cI(v,u,"")}else cI(u-1,u,"")}}else cO("")}var w=cv();w!=-1&&em(w+1)===null&&em(w)}function dm(a){return!!dk.exec(a)}function dn(a){return!!dl.exec(a)}function dp(a,b,c){function e(){return c?a.charAt(d):a.charAt(d-1)}function f(){c?d++:d--}function g(){return c?d>=a.length:d<=0}var d=b;if(browser.windows&&c){while(!g()&&dm(e()))f();while(!g()&&!dm(e()))f()}else{while(!g()&&!dm(e()))f();while(!g()&&dm(e()))f()}return d}function dr(a){if(n&&window.DONT_INCORP||document.DONT_INCORP)return;if(!Q)return;var b=a.type,c=a.charCode,d=a.keyCode,e=a.which,f=!c&&(b=="keyup"||b=="keydown")&&(d==16||d==17||d==18||d==20||d==224||d==91);if($.inArray(d,dq)==-1){var g=$(document.selection?document.selection.createRange().parentElement():(window.getSelection().anchorNode||{}).parentNode);if(g.parents(".ace-invisible").length){a.preventDefault(),a.stopPropagation();return}}if(f)return;var h=!1,i=browser.msie||browser.safari?b=="keydown":b=="keypress",j=browser.msie||browser.safari?b=="keydown":b=="keypress",k=!1;bv("handleKeyEvent",function(){b=="keypress"||i&&d==13?G(a)||(a.preventDefault(),k=!0):b=="keydown"&&F(a),k||(i&&d==8&&(ca(3),a.preventDefault(),dj(a),h=!0),!h&&i&&d==13&&(ca(4),a.preventDefault(),dg(),L.setTimeout(function(){C.scrollBy(-100,0)},0),h=!0),!h&&i&&d==9&&!a.metaKey&&!a.ctrlKey&&(ca(5),a.preventDefault(),di(a.shiftKey),h=!0),!h&&j&&String.fromCharCode(e).toLowerCase()=="z"&&(a.metaKey||a.ctrlKey)&&!a.altKey&&(ca(6),a.preventDefault(),a.shiftKey?dt("redo"):dt("undo"),h=!0),!h&&j&&String.fromCharCode(e).toLowerCase()=="y"&&(a.metaKey||a.ctrlKey)&&(ca(10),a.preventDefault(),dt("redo"),h=!0),!h&&j&&String.fromCharCode(e).toLowerCase()=="b"&&(a.metaKey||a.ctrlKey)&&(ca(13),a.preventDefault(),cN("bold",!H.bold),h=!0),!h&&j&&String.fromCharCode(e).toLowerCase()=="i"&&(a.metaKey||a.ctrlKey)&&(ca(14),a.preventDefault(),cN("italic",!H.italic),h=!0),!h&&j&&String.fromCharCode(e).toLowerCase()=="u"&&(a.metaKey||a.ctrlKey)&&(ca(15),a.preventDefault(),cN("underline",!H.underline),h=!0),!h&&j&&String.fromCharCode(e).toLowerCase()=="h"&&a.ctrlKey&&(ca(20),a.preventDefault(),dj(),h=!0));if(b=="keydown")cc.atLeast(500);else if(b=="keypress")!h&&!1?cc.atMost(0):cc.atLeast(500);else if(b=="keyup"){var f=200;cc.atLeast(f),cc.atMost(f)}var g=browser.mozilla&&a.altKey&&c===0&&d===0,l=browser.safari&&a.altKey&&d==229;if(ds||g||l)cc.atLeast(3e3),ds=!0;!h&&!ds&&!dN&&(b!="keyup"||!cb())&&cl(),b=="keyup"&&(ds=!1)})}function dt(a){if(k.enabled){var b;a=="undo"&&(b="performUndo"),a=="redo"&&(b="performRedo");if(b){var c=bt.editEvent.eventType;bt.startNewEvent(a),k[b](function(a,b){if(a){var d=g.prepareForWire(a,K.apool),e=d.pool.toJsonable();cE(a,null,e)}b&&cU(cH(b.selStart),cH(b.selEnd),b.selFocusAtStart);var f=bt.startNewEvent(c,!0);return f})}}}function dv(){var a=K.selStart,b=K.selEnd;if(!a||!b){dA(null);return}var c={},d=[a[0],a[1]];c.startPoint=cz(d);var e=[b[0],b[1]];c.endPoint=cz(e),c.focusAtStart=!!K.selFocusAtStart;var f=" "+($(c.startPoint.node).parents("span[class]").attr("class")||"")+" "+($(c.endPoint.node).parents("span[class]").attr("class")||"")+" ";if(f!=du&&f.indexOf("ace-invisible")==-1){for(var g in cp){var h=(f||"").indexOf(cp[g])!=-1;h?H[g]="true":delete H[g]}ea("selection.changed",H),du=f}dA(c)}function dw(a){return isNodeText(a)?a.nodeValue.length:1}function dx(){var a;try{a=P.selection}catch(b){}if(!a)return!1;var c;try{c=a.createRange()}catch(b){}return c?!0:!1}function dy(a){var b,c;if(window.getSelection){b=window.getSelection();if(b.getRangeAt&&b.rangeCount){c=b.getRangeAt(0),c.deleteContents();var d=document.createElement("div");d.innerHTML=a;var e=document.createDocumentFragment(),f;while(f=d.firstChild)e.appendChild(f);var g=document.createElement("span");e.appendChild(g),c.insertNode(e),c=c.cloneRange(),c.setStartAfter(g),c.collapse(!0),b.removeAllRanges(),b.addRange(c),document.body.blur(),document.body.focus()}}else document.selection&&document.selection.type!="Control"&&document.selection.createRange().pasteHTML(a)}function dz(){if(!window.getSelection){var a;try{a=P.selection}catch(b){}if(!a)return null;var c;try{c=a.createRange()}catch(b){}if(!c||!c.parentElement)return null;var d=c.parentElement();if(d.ownerDocument!=P)return null;var e=function(){return P.body.createTextRange()},f=function(a){var b=e();return b.moveToElementText(a),b},g=function(a){var b=a.parentElement(),c=-1,d=b.childNodes.length,e=f(b);if(cZ(b)&&!b.innerHTML)return{node:b,index:0,maxIndex:1};if(a.compareEndPoints("StartToStart",e)===0)return{node:b,index:0,maxIndex:1};if(a.compareEndPoints("EndToEnd",e)===0)return cZ(b)&&b.nextSibling?{node:b.nextSibling,index:0,maxIndex:1}:{node:b,index:1,maxIndex:1};if(b.childNodes.length===0)return{node:b,index:0,maxIndex:1};for(var g=0;g<b.childNodes.length;g++){var h=b.childNodes.item(g);if(!isNodeText(h)){var i=f(h),j=a.compareEndPoints("StartToStart",i),k=a.compareEndPoints("EndToEnd",i);if(j>=0&&k<=0){var l=0;return j>0&&(l=1),{node:h,index:l,maxIndex:1}}k>0?g>c&&(c=g,e.setEndPoint("StartToEnd",i)):j<0&&g<d&&(d=g,e.setEndPoint("EndToStart",i))}}if(d-c==1)return c>=0?{node:b.childNodes.item(c),index:1,maxIndex:1}:{node:b.childNodes.item(d),index:0,maxIndex:1};var m=0,n=a.duplicate(),o=binarySearchInfinite(40,function(a){var b=a-m,c=Math.abs(n.move("character",-b));return n.move("character",-1)&&n.move("character",1),b<0?m-=c:m+=c,n.compareEndPoints("StartToStart",e)<=0}),p=c+1,q=o;while(p<d){var r=b.childNodes.item(p);if(q<=r.nodeValue.length)return{node:r,index:q,maxIndex:r.nodeValue.length};q-=r.nodeValue.length,p++}var r=b.childNodes.item(p-1);return{node:r,index:r.nodeValue.length,maxIndex:r.nodeValue.length}},h={};if(c.compareEndPoints("StartToEnd",c)===0){var i=g(c);h.startPoint=i,h.endPoint={node:i.node,index:i.index,maxIndex:i.maxIndex}}else{var j=c.duplicate();j.collapse(!0);var k=c.duplicate();k.collapse(!1),h.startPoint=g(j),h.endPoint=g(k)}return h}var a=window.getSelection();if(a&&a.type!="None"&&a.rangeCount!==0){var l=a.getRangeAt(0);function m(a){while(a&&(!a.tagName||a.tagName.toLowerCase()!="body"))a=a.parentNode;return!!a}function n(a,b){if(!m(a))return{node:O,index:0,maxIndex:1};var c=a,d=c.childNodes.length;if(isNodeText(c))return{node:c,index:b,maxIndex:c.nodeValue.length};if(d===0)return{node:c,index:0,maxIndex:1};if(b==d){var e=c.childNodes.item(d-1),f=dw(e);return{node:e,index:f,maxIndex:f}}var e=c.childNodes.item(b),f=dw(e);return{node:e,index:0,maxIndex:f}}var h={};return h.startPoint=n(l.startContainer,l.startOffset),h.endPoint=n(l.endContainer,l.endOffset),h.focusAtStart=(l.startContainer!=l.endContainer||l.startOffset!=l.endOffset)&&a.anchorNode&&a.anchorNode==l.endContainer&&a.anchorOffset==l.endOffset,h}return null}function dA(a){function b(a){return{node:a.node,index:a.index,maxIndex:a.maxIndex}}if($(document.activeElement).hasClass("liveeditor-widget-frame"))return;if(browser.msie){P.body.scrollHeight;function c(a,b){while(b.firstChild&&!isNodeText(b.firstChild))b=b.firstChild;a.moveToElementText(b)}function d(){return P.body.createTextRange()}function e(a,b){isNodeText(b)?b.previousSibling&&!isNodeText(b.previousSibling)?f(a,b.previousSibling):e(a,b.parentNode):(c(a,b),a.move("character",1)&&a.move("character",-1),a.collapse(!0))}function f(a,b){isNodeText(b)?(e(a,b),a.move("character",b.nodeValue.length)):(c(a,b),a.collapse(!1))}function g(a){var b=d(),c=a.node;return isNodeText(c)?(e(b,c),b.move("character",a.index)):a.index===0?e(b,c):f(b,c),b}if(a&&a.startPoint.node&&a.startPoint.node.contentEditable!="false"){if(!dx())return;var h=b(a.startPoint),i=b(a.endPoint);i.index==i.maxIndex&&i.node.nextSibling&&(i.node=i.node.nextSibling,i.index=0,i.maxIndex=dw(i.node));var j=g(h);j.setEndPoint("EndToEnd",g(i));function k(a){var b;try{b=P.selection}catch(c){}if(!b)return!1;var d=b.createRange();return!d||d.toString&&d.toString()=="[object ControlRangeCollection]"?!1:d.parentElement&&d.parentElement().ownerDocument!=P?!1:a.compareEndPoints("StartToStart",d)!==0?!1:a.compareEndPoints("EndToEnd",d)!==0?!1:!0}if(!k(j))try{j.select()}catch(l){}}else try{P.selection.empty()}catch(l){}}else{var m;function n(a){var c=b(a);if(m){function d(){while(c.node.childNodes.length>0)if(c.index===0)c.node=c.node.firstChild,c.maxIndex=dw(c.node);else{if(c.index!=c.maxIndex)break;c.node=c.node.lastChild,c.maxIndex=dw(c.node),c.index=c.maxIndex}}if(isNodeText(c.node)&&c.index==c.maxIndex){var e=c.node;while(!e.nextSibling&&e!=O&&e.parentNode!=O)e=e.parentNode;e.nextSibling&&(typeof e.nextSibling.tagName!="string"||e.nextSibling.tagName.toLowerCase()!="br")&&e!=c.node&&e!=O&&e.parentNode!=O&&(c.node=e.nextSibling,c.maxIndex=dw(c.node),c.index=0,d())}isNodeText(c.node)||d()}return isNodeText(c.node)?{container:c.node,offset:c.index}:{container:c.node.parentNode,offset:dB(c.node)+c.index}}var o=window.getSelection();if(o){o.removeAllRanges();if(a){m=a.startPoint.node===a.endPoint.node&&a.startPoint.index===a.endPoint.index;var p=n(a.startPoint),q=n(a.endPoint);if(!m&&a.focusAtStart&&o.collapse&&o.extend)o.collapse(q.container,q.offset),o.extend(p.container,p.offset);else try{var j=P.createRange();j.setStart(p.container,p.offset),j.setEnd(q.container,q.offset),o.removeAllRanges(),o.addRange(j)}catch(l){window.console.log("set selection error",l),window.console.log(p,q)}}}}}function dB(a){var b=0;while(a.previousSibling)b++,a=a.previousSibling;return b}function dC(){function a(a,b,c){return a[b]!=c?(a[b]=c,!0):!1}if(ef()===0||ee()===0)return;var b=0,c,d;$(O).children().each(function(){b+=$(this).height()}),b+=15;for(var e=0;e<2;e++){c=browser.msie?O.createTextRange().boundingWidth:O.clientWidth,d=ef(),R?c=d:c<d&&(c=d);if(!z.isMobile){var f=a(B.style,"height",b+"px"),g=a(B.style,"width",c+"px"),h=a(z.frame.style,"height",b+"px");(f||g||h)&&ea("ace.event.FrameViewChanged")}}bH()}function dD(){var a=C,b=C.document;if(typeof a.pageYOffset=="number")return{x:a.pageXOffset,y:a.pageYOffset};var c=b.documentElement;if(c&&typeof c.scrollTop=="number")return{x:c.scrollLeft,y:c.scrollTop}}function dE(){return dD().x}function dF(){return dD().y}function dG(a){C.scrollTo(a,dF())}function dH(a){C.scrollTo(dE(),a)}function dI(a,b){C.scrollTo(a,b)}function dK(){_.each(dJ,function(a){a()})}function dL(a){try{function b(a,b,c){return String(a[b]).toLowerCase()!=c?(a[b]=c,!0):!1}return b(O,"contentEditable",a?"true":"false"),!0}catch(c){return!1}}function dM(a){J=!0,ea("ace.paste",a)}function dO(a){a.type=="compositionstart"?dN=!0:a.type=="compositionend"&&(dN=!1)}function dP(){$(document).on("keydown",dr),$(document).on("keypress",dr),$(document).on("keyup",dr),$(document).on("click",df),$(browser.mozilla?document:O).on("blur",dZ),$(browser.mozilla?document:O).on("focus",d$),browser.msie&&($(document).on("click",dQ),$(O).on("dblclick",d_)),$(O).on("paste",dM),!browser.msie&&document.documentElement&&($(document.documentElement).on("compositionstart",dO),$(document.documentElement).on("compositionend",dO)),ex()}function dQ(a){if((a.target.tagName||"").toLowerCase()!="html")return;if(!(a.pageY>O.clientHeight))return;bv("handleOuterClick",function(){ca(11);if(cu()){var a=K.lines.length()-1,b=K.lines.atIndex(a).text.length;cU([a,b],[a,b])}})}function dR(a,b){var c=[];return(a.className||"").replace(/\S+/g,function(a){(!b||b(a))&&c.push(a)}),c}function dS(a,b){a.className=b.join(" ")}function dT(a,b,c){c?$(a).addClass(b):$(a).removeClass(b)}function dU(){P=document,bv("setup",function(){var a=P.getElementById(A);O=a,browser.mozilla&&addClass(O,"mozilla"),browser.safari&&addClass(O,"safari"),browser.msie&&addClass(O,"msie");if(browser.msie)try{P.execCommand("BackgroundImageCache",!1,!0)}catch(b){}dT(O,"authorColors",!0),dT(O,"doesWrap",R),bi(),bH();while(O.firstChild)O.removeChild(O.firstChild);var c=cC("");cP(0,K.lines.length(),[c]),ct(null,[c.domInfo],null),K.alines=g.splitAttributionLines(g.makeAttribution("\n"),"\n"),dP()}),L.setTimeout(function(){parent.readyFunc()},0),o=!0}function dV(){return P}function dW(){d$(null),setTimeout(function(){window.focus()},0)}function dZ(a){browser.msie&&(dY=dz(),dX=L.setTimeout(function(){dA(null)},50),L.setTimeout(function(){dY=null},1e3)),ea("blur",a)}function d$(a){browser.msie&&L.clearTimeout(dX),ea("focus",a)}function d_(){dY&&(dW(),dA(dY),dY=null)}function ea(){z.eventListener.apply(z,arguments)}function eb(a){function d(a){return a.offsetLeft}function e(a){return a.offsetLeft+a.offsetWidth}var b=a.node,c=a.index;if(!isNodeText(b))return c===0?d(b):e(b);var f=c,g=b.nodeValue.length-c,h;for(h=b.previousSibling;h&&isNodeText(h);h=h.previousSibling)f+=h.nodeValue;var i=h?e(h):d(b.parentNode);for(h=b.nextSibling;h&&isNodeText(h);h=h.nextSibling)g+=h.nodeValue;var j=h?d(h):e(b.parentNode),k=f/(f+g),l=i+k*(j-i);return Math.round(l)}function ec(){var a=C,b=a.document;return a.innerHeight&&a.scrollMaxY?a.innerHeight+a.scrollMaxY:b.body.scrollHeight>b.body.offsetHeight?b.body.scrollHeight:b.body.offsetHeight}function ed(){var a=C,b=a.document;return a.innerWidth&&a.scrollMaxX?a.innerWidth+a.scrollMaxX:b.body.scrollWidth>b.body.offsetWidth?b.body.scrollWidth:b.body.offsetWidth}function ee(){var a=C,b=a.document,c;return browser.opera?c=a.innerHeight:c=b.documentElement.clientHeight,c?c:Number(z.frame.parentNode.style.height.replace(/[^0-9]/g,"")||0)}function ef(){var a=C,b=a.document;return b.documentElement.clientWidth}function eg(a){var b=C,c=C.document,d=a.offsetTop+V-b.scrollY,e=b.scrollY+ee()-(a.offsetTop+V+a.offsetHeight);d<0?b.scrollBy(0,d):e<0&&b.scrollBy(0,-e)}function eh(a){var b=C,c=C.document;a+=U;var d=a-b.scrollX,e=b.scrollX+ef()-a;d<0?b.scrollBy(d,0):e<0&&b.scrollBy(-e+1,0)}function ei(){if(!K.selStart)return;dC();var a=K.selFocusAtStart?K.selStart[0]:K.selEnd[0];eg(K.lines.atIndex(a).lineNode);if(!R){var b=dz();if(b){var c=b.focusAtStart?b.startPoint:b.endPoint,d=eb(c);eh(d),dC()}}}function ek(a){return Z.getAttributeOnLine(a,ej)}function el(a,b){b==""?Z.removeAttributeOnLine(a,ej):Z.setAttributeOnLine(a,ej,b),em(a+1)==null&&em(a)}function em(a){function d(a,e){var f=1,g=e,i;while((i=ek(a))&&b!="none"){i=/([a-z]+)([12345678])/.exec(i),g=Number(i[2]);if(isNaN(g)||i[0]=="indent")return a;if(g==e)h.buildKeepRange(K,c,loc,loc=[a,0]),h.buildKeepRange(K,c,loc,loc=[a,1],[["start",f]],K.apool),f++,a++;else{if(g<e)return a;a=d(a,e+1)}}return a}var b=ek(a);if(!b||b=="none")return null;b=/([a-z]+)[12345678]/.exec(b);if(b[1]=="indent"||b[1]=="bullet")return null;while(a-1>=0&&(b=ek(a-1))&&b!="none"){b=/([a-z]+)[12345678]/.exec(b);if(b[1]=="indent")break;a--}var c=g.builder(K.lines.totalWidth());loc=[0,0],d(a,1);var e=c.toString();g.isIdentity(e)||cE(e)}function en(a){if(!K.selStart||!K.selEnd)return;var b,c;b=K.selStart[0],c=Math.max(b,K.selEnd[0]-(K.selEnd[1]===0?1:0));var d=!0;for(var e=b;e<=c;e++){var f=ek(e);if(!f||f.slice(0,a.length)!=a){d=!1;break}}var g=[];for(var e=b;e<=c;e++){var h="",i=0,f=/([a-z]+)([12345678])/.exec(ek(e));f&&(h=f[1],i=Number(f[2]));var h=ek(e);g.push([e,d?"indent"+i:h?a+i:a+"1"])}_.each(g,function(a){el(a[0],a[1])})}function eo(){en("bullet")}function ep(){en("number")}function es(){return!1}function et(){return!1;var a,b,c,d}function ev(){return window.getSelection&&!window.getSelection().isCollapsed}function ew(a){return a.browserEvent&&(a=a.browserEvent),typeof a.which!="undefined"?a.button===0:!!(a.button&1)}function ex(){$(document.body).on("mouseup",ey),$(document.body).on("mousedown",function(a){a.stopPropagation()}),$(document.body).on("keyup",ez)}function ey(a){ew(a)&&setTimeout(function(){eu=ev(),eu&&ea("editor.new-selection","mouse")}.bind(this))}function ez(){!eu&&ev()&&(ea("editor.new-selection","keyboard"),eu=!0)}var a=require("./changesettracker").makeChangesetTracker,b=require("./colorutils").colorutils,c=require("./contentcollector").makeContentCollector,d=require("./cssmanager").makeCSSManager,e=require("./domline").domline,f=require("./AttributePool"),g=require("./Changeset"),h=require("./ChangesetUtils"),i=require("./linestylefilter").linestylefilter,j=require("./skiplist"),k=require("./undomodule").undoModule,l=require("./virtual_lines").makeVirtualLineView,m=require("./AttributeManager"),n=!1,o=!1,p="    ",q=8,r=4,s=4,t=20,u=8,v=8,w=[],x="",y=!1,z=parent.editorInfo,A=parent.editorInfo.isMobile?"mobile-wrapper":"innerdocbody";z.countBlockNodes=!0;var B=window.frameElement,C=z.ace_outerWin;B.ace_outerWin=null;var D=B.nextSibling,E=D.nextSibling;es();var F=noop,G=function(){return!0},H={},I=noop,J=!1,K={lines:new j,selStart:null,selEnd:null,selFocusAtStart:!1,alltext:"",alines:[]},L=parent,M;N();var O,P,Q=!0,R=!0,S=!0,T=!0,U=t+r+v,V=u,W=0,X=0,Y=n&&window.console,Z;if(!window.console){var ba=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];Y={};for(var bb=0;bb<ba.length;++bb)Y[ba[bb]]=noop}var bc=window.PROFILER;bc||(bc=function(){return{start:noop,mark:noop,literal:noop,end:noop,cancel:noop}});var bd=noop;window.dmesg=noop;var be="monospace",bf=12,bh=null;z.ace_setHeight=bj;var bk={};z.ace_getRep=function(){return K},z.ace_getAuthor=function(){return x};var bt=null;z.ace_inCallStack=bu,z.ace_inCallStackIfNecessary=bv;var bV={clearauthorship:function(a){!K.selStart||!K.selEnd||cu()?a?a():cK(0,K.alltext.length,[["author",""]]):cL("author","")}};z.ace_focus=dW,z.ace_importText=bI,z.ace_importAText=bJ,z.ace_exportText=bO,z.ace_getImageUrls=bN,z.ace_exportHtml=bP,z.ace_editorChangedSize=bQ,z.ace_setOnKeyPress=bR,z.ace_setOnKeyDown=bS,z.ace_setNotifyDirty=bT,z.ace_dispose=by,z.ace_getFormattedCode=bU,z.ace_setEditable=bF,z.ace_isEditable=bG,z.ace_execCommand=bW,z.ace_replaceRange=bX,z.ace_applyAttributesToRange=bY,z.ace_getSelection=dz,z.ace_setSelection=dA,z.ace_getLineAndCharForPoint=cB,z.ace_getDocument=dV,z.ace_pasteHtmlAtCaret=dy,z.ace_updateChangeSetTracker=function(){N()},z.ace_callWithAce=function(a,b,c){var d=function(){return a(z)};if(c!==undefined){var e=d;d=function(){z.ace_fastIncorp(9),e()}}return b!==undefined?z.ace_inCallStack(b,d):d()},z.ace_insertWidget=function(a){bu("insertWidget",function(){var b=K.selStart&&K.selStart[0]||0;cO("\n\n"),bX([b+1,0],[b+1,0],"|",a),K.selStart=[b+2,0],K.selEnd=[b+2,0],dv()})},z.ace_setProperty=function(a,b){var c=function(a,b){return function(c){dT(a,b,!!c)}},d={wraps:bA,showsauthorcolors:c(O,"authorColors"),showsuserselections:c(O,"userSelections"),showslinenumbers:function(a){S=!!a,browser.mobile&&(S=!1),dT(D,"sidedivhidden",!S),dC()},grayedout:c(C.document.body,"grayedout"),dmesg:function(){bd=window.dmesg=b},userauthor:function(a){x=String(a),Z.author=x},styled:bB,textface:bC,textsize:bD,rtlistrue:c(O,"rtl")},e=d[a.toLowerCase()];e!==undefined&&e(b)},z.ace_setBaseText=function(a){M.setBaseText(a)},z.ace_setBaseAttributedText=function(a,b){bp(),M.setBaseAttributedText(a,b)},z.ace_clearText=function(){M.clearText()},z.ace_applyChangesToBase=function(a,b,c){M.applyChangesToBase(a,b,c)},z.ace_prepareUserChangeset=function(){return M.prepareUserChangeset()},z.ace_applyPreparedChangesetToBase=function(){M.applyPreparedChangesetToBase()},z.ace_setUserChangeNotificationCallback=function(a){M.setUserChangeNotificationCallback(a)},z.ace_setAuthorInfo=function(a,b){bl(a,b)},z.ace_setAuthorSelectionRange=function(a,b,c){M.setAuthorSelectionRange(a,b,c)},z.ace_getUnhandledErrors=function(){return w.slice()},z.ace_getDebugProperty=function(a){if(a=="debugger")window.eval("debugger");else{if(a=="rep")return K;if(a=="window")return window;if(a=="document")return document}return undefined},z.ace_fastIncorp=ca;var cc=b_(function(){if(dN){cc.atLeast(500);return}bv("idleWorkTimer",function(){var a=b$(250),b=!1,c=!1;try{cn(a);if(a())return;et();if(a())return;var d=de(),e=[0,K.lines.totalWidth()];b=!0,c=!0}finally{if(c)cc.atMost(1e3);else if(b)cc.atMost(500);else{var f=Math.round(a.elapsed()/2);f<100&&(f=100),cc.atMost(f)}}})}),cd=1,ch;ci();var cp={bold:" b",italic:" i",underline:" u ",strikethrough:" s",list:"list"},cq={insertorder:!0,author:!0};z.ace_isCaret=cu,z.ace_getPointForLineAndChar=cz,z.ace_getLineAndCharForPoint=cB,z.ace_performDocumentApplyAttributesToCharRange=cK,z.ace_setAttributeOnSelection=cL,z.ace_toggleAttributeOnSelection=cN,z.ace_performSelectionChange=cU;var cY={div:1,p:1,pre:1,li:1,ol:1,ul:1};_.each(hooks.callAll("aceRegisterBlockElements"),function(a){cY[a]=1}),z.ace_markNodeClean=c_,z.ace_doIndentOutdent=dh,z.ace_doTabKey=di;var dk=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/,dl=/\s/,dq=[33,34,35,36,37,38,39,40,98,100,102,104],ds=!1;z.ace_doUndoRedo=dt;var du="";z.ace_updateBrowserSelectionFromRep=dv;var dJ=[],dN=!1,dX,dY,ej="list";z.ace_doInsertUnorderedList=eo,z.ace_doInsertOrderedList=ep;var eq,er,eu=!1;Z=new m(K,cE),z.ace_performDocumentApplyAttributesToRange=function(){return Z.setAttributesOnRange.apply(Z,arguments)},z.ace_setEditBodyPadding=function(a,b){a=Number(a),b=Number(b),isNaN(a)||(v=a),isNaN(b)||(u=b)},function(){P=document,bu("setup",function(){var a=P.getElementById(A);O=a,browser.mozilla&&$(O).addClass("mozilla"),browser.safari&&$(O).addClass("safari"),browser.msie&&$(O).addClass("msie");if(browser.msie)try{P.execCommand("BackgroundImageCache",!1,!0)}catch(b){}dT(O,"authorColors",!0),dT(O,"doesWrap",R),bi(),bH();while(O.firstChild)O.removeChild(O.firstChild);var c=cC("");cP(0,K.lines.length(),[c]),ct(null,[c.domInfo],null),K.alines=g.splitAttributionLines(g.makeAttribution("\n"),"\n"),dP()}),hooks.callAll("aceInitialized",{editorInfo:z,rep:K,documentAttributeManager:Z}),L.setTimeout(function(){parent.readyFunc()},0),o=!0}()}var editor,_,plugins,Ace2Common;Ace2Common=require("./ace2_common"),plugins=require("ep_etherpad-lite/static/js/pluginfw/plugins"),_=require("./underscore");var isNodeText=Ace2Common.isNodeText,browser=Ace2Common.browser,getAssoc=Ace2Common.getAssoc,setAssoc=Ace2Common.setAssoc,binarySearchInfinite=Ace2Common.binarySearchInfinite,htmlPrettyEscape=Ace2Common.htmlPrettyEscape,noop=Ace2Common.noop,hooks=require("./pluginfw/hooks");plugins.ensure(function(){var a=new Ace2Inner})
}
, "ep_etherpad-lite/static/js/skiplist.js": function (require, exports, module) {
function SkipList(){function g(a){var c=b.levels,d=c-1,e=-1,f=0,g=new Array(c),h=new Array(c),i=new Array(c);g[d]=b,h[d]=-1,i[d]=0;while(d>=0){var j=g[d];while(j.downPtrs[d]&&e+j.downSkips[d]<a)e+=j.downSkips[d],f+=j.downSkipWidths[d],j=j.downPtrs[d];g[d]=j,h[d]=e,i[d]=f,d--,d>=0&&(g[d]=j)}return{nodes:g,idxs:h,loc:a,widthSkips:i,toString:function(){return"getPoint("+a+")"}}}function h(a){var d=0,f=b,g=b.levels-1;while(g>=0&&f.downPtrs[g]){while(f.downPtrs[g]&&d+f.downSkipWidths[g]<=a)d+=f.downSkipWidths[g],f=f.downPtrs[g];g--}return f===b?b.downPtrs[0]||null:f===c?a==e?c.upPtrs[0]||null:null:f}function i(a){return a&&a.width||0}function j(g,h,j){var k=a("insertKey",!1),l={key:h,levels:0,upPtrs:[],downPtrs:[],downSkips:[],downSkipWidths:[]};k.mark("donealloc");var m=g.nodes,n=g.idxs,o=g.loc,p=g.widthSkips[0]+g.nodes[0].downSkipWidths[0],q=i(j);k.mark("loop1");while(l.levels==0||Math.random()<.01){var r=l.levels;l.levels++,r==m.length&&(m[r]=b,n[r]=-1,b.levels++,c.levels++,b.downPtrs[r]=c,c.upPtrs[r]=b,b.downSkips[r]=d+1,b.downSkipWidths[r]=e,g.widthSkips[r]=0);var s=l,t=m[r],u=t.downPtrs[r],v=o-n[r],w=t.downSkips[r]+1-v;t.downSkips[r]=v,t.downPtrs[r]=s,s.downSkips[r]=w,s.upPtrs[r]=t,s.downPtrs[r]=u,u.upPtrs[r]=s;var x=p-g.widthSkips[r],y=t.downSkipWidths[r]+q-x;t.downSkipWidths[r]=x,s.downSkipWidths[r]=y}k.mark("loop2"),k.literal(m.length,"PNL");for(var r=l.levels;r<m.length;r++){var t=m[r];t.downSkips[r]++,t.downSkipWidths[r]+=q}k.mark("map"),f["$KEY$"+h]=l,d++,e+=q,k.end()}function k(a){return a.nodes[0].downPtrs[0]}function l(a){a.loc++;for(var b=0;b<a.nodes.length;b++)a.idxs[b]+a.nodes[b].downSkips[b]<a.loc&&(a.idxs[b]+=a.nodes[b].downSkips[b],a.widthSkips[b]+=a.nodes[b].downSkipWidths[b],a.nodes[b]=a.nodes[b].downPtrs[b])}function m(a){var b=a.nodes[0].downPtrs[0],c=i(b.entry);for(var g=0;g<a.nodes.length;g++)if(g<b.levels){var h=b.upPtrs[g],j=b.downPtrs[g],k=h.downSkips[g]+b.downSkips[g]-1;h.downPtrs[g]=j,j.upPtrs[g]=h,h.downSkips[g]=k;var l=h.downSkipWidths[g]+b.downSkipWidths[g]-c;h.downSkipWidths[g]=l}else{var h=a.nodes[g],j=h.downPtrs[g];h.downSkips[g]--,h.downSkipWidths[g]-=c}delete f["$KEY$"+b.key],d--,e-=c}function n(a){var b=a.downSkipWidths[0],c=i(a.entry),d=c-b,f=a,g=0;while(g<f.levels){f.downSkipWidths[g]+=d,g++;while(g>=f.levels&&f.upPtrs[g-1])f=f.upPtrs[g-1]}e+=d}function o(a,c){var d=c?0:-1,e=a;while(e!==b){var f=e.levels-1;e=e.upPtrs[f],c?d+=e.downSkipWidths[f]:d+=e.downSkips[f]}return d}function p(a){return f["$KEY$"+a]}function q(a){function g(d){return d===b?!1:d===c?!0:a(d.entry)}var d=b,e=b.levels-1,f=-1;while(e>=0){var h=d.downPtrs[e];while(!g(h))f+=d.downSkips[e],d=h,h=d.downPtrs[e];e--}return f+1}var a=window.PROFILER;a||(a=function(){return{start:noop,mark:noop,literal:noop,end:noop,cancel:noop}});var b={key:null,levels:1,upPtrs:[null],downPtrs:[null],downSkips:[1],downSkipWidths:[0]},c={key:null,levels:1,upPtrs:[null],downPtrs:[null],downSkips:[null],downSkipWidths:[null]},d=0,e=0,f={};b.downPtrs[0]=c,c.upPtrs[0]=b;var r=this;_.extend(this,{length:function(){return d},atIndex:function(a){return a<0&&console.warn("atIndex("+a+")"),a>=d&&console.warn("atIndex("+a+">="+d+")"),k(g(a)).entry},splice:function(a,b,c){a<0&&console.warn("splice("+a+", ...)"),a+b>d&&(console.warn("splice("+a+", "+b+", ...), N="+d),console.warn("%s %s %s",typeof a,typeof b,typeof d),console.trace()),c||(c=[]);var e=g(a);for(var f=0;f<b;f++)m(e);for(var f=c.length-1;f>=0;f--){var h=c[f];j(e,h.key,h);var i=p(h.key);i.entry=h}},next:function(a){return p(a.key).downPtrs[0].entry||null},prev:function(a){return p(a.key).upPtrs[0].entry||null},push:function(a){r.splice(d,0,[a])},slice:function(a,b){a===undefined?a=0:a<0&&(a+=d),b===undefined?b=d:b<0&&(b+=d),a<0&&(a=0),a>d&&(a=d),b<0&&(b=0),b>d&&(b=d),dmesg(String([a,b,d]));if(b<=a)return[];var c=r.atIndex(a),e=[c];for(var f=1;f<b-a;f++)c=r.next(c),e.push(c);return e},atKey:function(a){return p(a).entry},indexOfKey:function(a){return o(p(a))},indexOfEntry:function(a){return r.indexOfKey(a.key)},containsKey:function(a){return!!p(a)},atOffset:function(a){return h(a).entry},keyAtOffset:function(a){return r.atOffset(a).key},offsetOfKey:function(a){return o(p(a),!0)},offsetOfEntry:function(a){return r.offsetOfKey(a.key)},setEntryWidth:function(a,b){a.width=b,n(p(a.key))},totalWidth:function(){return e},offsetOfIndex:function(a){return a<0?0:a>=d?e:r.offsetOfEntry(r.atIndex(a))},indexOfOffset:function(a){return a<=0?0:a>=e?d:r.indexOfEntry(r.atOffset(a))},search:function(a){return q(a)},debugGetPoint:g,debugDepth:function(){return b.levels}})}var Ace2Common=require("./ace2_common"),_=require("./underscore"),noop=Ace2Common.noop;module.exports=SkipList
}
, "ep_etherpad-lite/static/js/virtual_lines.js": function (require, exports, module) {
function makeVirtualLineView(a){function d(){return a.textContent.length}function e(){if(!c){var a=i();a.forwardByWhile(b),c=a}return c.getVirtualLine()+1}function f(a){var c=i();c.forwardByWhile(b,null,a);var d=c.getVirtualLine();c.backwardByWhile(8,function(){return c.getVirtualLine()==d}),c.forwardByWhile(1,function(){return c.getVirtualLine()!=d});var e=c.getOffset();return{vline:d,offset:a-e}}function g(a,c){var f=i();f.binarySearch(function(){return f.getVirtualLine()>=a});var g=f.getOffset(),h=f.getVirtualLine();f.forwardByWhile(b,null,g+c),f.backwardByWhile(1,function(){return f.getVirtualLine()!=h},g);var j=f.getOffset(),k=j-g;if(k<c&&h==e()-1){var l=d();k+=l-j,j=l}return{vline:h,offset:k,lineChar:j}}function h(a){a=a.firstChild;while(a&&a.firstChild)a=a.firstChild;return a.data?a:null}function i(){function b(a,b){var c=a.parentNode,d=a.nodeValue.charAt(b)===" ";if(d)if(b==0){if(!c.previousSibling||!h(c.previousSibling))return{top:c.offsetTop,left:c.offsetLeft};a=h(c.previousSibling),b=a.length-1,c=a.parentNode}else b--;var e=document.createElement("SPAN"),f=a.nodeValue,g=document.createDocumentFragment();g.appendChild(document.createTextNode(f.substring(0,b))),e.appendChild(document.createTextNode(f.substr(b,1))),g.appendChild(e),g.appendChild(document.createTextNode(f.substring(b+1))),c.replaceChild(g,a);var i={top:e.offsetTop,left:e.offsetLeft+(d?e.offsetWidth:0),height:e.offsetHeight};while(c.firstChild)c.removeChild(c.firstChild);return c.appendChild(a),i}function m(){var b=e;b?b=b.nextSibling:b=a.firstChild;while(b&&!h(b))b=b.nextSibling;return b}function n(){var b=e;b?b=b.previousSibling:b=a.lastChild;while(b&&!h(b))b=b.previousSibling;return b}function r(a,b,c,d){var e=null,g=typeof c=="function",h=c,i=typeof d=="number",j=d;while(e!==0&&(!g||h())){var k=b;if(i){var l=a?f-j:j-f;l<k&&(k=l)}if(k<0)break;e=a?o.backward(k):o.forward(k)}}var c=a.textContent,d=c.length,e=null,f=0,g=0,i,j,k,l=0,o;if(d>0){e=m();var p=b(h(e),0);k=p.height,i=p.top,j=p.left;function q(a,c){var d=b(a,c);l+=Math.round((d.top-i)/k),i=d.top,j=d.left}o={forward:function(a){var b=f,c=f+a;c>d-1&&(c=d-1);while(f<c){var i=h(e).length,j=i-g;if(f+j>c||!m()){var k=c-f;k>=j&&(k=j-1),f+=k,g+=k;break}f+=j,g=0,e=m()}return q(h(e),g),f-b},backward:function(a){var b=f,c=f-a;c<0&&(c=0);while(f>c){if(f-g<=c||!n()){var d=f-c;d>g&&(d=g),f-=d,g-=d;break}f-=g+1,e=n(),g=h(e).length-1}return q(h(e),g),b-f},getVirtualLine:function(){return l},getLeftCoord:function(){return j}}}else j=a.offsetLeft,o={forward:function(a){return 0},backward:function(a){return 0},getVirtualLine:function(){return 0},getLeftCoord:function(){return j}};return o.getOffset=function(){return f},o.getLineLength=function(){return d},o.toString=function(){return"seeker[curChar: "+f+"("+c.charAt(f)+"), left: "+o.getLeftCoord()+", vline: "+o.getVirtualLine()+"]"},o.forwardByWhile=function(a,b,c){r(!1,a,b,c)},o.backwardByWhile=function(a,b,c){r(!0,a,b,c)},o.binarySearch=function(a){var b=a,c=function(){return!a()};return o.forwardByWhile(20,c),o.backwardByWhile(20,b),o.forwardByWhile(10,c),o.backwardByWhile(5,b),o.forwardByWhile(1,c),o.getOffset()+(a()?0:1)},o}var b=20,c=null;return{getNumVirtualLines:e,getVLineAndOffsetForChar:f,getCharForVLineAndOffset:g,makeCharSeeker:function(){return i()}}}exports.makeVirtualLineView=makeVirtualLineView
}
, "ep_etherpad-lite/static/js/cssmanager.js": function (require, exports, module) {
function makeCSSManager(a){function b(a){var b=document.styleSheets;for(var c=0;c<b.length;c++){var d=b[c];if(d.title==a)return d}return null}function d(){return c.cssRules||c.rules}function e(a){c.deleteRule?c.deleteRule(a):c.removeRule(a)}function f(a,b){c.insertRule?c.insertRule(b+" {}",a):c.addRule(b,null,a)}function h(a){for(var b=0;b<g.length;b++)if(g[b]==a)return b;return-1}function i(a){var b=h(a);return b<0&&(f(0,a),g.splice(0,0,a),b=0),d().item(b).style}function j(a){var b=h(a);b>=0&&(e(b),g.splice(b,1))}var c=b(a),g=[];return{selectorStyle:i,removeSelectorStyle:j,info:function(){return g.length+":"+d().length}}}exports.makeCSSManager=makeCSSManager
}
, "ep_etherpad-lite/static/js/colorutils.js": function (require, exports, module) {
var colorutils={};colorutils.css2triple=function(a){function c(a){return Number("0x"+a)/255}var b=colorutils.css2sixhex(a);return[c(b.substr(0,2)),c(b.substr(2,2)),c(b.substr(4,2))]},colorutils.css2sixhex=function(a){var b=/[0-9a-fA-F]+/.exec(a)[0];if(b.length!=6){var c=b.charAt(0),d=b.charAt(1),e=b.charAt(2);b=c+c+d+d+e+e}return b},colorutils.triple2css=function(a){function b(a){var b=colorutils.clamp(Math.round(a*255),0,255);return("0"+b.toString(16)).slice(-2)}return"#"+b(a[0])+b(a[1])+b(a[2])},colorutils.clamp=function(a,b,c){return a<b?b:a>c?c:a},colorutils.min3=function(a,b,c){return a<b?a<c?a:c:b<c?b:c},colorutils.max3=function(a,b,c){return a>b?a>c?a:c:b>c?b:c},colorutils.colorMin=function(a){return colorutils.min3(a[0],a[1],a[2])},colorutils.colorMax=function(a){return colorutils.max3(a[0],a[1],a[2])},colorutils.scale=function(a,b,c){return colorutils.clamp(b+a*(c-b),0,1)},colorutils.unscale=function(a,b,c){return colorutils.clamp((a-b)/(c-b),0,1)},colorutils.scaleColor=function(a,b,c){return[colorutils.scale(a[0],b,c),colorutils.scale(a[1],b,c),colorutils.scale(a[2],b,c)]},colorutils.unscaleColor=function(a,b,c){return[colorutils.unscale(a[0],b,c),colorutils.unscale(a[1],b,c),colorutils.unscale(a[2],b,c)]},colorutils.luminosity=function(a){return a[0]*.3+a[1]*.59+a[2]*.11},colorutils.saturate=function(a){var b=colorutils.colorMin(a),c=colorutils.colorMax(a);return c-b<=0?[1,1,1]:colorutils.unscaleColor(a,b,c)},colorutils.blend=function(a,b,c){return[colorutils.scale(c,a[0],b[0]),colorutils.scale(c,a[1],b[1]),colorutils.scale(c,a[2],b[2])]},colorutils.invert=function(a){return[1-a[0],1-a[1],1-a[2]]},colorutils.complementary=function(a){var b=colorutils.invert(a);return[b[0]>=a[0]?Math.min(b[0]*1.3,1):a[0]*.3,b[1]>=a[1]?Math.min(b[1]*1.59,1):a[1]*.59,b[2]>=a[2]?Math.min(b[2]*1.11,1):a[2]*.11]},exports.colorutils=colorutils
}
, "ep_etherpad-lite/static/js/undomodule.js": function (require, exports, module) {
var Changeset=require("./Changeset"),_=require("./underscore"),undoModule=function(){function c(){a.clearStack(),b=0}function d(a,b){var c=0,d=0;while(c>=0&&c<a.length)c=a.indexOf(b,c),c>=0&&(d++,c++);return d}function e(a,b){return d(Changeset.unpack(a).ops,b)}function f(a,b){if(!a)return b;if(!b)return a;var c=e(a,"+"),d=e(b,"+"),f=e(a,"-"),g=e(b,"-");if(c==1&&d==1&&f==0&&g==0){var h=Changeset.compose(a,b,l()),i=e(h,"+"),j=e(h,"-");if(i==1&&j==0)return h}else if(c==0&&d==0&&f==1&&g==1){var h=Changeset.compose(a,b,l()),i=e(h,"+"),j=e(h,"-");if(i==0&&j==1)return h}return null}function g(c){function e(){typeof c.selStart=="number"&&(d.selStart=c.selStart,d.selEnd=c.selEnd,d.selFocusAtStart=c.selFocusAtStart)}var d=a.getNthFromTop(0);if(!c.backset||Changeset.isIdentity(c.backset))e();else{var g=!1;if(d.eventType==c.eventType){var h=f(c.backset,d.backset);h&&(d.backset=h,e(),g=!0)}g||a.pushEvent(c),b=0}}function h(b){b&&!Changeset.isIdentity(b)&&a.pushExternalChange(b)}function i(a){return typeof a.selStart!="number"?null:{selStart:a.selStart,selEnd:a.selEnd,selFocusAtStart:a.selFocusAtStart}}function j(c){if(b<a.numEvents()-1){var d=a.getNthFromTop(b),e=a.getNthFromTop(b+1),f=c(d.backset,i(e));a.pushEvent(f),b+=2}else c()}function k(c){if(b>=2){var d=a.getNthFromTop(0),e=a.getNthFromTop(1);c(d.backset,i(e)),a.popEvent(),b-=2}else c()}function l(){return undoModule.apool}var a=function(){function e(){a.length=0,a.push({elementType:c,eventType:"bottom"}),b=1}function f(d){var e=_.extend({},d);e.elementType=c,a.push(e),b++}function g(b){var c=a.length-1;a[c].elementType==d?a[c].changeset=Changeset.compose(a[c].changeset,b,l()):a.push({elementType:d,changeset:b})}function h(b){var c=a.length-1-b,e=a.length-1;while(e>c||a[e].elementType==d)if(a[e].elementType==d){var f=a[e],g=a[e-1];if(g.backset){var h=f.changeset,i=g.backset;g.backset=Changeset.follow(h,g.backset,!1,l()),f.changeset=Changeset.follow(i,f.changeset,!0,l());if(typeof g.selStart=="number"){var j=Changeset.characterRangeFollow(h,g.selStart,g.selEnd);g.selStart=j[0],g.selEnd=j[1],g.selStart==g.selEnd&&(g.selFocusAtStart=!1)}}a[e-1]=f,a[e]=g,e>=2&&a[e-2].elementType==d&&(f.changeset=Changeset.compose(a[e-2].changeset,f.changeset,l()),a.splice(e-2,1),e--)}else e--}function i(b){return h(b),a[a.length-1-b]}function j(){return b}function k(){return h(0),b--,a.pop()}var a=[],b=0,c="undoableEvent",d="externalChange";return e(),{numEvents:j,popEvent:k,pushEvent:f,pushExternalChange:g,clearStack:e,getNthFromTop:i}}(),b=0;return{clearHistory:c,reportEvent:g,reportExternalChange:h,performUndo:j,performRedo:k,enabled:!0,apool:null}}();exports.undoModule=undoModule
}
, "ep_etherpad-lite/static/js/contentcollector.js": function (require, exports, module) {
function sanitizeUnicode(a){return a.replace(/[\uffff\ufffe\ufeff\ufdd0-\ufdef\ud800-\udfff]/g,"?")}function makeContentCollector(a,b,c,d,e){function f(a){var b,c={},d;return(b=i.exec(a)||j.exec(a))?(d=b[1]||1,c={listNum:d,listScheme:"number"}):k.exec(a)&&(d=1,c={listNum:d,listScheme:"char"}),c}function g(a){return a&&!!a.current}function h(){return{current:null,previous:null}}function o(a){return!!m[(l.nodeTagName(a)||"").toLowerCase()]}function p(a){return sanitizeUnicode(a.replace(/[\n\r ]/g," ").replace(/\xa0/g," ").replace(/\t/g,"        "))}function q(a,b){return l.nodeProp(a,"_magicdom_"+b)}function t(a){r.atColumnZero()||s.startNewLine(a)}function z(a,b){if(l.nodeNumChildren(a)==0)return!0;if(l.nodeNumChildren(a)==1&&q(a,"shouldBeEmpty")&&l.optNodeInnerHTML(a)=="&nbsp;"&&!q(a,"unpasted")){if(b){var c=l.nodeChild(a,0);C(c,0,b),C(c,1,b)}return!0}return!1}function A(a,b){var c=r.length()-1,d=r.textOfLine(c).length;return d==0&&!_.isEmpty(b.lineAttributes)&&(d+=1),d+=a,[c,d]}function B(a,b,c){l.isNodeText(a)||C(a,b,c)}function C(a,b,c){v&&a==v.node&&v.index==b&&(x=A(0,c)),w&&a==w.node&&w.index==b&&(y=A(0,c))}function D(a,b,c){var d=a.lineAttributes.list,e=a.lineAttributes.start;return b!="none"&&(a.listNesting=(a.listNesting||0)+1),b==="none"||!b?delete a.lineAttributes.list:(a.lineAttributes.list=b,c&&b.match("number")&&c.getAttribute("start")?a.lineAttributes.start=c.getAttribute("start"):delete a.lineAttributes.start),H(a),[d,e]}function E(a,b,c){a.lineAttributes.list&&a.listNesting--,b&&b!="none"?(a.lineAttributes.list=b,a.lineAttributes.start=c):(delete a.lineAttributes.list,delete a.lineAttributes.start),a.wordPList=h(),H(a)}function F(a,b){var c=a.author;return a.authorLevel=(a.authorLevel||0)+1,a.author=b,H(a),c}function G(a,b){a.authorLevel--,a.author=b,H(a)}function H(a){var b=[];for(var d in a.attribs)a.attribs[d].counter&&b.push([d,a.attribs[d].val?a.attribs[d].val:"true"]);if(a.authorLevel>0){var e=["author",a.author];c.putAttrib(e,!0)>=0&&b.push(e)}a.attribString=Changeset.makeAttribsString("+",b,c)}function I(a){var b=[["lmkr","1"],["insertorder","first"]].concat(_.map(a.lineAttributes,function(a,b){return[b,a]}));r.appendText("*",Changeset.makeAttribsString("+",b,c))}b=b||{};var i=/^(\d+)(\.|\))/,j=/^\d+\.(\d+)(\.\))?/,k=/^([A-Za-z]+)(\.|\))/,l=d||{isNodeText:function(a){return a.nodeType==3},nodeTagName:function(a){return a.tagName},nodeValue:function(a){return a.nodeValue},nodeNumChildren:function(a){return a.childNodes.length},nodeChild:function(a,b){return a.childNodes.item(b)},nodeProp:function(a,b){return a[b]},nodeAttr:function(a,b){return a.getAttribute(b)},nodeInsideOf:function(a,b){found=!1;while(b&&b.parentNode&&!found)b===a?found=!0:b.parentNode&&(b=b.parentNode);return found},optNodeInnerHTML:function(a){return a.innerHTML}},m={div:1,p:1,pre:1,li:1,table:1},n={ul:1,ol:1};_.each(hooks.callAll("ccRegisterBlockElements"),function(a){m[a]=1});var r=function(){var a=[],b=[],d=null,e=Changeset.newOp("+"),f={length:function(){return a.length},lastLineValue:function(){return a[a.length-1]},atColumnZero:function(){return this.lastLineValue()===""},startNew:function(){a.push(""),f.flush(!0),d=Changeset.smartOpAssembler()},textOfLine:function(b){return a[b]},appendText:function(b,c,f){a[a.length-1]+=b,e.attribs=c,e.chars=b.length,d.append(e)},appendAttrTextToApool:function(a,b){this.appendText(a,Changeset.makeAttribsString("+",b,c))},textLines:function(){return a.slice()},attribLines:function(){return b},flush:function(a){d&&(b.push(d.toString()),d=null)}};return f.startNew(),f}(),s={},u,v,w,x=[-1,-1],y=[-1,-1];s.incrementFlag=function(a,b){a.flags[b]=(a.flags[b]||0)+1},s.decrementFlag=function(a,b){a.flags[b]--},s.incrementAttrib=function(a,b){if(typeof b=="object")var c=b.name;else var c=b;var d=b&&b.val||null;a.attribs[c]?(a.attribs[c].counter++,a.attribs[c].val=d):a.attribs[c]={counter:1,val:d},H(a)},s.decrementAttrib=function(a,b){if(typeof b=="object")var c=b.name;else var c=b;a.attribs[c].counter--,H(a)},s.startNewLine=function(a){if(a){var b=r.textOfLine(r.length()-1).length==0;a.lineAttributes&&a.lineAttributes.tasklist&&(delete a.lineAttributes.tasklist,delete a.lineAttributes.list),b&&!_.isEmpty(a.lineAttributes)&&I(a)}r.startNew()},s.notifySelection=function(a){a&&(u=a,v=u.startPoint,w=u.endPoint)},s.doAttrib=function(a,b){a.localAttribs=a.localAttribs||[],a.localAttribs.push(b),s.incrementAttrib(a,b)},s.collectContent=function(c,d,i){d||(d={flags:{},localAttribs:null,attribs:{},attribString:"",lineAttributes:{},wordPList:h()});var j={text:"",set:function(a){this.text+=a},get:function(){return this.text},clear:function(){this.text=""}},k=!1;c.nodeType==8&&(c.nodeValue.indexOf("[if")===0&&(k=!0,d.ifStarted=!0),d.ifStarted&&c.nodeValue.indexOf("[endif]")!=-1&&delete d.ifStarted);if(d.ifStarted||k)return;var m=d.localAttribs,q={};d.localAttribs=null;var u=o(c),C=z(c,d);u&&t(d);var H=r.length()-1;B(c,0,d);if(l.isNodeText(c)){var J=l.nodeValue(c),K="",L=0;J.length==0&&(v&&c==v.node&&(x=A(0,d)),w&&c==w.node&&(y=A(0,d)));while(J.length>0){var M=0;if(d.flags.preMode){var N=J.split("\n",1)[0];M=N.length+1,K=J.substring(M),J=N}v&&c==v.node&&v.index-L<=J.length&&(x=A(v.index-L,d)),w&&c==w.node&&w.index-L<=J.length&&(y=A(w.index-L,d));var O=J;!d.flags.preMode&&/^[\r\n]*$/.exec(J)&&(O="");var P=r.textOfLine(r.length()-1).length==0;P&&(O=O.replace(/^\n*/,""));var Q=c._parentNode||c.parentNode,R=(Q._nodeName||Q.nodeName||"").toLowerCase(),S=n[R],T=O.replace("\r","").replace("\n","").trim()=="",U=S&&T;if(!U){var V={cc:s,state:d,node:c,lines:r,ptc:j,cAttribs:q,text:O};hooks.callAll("collectTextContentPre",V),P&&!_.isEmpty(d.lineAttributes)&&I(d),r.appendText(p(V.text),d.attribString)}L+=M,J=K,J.length>0&&s.startNewLine(d)}}else{var W=(l.nodeTagName(c)||"").toLowerCase();W=="br"&&s.startNewLine(d);if(c.id=="etherpad-paste"){v&&(v.node==c||l.nodeInsideOf(c,v.node))&&(x=[0,1],y=[0,1]);return}if(W!="script"&&W!="style")if(!C||W=="input"||W=="img"||W=="span"&&(c.className||"").indexOf("etherpad-loader")!=-1){var X=l.nodeAttr(c,"style")||"",Y=l.nodeProp(c,"className"),Z=W=="pre";!Z&&b.safari&&(Z=X&&/\bwhite-space:\s*pre\b/i.exec(X)),Z&&s.incrementFlag(d,"preMode");var $=null,ba=null,bb=null;if(a){hooks.callAll("collectContentPre",{cc:s,state:d,tname:W,styl:X,cls:Y,node:c,lines:r,ptc:j,cAttribs:q}),(W=="b"||X&&/\bfont-weight:\s*bold\b/i.exec(X)||W=="strong")&&s.doAttrib(d,"bold"),(W=="i"||X&&/\bfont-style:\s*italic\b/i.exec(X)||W=="em")&&s.doAttrib(d,"italic"),(W=="u"||X&&/\btext-decoration:\s*underline\b/i.exec(X)||W=="ins")&&s.doAttrib(d,"underline"),(W=="s"||W=="strike"||X&&/\btext-decoration:\s*line-through\b/i.exec(X)||W=="del")&&s.doAttrib(d,"strikethrough");if(!!q.skipList||W!="ul"&&W!="ol")if(W=="p"&&X.match(/(?:^| )level/)){var bh=/(?:^| )level(\d)/.exec(X),bi=/mso-list:(.+?) /.exec(X),bj=bh&&bh[1];if(bj){var bk=bi+"="+bh,bl;u=!1;var bm=(c.innerText||"").trim();if(!d.wordPList.current||d.wordPList.current.id!=bk){d.wordPList.current&&bj<d.wordPList.current.level&&delete d.wordPList[d.wordPList.current.id];if(d.wordPList[bk])bl=d.wordPList[bk];else{bl={id:bk,level:bj,type:null,listNum:0};var bn=f(bm);bl.type=bn.listNum?"number":"bullet",bl.listNum=bn.listNum,d.wordPList[bk]=bl}d.wordPList.current=bl}else bl=d.wordPList.current;bl.type=="number"?(d.lineAttributes.list="number"+bl.level,d.lineAttributes.start=bl.listNum++):d.lineAttributes.list="bullet"+bl.level}}else if(W=="li"){var bo=d.lineAttributes,bp=bo.list;bp&&bp.match("number")&&(bo.start?(bo.start++,isNaN(bo.start)&&(bo.start=1)):bo.start=1)}else if((W=="div"||W=="p")&&Y&&Y.match(/(?:^| )ace-line\b/)){var bg=D(d,bc);$=bg[0]||"none",ba=bg[1]}else(W=="div"||W=="p")&&g(d.wordPList)&&(d.wordPList=h(),delete d.lineAttributes.list);else{var bc,bd=Y&&/(?:^| )list-([a-z]+[12345678])\b/.exec(Y);if(!bd){var be=l.nodeAttr(c,"rel");bd=be&&/(?:^| )list-([a-z]+[12345678])\b/.exec(be)}var bf=W=="ol"?"number":"bullet";bc=bd&&bd[1]||bf+String(Math.min(_MAX_LIST_LEVEL,(d.listNesting||0)+1));var bg=D(d,bc,c);$=bg[0]||"none",ba=bg[1]}if(e&&Y){var bq=Y.match(/\S+/g);if(bq&&bq.length>0)for(var br=0;br<bq.length;br++){var bs=bq[br],bt=e(bs);if(bt){bb=F(d,bt)||"none";break}}}}if(isClient&&j.get()){var P=r.textOfLine(r.length()-1).length==0;P&&!_.isEmpty(d.lineAttributes)&&I(d),r.appendText(j.get(),d.attribString),j.clear(),v&&v.node&&l.nodeInsideOf(c,v.node)&&(x=[r.length()-1,(c.innerText||c.textContent||"").length+1]),w&&w.node&&l.nodeInsideOf(c,w.node)&&(y=[r.length()-1,(c.innerText||c.textContent||"").length+1])}else if(!q.cancelCollection){var bu=l.nodeNumChildren(c);for(var br=0;br<bu;br++){var bs=l.nodeChild(c,br);s.collectContent(bs,d)}}a&&hooks.callAll("collectContentPost",{cc:s,state:d,tname:W,styl:X,cls:Y}),Z&&s.decrementFlag(d,"preMode");if(d.localAttribs)for(var br=0;br<d.localAttribs.length;br++)s.decrementAttrib(d,d.localAttribs[br]);$&&E(d,$,ba),bb&&G(d,bb)}}b.msie||B(c,1,d),u&&(r.length()-1==H?s.startNewLine(d):t(d)),b.msie&&B(c,1,d),d.localAttribs=m},s.notifyNextNode=function(a){(!a||o(a)&&!z(a))&&t(null)};var J=function(){return x},K=function(){return y};return s.getLines=function(){return r.textLines()},s.finish=function(){function e(){var e=2e3,f=10,g=0,h=0;for(var i=b.length-1;i>=0;i--){var j=b[i],k=a[i];if(j.length>e+f){var l=[],m=[];while(j.length>e)lengthToTake=e,l.push(j.substring(0,lengthToTake)),j=j.substring(lengthToTake),m.push(Changeset.subattribution(k,0,lengthToTake)),k=Changeset.subattribution(k,lengthToTake);j.length>0&&(l.push(j),m.push(k));function n(a){if(a[0]<0)return;var b=a[0],c=a[1];if(b>i)b+=l.length-1;else if(b==i){var d=0;while(c>l[d].length)c-=l[d].length,d++;b+=d}a[0]=b,a[1]=c}n(c),n(d),g++,h+=l.length,l.unshift(i,1),b.splice.apply(b,l),m.unshift(i,1),a.splice.apply(a,m)}}return{linesWrapped:g,numLinesAfter:h}}r.flush();var a=r.attribLines(),b=s.getLines();b.length--,a.length--;var c=J(),d=K(),f=e();return{selStart:c,selEnd:d,linesWrapped:f.linesWrapped,numLinesAfter:f.numLinesAfter,lines:b,lineAttribs:a}},s}var _MAX_LIST_LEVEL=8,Changeset=require("./Changeset"),hooks=require("./pluginfw/hooks"),_=require("./underscore"),isClient=typeof global!="object";exports.sanitizeUnicode=sanitizeUnicode,exports.makeContentCollector=makeContentCollector
}
, "ep_etherpad-lite/static/js/changesettracker.js": function (require, exports, module) {
function unifyAuthor(a,b,c){var d=Changeset.unpack(a),e=Changeset.opIterator(d.ops),f=Changeset.opAssembler();while(e.hasNext()){var g=e.next(),h="";Changeset.eachAttribNumber(g.attribs,function(a){var d=b.getAttribKey(a),e=b.getAttribValue(a);if(d!="author"||d=="author"&&e==c)h+="*"+Changeset.numToString(a)}),g.attribs=h,f.append(g)}var i=Changeset.pack(d.oldLen,d.newLen,f.toString(),d.charBank);return i}function makeChangesetTracker(a,b,c){function k(){i&&j===null&&(j=a.setTimeout(function(){try{g&&i()}finally{j=null}},0))}var d=Changeset.makeAText("\n"),e=null,f=Changeset.identity(1),g=!1,h=!1,i=null,j=null,l;return l={isTracking:function(){return g},setBaseText:function(a){l.setBaseAttributedText(Changeset.makeAText(a),null)},clearText:function(){c.withCallbacks("setBaseText",function(a){g=!1,e=null;try{a.clearText()}finally{h=!0}})},setBaseAttributedText:function(a,i){c.withCallbacks("setBaseText",function(c){d=Changeset.cloneAText(a);if(i){var j=(new AttributePool).fromJsonable(i);d.attribs=Changeset.moveOpsToNewPool(d.attribs,j,b)}e=null,f=Changeset.identity(a.text.length),h=!0;try{c.setDocumentAttributedText(a)}finally{h=!1,g=!0}})},composeUserChangeset:function(a,c){if(!g)return;if(h)return;if(Changeset.isIdentity(a))return;f=Changeset.compose(f,a,b),f=unifyAuthor(f,b,c),k()},applyChangesToBase:function(a,i,j){if(!g)return;c.withCallbacks("applyChangesToBase",function(c){if(j){var g=(new AttributePool).fromJsonable(j);a=Changeset.moveOpsToNewPool(a,g,b)}d=Changeset.applyToAText(a,d,b);var i=a;if(e){var k=e;e=Changeset.follow(a,k,!1,b),i=Changeset.follow(k,a,!0,b)}var l=!0,m=f;Changeset.isIdentity(f)?f=Changeset.identity(Changeset.newLen(i)):f=Changeset.follow(i,m,l,b);var n=Changeset.follow(m,i,!l,b),o=!0;h=!0;try{c.applyChangesetToDocument(n,o,g)}finally{h=!1}})},prepareUserChangeset:function(){if(!g)return;var a;e?a=Changeset.compose(e,f,b):Changeset.isIdentity(f)?a=null:a=f;var c=null;a&&(e=a,f=Changeset.identity(Changeset.newLen(a)),c=a);var d=null;if(c){var h=Changeset.prepareForWire(c,b);d=h.pool.toJsonable(),c=h.translated}var i={changeset:c,apool:d};return i},applyPreparedChangesetToBase:function(){if(!e)return!1;d=Changeset.applyToAText(e,d,b),e=null},setUserChangeNotificationCallback:function(a){i=a},hasUncommittedChanges:function(){return!!e||!Changeset.isIdentity(f)}}}var AttributePool=require("./AttributePool"),Changeset=require("./Changeset");exports.makeChangesetTracker=makeChangesetTracker
}
, "ep_etherpad-lite/static/js/underscore.js": function (require, exports, module) {
((function(){function A(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&w.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&A(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(w.has(a,h)){f++;if(!(g=w.has(b,h)&&A(a[h],b[h],c)))break}if(g){for(h in b)if(w.has(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new E(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=w),exports._=w):a._=w,w.VERSION="1.3.1";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(w.has(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=w.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=w.toArray(a).reverse();return d&&!e&&(b=w.bind(b,d)),e?w.reduce(f,b,c,d):w.reduce(f,b)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var y=w.some=w.any=function(a,b,d){b||(b=w.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=y(a,function(a){return a===b}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(w.isFunction(b)?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a))return Math.max.apply(Math,a);if(!b&&w.isEmpty(a))return-Infinity;var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a))return Math.min.apply(Math,a);if(!b&&w.isEmpty(a))return Infinity;var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.shuffle=function(a){var b=[],c;return x(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},w.sortBy=function(a,b,c){return w.pluck(w.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={},d=w.isFunction(b)?b:function(a){return a[b]};return x(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?a.toArray?a.toArray():w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):w.values(a):[]},w.size=function(a){return w.toArray(a).length},w.first=w.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},w.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a,b){return w.reduce(a,function(a,c){return w.isArray(c)?a.concat(b?c:w.flatten(c)):(a[a.length]=c,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b,c){var d=c?w.map(a,c):a,e=[];return w.reduce(d,function(c,d,f){if(0==f||(b===!0?w.last(c)!=d:!w.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a){var b=w.flatten(g.call(arguments,1));return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var z=function(){};w.bind=function(b,c){var d,e;if(b.bind===v&&v)return v.apply(b,g.call(arguments,1));if(!w.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){z.prototype=b.prototype;var a=new z,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return w.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))},w.throttle=function(a,b){var c,d,e,f,g,h=w.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},w.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},w.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)w.has(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isObject(a)?w.isArray(a)?a.slice():w.extend({},a):a},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){return A(a,b,[])},w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(w.has(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)=="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return i.call(a)=="[object Arguments]"},w.isArguments(arguments)||(w.isArguments=function(a){return!!a&&!!w.has(a,"callee")}),w.isFunction=function(a){return i.call(a)=="[object Function]"},w.isString=function(a){return i.call(a)=="[object String]"},w.isNumber=function(a){return i.call(a)=="[object Number]"},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},w.isDate=function(a){return i.call(a)=="[object Date]"},w.isRegExp=function(a){return i.call(a)=="[object RegExp]"},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.has=function(a,b){return j.call(a,b)},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.mixin=function(a){x(w.functions(a),function(b){G(b,w[b]=a[b])})};var B=0;w.uniqueId=function(a){var b=B++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};w.template=function(a,b){var c=w.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||C,function(a,b){return"',_.escape("+D(b)+"),'"}).replace(c.interpolate||C,function(a,b){return"',"+D(b)+",'"}).replace(c.evaluate||C,function(a,b){return"');"+D(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,w):function(a){return e.call(this,a,w)}},w.chain=function(a){return w(a).chain()};var E=function(a){this._wrapped=a};w.prototype=E.prototype;var F=function(a,b){return b?w(a).chain():a},G=function(a,b){E.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),F(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];E.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],F(c,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];E.prototype[a]=function(){return F(b.apply(this._wrapped,arguments),this._chain)}}),E.prototype.chain=function(){return this._chain=!0,this},E.prototype.value=function(){return this._wrapped}})).call(this)
}
, "ep_etherpad-lite/static/js/security.js": function (require, exports, module) {
function escapeHTML(a){return a&&a.replace(HTML_CHARACTERS_EXPRESSION,function(a){return HTML_ENTITY_MAP[a]||a})}function escapeHTMLAttribute(a){return a&&a.replace(HTML_ATTRIBUTE_CHARACTERS_EXPRESSION,function(a){return"&#x"+("00"+a.charCodeAt(0).toString(16)).slice(-2)+";"})}function escapeJavaScriptData(a){return a&&a.replace(JAVASCRIPT_CHARACTERS_EXPRESSION,function(a){return"\\x"+("00"+a.charCodeAt(0).toString(16)).slice(-2)})}function escapeURL(a){return a.replace(/[ '"<>]/g,function(a){return"%"+a.charCodeAt(a).toString(16)})}function escapeURLWithMailto(a){return a.indexOf("mailto")==0?encodeURI(a).replace(/,/g,"%2C"):escapeHTMLAttribute(a)}function validateURL(a){return checkUrlSchemeRegEx.test(a||"")||checkDocugateRegEx.test(a||"")||checkDmsRegEx.test(a||"")}var urlSchemeRegEx=/((https?|s?ftp|ftps|file|d3|smb|afp|nfs|(x-)?man|gopher|txmt|conisio|starteam|calshow|onenote|onenote:https?|(N|n)otes):\/\/|mailto:|shareddrive:)/,checkUrlSchemeRegEx=new RegExp("^"+urlSchemeRegEx.source),docugateRegEx=/docugate:(%20| )*\/template:(%22|")[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}(%22|")(%20| )*\/doclanguagekey:(%22|")[A-Z]+(%22|")/i,checkDocugateRegEx=new RegExp("^"+docugateRegEx.source,"i"),dmsRegEx=/dms:(%20| )*[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}/i,checkDmsRegEx=new RegExp("^"+dmsRegEx.source,"i"),HTML_ENTITY_MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},HTML_CHARACTERS_EXPRESSION=/[&"'<>\/]/g,HTML_ATTRIBUTE_CHARACTERS_EXPRESSION=/[\x00-\x2F\x3A-\x40\x5B-\x60\x7B-\xFF]/g,JAVASCRIPT_CHARACTERS_EXPRESSION=/[\x00-\x2F\x3A-\x40\x5B-\x60\x7B-\xFF]/g;exports.escapeHTML=escapeHTML,exports.escapeHTMLAttribute=escapeHTMLAttribute,exports.escapeJavaScriptData=escapeJavaScriptData,exports.urlSchemeRegEx=urlSchemeRegEx,exports.docugateRegEx=docugateRegEx,exports.dmsRegEx=dmsRegEx,exports.escapeURL=escapeURL,exports.validateURL=validateURL,exports.escapeURLWithMailto=escapeURLWithMailto
}
, "ep_etherpad-lite/static/js/pluginfw/plugins.js": function (require, exports, module) {
exports.isClient=typeof global!="object";var _;if(!exports.isClient){var npm=require("npm/lib/npm.js"),readInstalled=require("./read-installed.js"),relativize=require("npm/lib/utils/relativize.js"),readJson=require("npm/lib/utils/read-json.js"),path=require("path"),async=require("async"),fs=require("fs"),tsort=require("./tsort"),util=require("util");_=require("underscore");var settings=require("ep_etherpad-lite/node/utils/Settings")}else _=require("ep_etherpad-lite/static/js/underscore");exports.prefix="ep_",exports.loaded=!1,exports.plugins={},exports.parts=[],exports.hooks={},exports.baseURL="",exports.ensure=function(a){exports.loaded?a():exports.update(a)},exports.formatPlugins=function(){return _.keys(exports.plugins).join(", ")},exports.formatParts=function(){return _.map(exports.parts,function(a){return a.full_name}).join("\n")},exports.formatHooks=function(a){var b=[],c=exports.extractHooks(exports.parts,a||"hooks");return _.chain(c).keys().forEach(function(a){_.forEach(c[a],function(a){b.push("<dt>"+a.hook_name+"</dt><dd>"+a.hook_fn_name+" from "+a.part.full_name+"</dd>")})}),"<dl>"+b.join("\n")+"</dl>"},exports.loadFn=function(a,b){var c,d=a.split(":");d[0].length==1?(d.length==3&&(c=d.pop()),a=d.join(":")):(a=d[0],c=d[1]);var e=require(a);return c=c?c:b,_.each(c.split("."),function(a){e=e[a]}),e},exports.extractHooks=function(a,b){var c={};return _.each(a,function(a){_.chain(a[b]||{}).keys().each(function(d){c[d]===undefined&&(c[d]=[]);var e=a[b][d];if(!exports.isClient){var f=exports.plugins[a.plugin].package,g=e.replace(f.name,"");e=path.join(exports.plugins[a.plugin].package.path,g)}try{var h=exports.loadFn(e,d);if(!h)throw"Not a function"}catch(i){console.error("Failed to load '"+e+"' for '"+a.full_name+"/"+b+"/"+d+"': "+i.toString()),console.error(i)}h&&c[d].push({hook_name:d,hook_fn:h,hook_fn_name:e,part:a})})}),c},exports.isClient?exports.update=function(a){exports.hooks=exports.extractHooks(exports.parts,"client_hooks"),a()}:(exports.callInit=function(a){var b=require("./hooks");async.map(Object.keys(exports.plugins),function(a,c){var d=exports.plugins[a];fs.stat(path.normalize(path.join(d.package.path,".ep_initialized")),function(e,f){e?async.waterfall([function(a){fs.writeFile(path.normalize(path.join(d.package.path,".ep_initialized")),"done",a)},function(c){b.aCallAll("init_"+a,{},c)},c]):c()})},function(){a()})},exports.update=function(a){exports.getPackages(function(b,c){var d=[],e={};async.forEach(Object.keys(c),function(a,b){exports.loadPlugin(c,a,e,d,b)},function(b){b&&a(b),exports.plugins=e,exports.parts=exports.sortParts(d),exports.hooks=exports.extractHooks(exports.parts,"hooks"),exports.loaded=!0,exports.callInit(a)})})},exports.getPackages=function(a){var b=settings.root;readInstalled(b,function(b,c){function e(a,b){_.chain(a).keys().each(function(c){c.indexOf(exports.prefix)===0&&(d[c]=_.clone(a[c]),delete d[c].dependencies,delete d[c].parent),a[c].dependencies!==undefined&&c!=b&&e(a[c].dependencies,c)})}b&&a(b,null);var d={},f={};f[c.name]=c;try{e(f)}catch(g){throw console.error("If you caught exception 'Maximum call stack size exceeded' - this means there are node_modules with recursive dependencies."),g}a(null,d)})},exports.loadPlugin=function(a,b,c,d,e){var f=path.resolve(a[b].path,"ep.json");fs.readFile(f,function(g,h){if(g)return console.error("Unable to load plugin definition file "+f),e();try{var i=JSON.parse(h);i["package"]=a[b],c[b]=i,_.each(i.parts,function(a){a.plugin=b,a.full_name=b+"/"+a.name,d[a.full_name]=a})}catch(j){console.error("Unable to parse plugin definition file "+f+": "+j.toString())}e()})},exports.partsToParentChildList=function(a){var b=[];return _.chain(a).keys().forEach(function(c){_.each(a[c].post||[],function(a){b.push([c,a])}),_.each(a[c].pre||[],function(a){b.push([a,c])}),!a[c].pre&&!a[c].post&&b.push([c,":"+c])}),b},exports.sortParts=function(a){return tsort(exports.partsToParentChildList(a)).filter(function(b){return a[b]!==undefined}).map(function(b){return a[b]})}),exports.getPluginDefinitionsForClient=function(){var a=_(exports.parts).filter(function(a){return _(a).has("client_hooks")}),b={};_(a).chain().map(function(a){return a.plugin}).uniq().each(function(a){b[a]=_(exports.plugins[a]).clone(),delete b[a]["package"]});var c=";\n";return c+="exports.plugins = "+JSON.stringify(b)+";\n",c+="exports.parts = "+JSON.stringify(a)+";\n",c};
exports.plugins = {"ep_tasklist":{"parts":[{"name":"tasklist","client_hooks":{"postAceInit":"ep_tasklist/static/js/tasklist","aceNewLineList":"ep_tasklist/static/js/tasklist","aceInitialized":"ep_tasklist/static/js/tasklist","aceAttribsToClasses":"ep_tasklist/static/js/tasklist","collectContentPre":"ep_tasklist/static/js/tasklist","collectTextContentPre":"ep_tasklist/static/js/tasklist"},"hooks":{"collectContentPre":"ep_tasklist/static/js/tasklist","collectTextContentPre":"ep_tasklist/static/js/tasklist","aceEditorCSS":"ep_tasklist/static/js/tasklist"},"plugin":"ep_tasklist","full_name":"ep_tasklist/tasklist"}]},"ep_taskhighlight":{"parts":[{"name":"ep_taskhighlight","client_hooks":{"collectContentPre":"ep_taskhighlight/static/js/highlight.js:collectContentPre","aceCreateDomLine":"ep_taskhighlight/static/js/highlight.js:aceCreateDomLine","postAceInit":"ep_taskhighlight/static/js/highlight.js:postAceInit","acePostWriteDomLineHTML":"ep_taskhighlight/static/js/highlight.js:acePostWriteDomLineHTML","aceEditEvent":"ep_taskhighlight/static/js/highlight.js:aceEditEvent","aceInitialized":"ep_taskhighlight/static/js/highlight.js:aceInitialized"},"hooks":{"aceEditorCSS":"ep_taskhighlight/static/js/highlight.js:aceEditorCSS"},"plugin":"ep_taskhighlight","full_name":"ep_taskhighlight/ep_taskhighlight"}]},"ep_tables":{"parts":[{"name":"ep_tables","client_hooks":{"aceInitialized":"ep_tables/static/js/tables.js:aceInitialized","aceCreateDomLine":"ep_tables/static/js/tables.js:aceCreateDomLine","collectContentPre":"ep_tables/static/js/tables.js:collectContentPre"},"hooks":{"aceCreateDomLine":"ep_tables/static/js/tables.js:aceCreateDomLine","collectContentPre":"ep_tables/static/js/tables.js:collectContentPre"},"plugin":"ep_tables","full_name":"ep_tables/ep_tables"}]},"ep_links":{"parts":[{"name":"ep_links","client_hooks":{"aceAttribsToClasses":"ep_links/static/js/links.js:aceAttribsToClasses","collectContentPre":"ep_links/static/js/links.js:collectContentPre","aceCreateDomLine":"ep_links/static/js/links.js:aceCreateDomLine","postAceInit":"ep_links/static/js/links.js:postAceInit","aceInitialized":"ep_links/static/js/links.js:aceInitialized"},"hooks":{"collectContentPre":"ep_links/static/js/links.js:collectContentPre","aceEditorCSS":"ep_links/static/js/links.js:aceEditorCSS","aceCreateDomLine":"ep_links/static/js/links.js:aceCreateDomLine"},"plugin":"ep_links","full_name":"ep_links/ep_links"}]},"ep_images":{"parts":[{"name":"ep_images","client_hooks":{"aceInitialized":"ep_images/static/js/images.js:aceInitialized","aceCreateDomLine":"ep_images/static/js/images.js:aceCreateDomLine","collectContentPre":"ep_images/static/js/images.js:collectContentPre"},"hooks":{"aceEditorCSS":"ep_images/static/js/images.js:aceEditorCSS","aceCreateDomLine":"ep_images/static/js/images.js:aceCreateDomLine","collectContentPre":"ep_images/static/js/images.js:collectContentPre"},"plugin":"ep_images","full_name":"ep_images/ep_images"}]},"ep_headings":{"parts":[{"name":"main","client_hooks":{"aceDomLineProcessLineAttributes":"ep_headings/static/js/index.js","postAceInit":"ep_headings/static/js/index.js","aceInitialized":"ep_headings/static/js/index.js","aceAttribsToClasses":"ep_headings/static/js/index.js","collectContentPre":"ep_headings/static/js/index.js","collectContentPost":"ep_headings/static/js/index.js","aceRegisterBlockElements":"ep_headings/static/js/index.js"},"hooks":{"aceEditorCSS":"ep_headings/static/js/index.js","aceDomLineProcessLineAttributes":"ep_headings/static/js/index.js:aceDomLineProcessLineAttributes","collectContentPre":"ep_headings/static/js/index.js","ccRegisterBlockElements":"ep_headings/static/js/index.js:ccRegisterBlockElements","collectContentPost":"ep_headings/static/js/index.js:collectContentPost"},".client_hooks":{"aceGetFilterStack":"ep_headings/static/js/index.js:aceGetFilterStack","aceCreateDomLine":"ep_headings/static/js/index.js:aceCreateDomLine","aceDomLineProcessLineAttributes":"ep_headings/static/js/index.js:aceDomLineProcessLineAttributes"},"plugin":"ep_headings","full_name":"ep_headings/main"}]},"ep_colors":{"parts":[{"name":"main","client_hooks":{"postAceInit":"ep_colors/static/js/index.js","aceInitialized":"ep_colors/static/js/index.js","aceCreateDomLine":"ep_colors/static/js/index.js","aceAttribsToClasses":"ep_colors/static/js/index.js","collectContentPre":"ep_colors/static/js/index.js"},"hooks":{"collectContentPre":"ep_colors/static/js/index.js:collectContentPre","aceCreateDomLine":"ep_colors/static/js/index.js:aceCreateDomLine"},"plugin":"ep_colors","full_name":"ep_colors/main"}]}};
exports.parts = [{"name":"tasklist","client_hooks":{"postAceInit":"ep_tasklist/static/js/tasklist","aceNewLineList":"ep_tasklist/static/js/tasklist","aceInitialized":"ep_tasklist/static/js/tasklist","aceAttribsToClasses":"ep_tasklist/static/js/tasklist","collectContentPre":"ep_tasklist/static/js/tasklist","collectTextContentPre":"ep_tasklist/static/js/tasklist"},"hooks":{"collectContentPre":"ep_tasklist/static/js/tasklist","collectTextContentPre":"ep_tasklist/static/js/tasklist","aceEditorCSS":"ep_tasklist/static/js/tasklist"},"plugin":"ep_tasklist","full_name":"ep_tasklist/tasklist"},{"name":"ep_taskhighlight","client_hooks":{"collectContentPre":"ep_taskhighlight/static/js/highlight.js:collectContentPre","aceCreateDomLine":"ep_taskhighlight/static/js/highlight.js:aceCreateDomLine","postAceInit":"ep_taskhighlight/static/js/highlight.js:postAceInit","acePostWriteDomLineHTML":"ep_taskhighlight/static/js/highlight.js:acePostWriteDomLineHTML","aceEditEvent":"ep_taskhighlight/static/js/highlight.js:aceEditEvent","aceInitialized":"ep_taskhighlight/static/js/highlight.js:aceInitialized"},"hooks":{"aceEditorCSS":"ep_taskhighlight/static/js/highlight.js:aceEditorCSS"},"plugin":"ep_taskhighlight","full_name":"ep_taskhighlight/ep_taskhighlight"},{"name":"ep_tables","client_hooks":{"aceInitialized":"ep_tables/static/js/tables.js:aceInitialized","aceCreateDomLine":"ep_tables/static/js/tables.js:aceCreateDomLine","collectContentPre":"ep_tables/static/js/tables.js:collectContentPre"},"hooks":{"aceCreateDomLine":"ep_tables/static/js/tables.js:aceCreateDomLine","collectContentPre":"ep_tables/static/js/tables.js:collectContentPre"},"plugin":"ep_tables","full_name":"ep_tables/ep_tables"},{"name":"ep_links","client_hooks":{"aceAttribsToClasses":"ep_links/static/js/links.js:aceAttribsToClasses","collectContentPre":"ep_links/static/js/links.js:collectContentPre","aceCreateDomLine":"ep_links/static/js/links.js:aceCreateDomLine","postAceInit":"ep_links/static/js/links.js:postAceInit","aceInitialized":"ep_links/static/js/links.js:aceInitialized"},"hooks":{"collectContentPre":"ep_links/static/js/links.js:collectContentPre","aceEditorCSS":"ep_links/static/js/links.js:aceEditorCSS","aceCreateDomLine":"ep_links/static/js/links.js:aceCreateDomLine"},"plugin":"ep_links","full_name":"ep_links/ep_links"},{"name":"ep_images","client_hooks":{"aceInitialized":"ep_images/static/js/images.js:aceInitialized","aceCreateDomLine":"ep_images/static/js/images.js:aceCreateDomLine","collectContentPre":"ep_images/static/js/images.js:collectContentPre"},"hooks":{"aceEditorCSS":"ep_images/static/js/images.js:aceEditorCSS","aceCreateDomLine":"ep_images/static/js/images.js:aceCreateDomLine","collectContentPre":"ep_images/static/js/images.js:collectContentPre"},"plugin":"ep_images","full_name":"ep_images/ep_images"},{"name":"main","client_hooks":{"aceDomLineProcessLineAttributes":"ep_headings/static/js/index.js","postAceInit":"ep_headings/static/js/index.js","aceInitialized":"ep_headings/static/js/index.js","aceAttribsToClasses":"ep_headings/static/js/index.js","collectContentPre":"ep_headings/static/js/index.js","collectContentPost":"ep_headings/static/js/index.js","aceRegisterBlockElements":"ep_headings/static/js/index.js"},"hooks":{"aceEditorCSS":"ep_headings/static/js/index.js","aceDomLineProcessLineAttributes":"ep_headings/static/js/index.js:aceDomLineProcessLineAttributes","collectContentPre":"ep_headings/static/js/index.js","ccRegisterBlockElements":"ep_headings/static/js/index.js:ccRegisterBlockElements","collectContentPost":"ep_headings/static/js/index.js:collectContentPost"},".client_hooks":{"aceGetFilterStack":"ep_headings/static/js/index.js:aceGetFilterStack","aceCreateDomLine":"ep_headings/static/js/index.js:aceCreateDomLine","aceDomLineProcessLineAttributes":"ep_headings/static/js/index.js:aceDomLineProcessLineAttributes"},"plugin":"ep_headings","full_name":"ep_headings/main"},{"name":"main","client_hooks":{"postAceInit":"ep_colors/static/js/index.js","aceInitialized":"ep_colors/static/js/index.js","aceCreateDomLine":"ep_colors/static/js/index.js","aceAttribsToClasses":"ep_colors/static/js/index.js","collectContentPre":"ep_colors/static/js/index.js"},"hooks":{"collectContentPre":"ep_colors/static/js/index.js:collectContentPre","aceCreateDomLine":"ep_colors/static/js/index.js:aceCreateDomLine"},"plugin":"ep_colors","full_name":"ep_colors/main"}];

}
, "ep_etherpad-lite/static/js/pluginfw/hooks.js": function (require, exports, module) {
var plugins=require("ep_etherpad-lite/static/js/pluginfw/plugins"),_,editorInfo;if(plugins.isClient)var async=require("ep_etherpad-lite/static/js/pluginfw/async"),_=require("ep_etherpad-lite/static/js/underscore");else var async=require("async"),_=require("underscore");exports.bubbleExceptions=!0;var hookCallWrapper=function(a,b,c,d,e){e===undefined&&(e=function(a){return a});var f=function(a){return a==undefined?[]:a},g=function(){var g=f(b.hook_fn(c,d,function(a){return e(f(a))}));return a&&a.eventListener&&c&&a.eventListener.apply(a,["hook."+c,d]),g};if(exports.bubbleExceptions)return g();try{return g()}catch(h){console.error([c,b.part.full_name,h.stack||h])}};exports.syncMapFirst=function(a,b){var c,d;for(c=0;c<a.length;c++){d=b(a[c]);if(d.length)return d}return undefined},exports.mapFirst=function(a,b,c){var d=0;next=function(){if(d>=a.length)return c(undefined);b(a[d++],function(a,b){if(a)return c(a);if(b.length)return c(null,b);next()})},next()},exports.flatten=function(a){var b=[];if(a!=undefined&&a!=null)for(var c=0;c<a.length;c++)if(a[c]!=undefined&&a[c]!=null)for(var d=0;d<a[c].length;d++)b.push(a[c][d]);return b},exports.callAll=function(a,b){return b||(b={}),a=="aceInitialized"&&(editorInfo=b.editorInfo),plugins.hooks[a]===undefined?[]:_.flatten(_.map(plugins.hooks[a],function(c){return hookCallWrapper(editorInfo,c,a,b)}),!0)},exports.aCallAll=function(a,b,c){b||(b={}),c||(c=function(){});if(plugins.hooks[a]===undefined)return c(null,[]);async.map(plugins.hooks[a],function(c,d){hookCallWrapper(editorInfo,c,a,b,function(a){d(null,a)})},function(a,b){c(null,_.flatten(b,!0))})},exports.callFirst=function(a,b){return b||(b={}),plugins.hooks[a]===undefined?[]:exports.syncMapFirst(plugins.hooks[a],function(c){return hookCallWrapper(editorInfo,c,a,b)})},exports.aCallFirst=function(a,b,c){b||(b={}),c||(c=function(){});if(plugins.hooks[a]===undefined)return c(null,[]);exports.mapFirst(plugins.hooks[a],function(c,d){hookCallWrapper(editorInfo,c,a,b,function(a){d(null,a)})},c)},exports.callAllStr=function(a,b,c,d,e){c==undefined&&(c=""),d==undefined&&(d=""),e==undefined&&(e="");var f=[],g=exports.callAll(a,b);for(var h=0,i=g.length;h<i;h++)f[h]=d+g[h]+e;return f.join(c||"")}
}
, "ep_etherpad-lite/static/js/pluginfw/async.js": function (require, exports, module) {
(function(){var a={},b=this,c=b.async;typeof module!="undefined"&&module.exports?module.exports=a:b.async=a,a.noConflict=function(){return b.async=c,a};var d=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},e=function(a,b){if(a.map)return a.map(b);var c=[];return d(a,function(a,d,e){c.push(b(a,d,e))}),c},f=function(a,b,c){return a.reduce?a.reduce(b,c):(d(a,function(a,d,e){c=b(c,a,d,e)}),c)},g=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},h=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c+=1)if(a[c]===b)return c;return-1};typeof process=="undefined"||!process.nextTick?a.nextTick=function(a){setTimeout(a,0)}:a.nextTick=process.nextTick,a.forEach=function(a,b,c){if(!a.length)return c();var e=0;d(a,function(d){b(d,function(b){b?(c(b),c=function(){}):(e+=1,e===a.length&&c())})})},a.forEachSeries=function(a,b,c){if(!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d===a.length?c():e())})};e()},a.forEachLimit=function(a,b,c,d){if(!a.length||b<=0)return d();var e=0,f=0,g=0;(function h(){if(e===a.length)return d();while(g<b&&f<a.length)c(a[f],function(b){b?(d(b),d=function(){}):(e+=1,g-=1,e===a.length?d():h())}),f+=1,g+=1})()};var i=function(b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[a.forEach].concat(c))}},j=function(b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[a.forEachSeries].concat(c))}},k=function(a,b,c,d){var f=[];b=e(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){f[a.index]=d,b(c)})},function(a){d(a,f)})};a.map=i(k),a.mapSeries=j(k),a.reduce=function(b,c,d,e){a.forEachSeries(b,function(a,b){d(c,a,function(a,d){c=d,b(a)})},function(a){e(a,c)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(b,c,d,f){var g=e(b,function(a){return a}).reverse();a.reduce(g,c,d,f)},a.foldr=a.reduceRight;var l=function(a,b,c,d){var f=[];b=e(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&f.push(a),b()})},function(a){d(e(f.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};a.filter=i(l),a.filterSeries=j(l),a.select=a.filter,a.selectSeries=a.filterSeries;var m=function(a,b,c,d){var f=[];b=e(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||f.push(a),b()})},function(a){d(e(f.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};a.reject=i(m),a.rejectSeries=j(m);var n=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};a.detect=i(n),a.detectSeries=j(n),a.some=function(b,c,d){a.forEach(b,function(a,b){c(a,function(a){a&&(d(!0),d=function(){}),b()})},function(a){d(!1)})},a.any=a.some,a.every=function(b,c,d){a.forEach(b,function(a,b){c(a,function(a){a||(d(!1),d=function(){}),b()})},function(a){d(!0)})},a.all=a.every,a.sortBy=function(b,c,d){a.map(b,function(a,b){c(a,function(c,d){c?b(c):b(null,{value:a,criteria:d})})},function(a,b){if(a)return d(a);var c=function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0};d(null,e(b.sort(c),function(a){return a.value}))})},a.auto=function(a,b){b=b||function(){};var c=g(a);if(!c.length)return b(null);var e={},h=[],i=function(a){h.unshift(a)},j=function(a){for(var b=0;b<h.length;b+=1)if(h[b]===a){h.splice(b,1);return}},k=function(){d(h,function(a){a()})};i(function(){g(e).length===c.length&&b(null,e)}),d(c,function(c){var d=a[c]instanceof Function?[a[c]]:a[c],g=function(a){if(a)b(a),b=function(){};else{var d=Array.prototype.slice.call(arguments,1);d.length<=1&&(d=d[0]),e[c]=d,k()}},h=d.slice(0,Math.abs(d.length-1))||[],l=function(){return f(h,function(a,b){return a&&e.hasOwnProperty(b)},!0)};if(l())d[d.length-1](g,e);else{var m=function(){l()&&(j(m),d[d.length-1](g,e))};i(m)}})},a.waterfall=function(b,c){if(!b.length)return c();c=c||function(){};var d=function(b){return function(e){if(e)c(e),c=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=b.next();g?f.push(d(g)):f.push(c),a.nextTick(function(){b.apply(null,f)})}}};d(a.iterator(b))()},a.parallel=function(b,c){c=c||function(){};if(b.constructor===Array)a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.forEach(g(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}},a.series=function(b,c){c=c||function(){};if(b.constructor===Array)a.mapSeries(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.forEachSeries(g(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}},a.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},a.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var o=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};a.concat=i(o),a.concatSeries=j(o),a.whilst=function(b,c,d){b()?c(function(e){if(e)return d(e);a.whilst(b,c,d)}):d()},a.until=function(b,c,d){b()?d():c(function(e){if(e)return d(e);a.until(b,c,d)})},a.queue=function(b,c){var d=0,e={tasks:[],concurrency:c,saturated:null,empty:null,drain:null,push:function(b,d){e.tasks.push({data:b,callback:d}),e.saturated&&e.tasks.length==c&&e.saturated(),a.nextTick(e.process)},process:function(){if(d<e.concurrency&&e.tasks.length){var a=e.tasks.shift();e.empty&&e.tasks.length==0&&e.empty(),d+=1,b(a.data,function(){d-=1,a.callback&&a.callback.apply(a,arguments),e.drain&&e.tasks.length+d==0&&e.drain(),e.process()})}},length:function(){return e.tasks.length},running:function(){return d}};return e};var p=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(b?console.error&&console.error(b):console[a]&&d(c,function(b){console[a](b)}))}]))}};a.log=p("log"),a.dir=p("dir"),a.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),f=e.pop(),g=b.apply(null,e);g in c?f.apply(null,c[g]):g in d?d[g].push(f):(d[g]=[f],a.apply(null,e.concat([function(){c[g]=arguments;var a=d[g];delete d[g];for(var b=0,e=a.length;b<e;b++)a[b].apply(null,arguments)}])))};return e.unmemoized=a,e},a.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}}})()
}
, "ep_etherpad-lite/static/js/pluginfw/parent_require.js": function (require, exports, module) {
exports.getRequirementFromParent=function(a,b){delete a._definitions[b],delete a._modules[b],a.define(b,function(a,c,d){var e=parent,f=0;while(typeof e!="undefined"){f++;if(f==10)break;if(typeof e.__etherpadLegacy!="undefined"&&typeof e.__etherpadLegacy.require!="undefined"){d.exports=e.__etherpadLegacy.require(b);return}e=e.parent}})}
}
, "ep_etherpad-lite/static/js/Changeset.js": function (require, exports, module) {
var AttributePool=require("./AttributePool"),_opt=null;exports.error=function(b){var c=new Error(b);throw c.easysync=!0,c},exports.assert=function(b,c){if(!b){var d=Array.prototype.slice.call(arguments,1).join("");exports.error("exports: "+d)}},exports.parseNum=function(a){return parseInt(a,36)},exports.numToString=function(a){return a.toString(36).toLowerCase()},exports.toBaseTen=function(a){var b=a.indexOf("$"),c=a.substring(0,b),d=a.substring(b);return c.replace(/[0-9a-z]+/g,function(a){return String(exports.parseNum(a))})+d},exports.oldLen=function(a){return exports.unpack(a).oldLen},exports.newLen=function(a){return exports.unpack(a).newLen},exports.opIterator=function(a,b){function g(){f=e;var b;return _opt?(b=_opt.nextOpInString(a,e),b&&(b.opcode()=="?"&&exports.error("Hit error opcode in op stream"),e=b.lastIndex())):(c.lastIndex=e,b=c.exec(a),e=c.lastIndex,b[0]=="?"&&exports.error("Hit error opcode in op stream")),b}function j(a){var b=a||i;return _opt&&h?(b.attribs=h.attribs(),b.lines=h.lines(),b.chars=h.chars(),b.opcode=h.opcode(),h=g()):!_opt&&h[0]?(b.attribs=h[1],b.lines=exports.parseNum(h[2]||0),b.opcode=h[3],b.chars=exports.parseNum(h[4]),h=g()):exports.clearOp(b),b}function k(){return _opt?!!h:!!h[0]}function l(){return f}var c=/((?:\*[0-9a-z]+)*)(?:\|([0-9a-z]+))?([-+=])([0-9a-z]+)|\?|/g,d=b||0,e=d,f=e,h=g(),i=exports.newOp();return{next:j,hasNext:k,lastIndex:l}},exports.clearOp=function(a){a.opcode="",a.chars=0,a.lines=0,a.attribs=""},exports.newOp=function(a){return{opcode:a||"",chars:0,lines:0,attribs:""}},exports.cloneOp=function(a){return{opcode:a.opcode,chars:a.chars,lines:a.lines,attribs:a.attribs}},exports.copyOp=function(a,b){b.opcode=a.opcode,b.chars=a.chars,b.lines=a.lines,b.attribs=a.attribs},exports.opString=function(a){if(!a.opcode)return"null";var b=exports.opAssembler();return b.append(a),b.toString()},exports.stringOp=function(a){return exports.opIterator(a).next()},exports.checkRep=function(a){var b=exports.unpack(a),c=b.oldLen,d=b.newLen,e=b.ops,f=b.charBank,g=exports.smartOpAssembler(),h=0,i=0,j=0,k=exports.opIterator(e);while(k.hasNext()){var l=k.next();switch(l.opcode){case"=":h+=l.chars,i+=l.chars;break;case"-":h+=l.chars,exports.assert(h<c,h," >= ",c," in ",a);break;case"+":i+=l.chars,j+=l.chars,exports.assert(i<d,i," >= ",d," in ",a)}g.append(l)}i+=c-h,f=f.substring(0,j);while(f.length<j)f+="?";g.endDocument();var m=exports.pack(c,i,g.toString(),f);return exports.assert(m==a,m," != ",a),a},exports.smartOpAssembler=function(){function g(){d.append(c.toString()),c.clear()}function h(){d.append(a.toString()),a.clear(),d.append(b.toString()),b.clear()}function i(d){if(!d.opcode)return;if(!d.chars)return;d.opcode=="-"?(e=="="&&g(),a.append(d),f-=d.chars):d.opcode=="+"?(e=="="&&g(),b.append(d),f+=d.chars):d.opcode=="="&&(e!="="&&h(),c.append(d)),e=d.opcode}function j(a,b,c,d){var e=exports.newOp(a);e.attribs=exports.makeAttribsString(a,c,d);var f=b.lastIndexOf("\n");f<0?(e.chars=b.length,e.lines=0,i(e)):(e.chars=f+1,e.lines=b.match(/\n/g).length,i(e),e.chars=b.length-(f+1),e.lines=0,i(e))}function k(){return h(),g(),d.toString()}function l(){a.clear(),b.clear(),c.clear(),d.clear(),f=0}function m(){c.endDocument()}function n(){return f}var a=exports.mergingOpAssembler(),b=exports.mergingOpAssembler(),c=exports.mergingOpAssembler(),d=exports.stringAssembler(),e="",f=0;return{append:i,toString:k,clear:l,endDocument:m,appendOpWithText:j,getLengthChange:n}},_opt?exports.mergingOpAssembler=function(){function b(b){a.append(b.opcode,b.chars,b.lines,b.attribs)}function c(){return a.toString()}function d(){a.clear()}function e(){a.endDocument()}var a=_opt.mergingOpAssembler();return{append:b,toString:c,clear:d,endDocument:e}}:exports.mergingOpAssembler=function(){function d(d){if(b.opcode){if(!d||b.opcode!="="||!!b.attribs)a.append(b),c&&(b.chars=c,b.lines=0,a.append(b),c=0);b.opcode=""}}function e(a){a.chars>0&&(b.opcode==a.opcode&&b.attribs==a.attribs?a.lines>0?(b.chars+=c+a.chars,b.lines+=a.lines,c=0):b.lines==0?b.chars+=a.chars:c+=a.chars:(d(),exports.copyOp(a,b)))}function f(){d(!0)}function g(){return d(),a.toString()}function h(){a.clear(),exports.clearOp(b)}var a=exports.opAssembler(),b=exports.newOp(),c=0;return{append:e,toString:g,clear:h,endDocument:f}},_opt?exports.opAssembler=function(){function b(b){a.append(b.opcode,b.chars,b.lines,b.attribs)}function c(){return a.toString()}function d(){a.clear()}var a=_opt.opAssembler();return{append:b,toString:c,clear:d}}:exports.opAssembler=function(){function b(b){a.push(b.attribs),b.lines&&a.push("|",exports.numToString(b.lines)),a.push(b.opcode),a.push(exports.numToString(b.chars))}function c(){return a.join("")}function d(){a.length=0}var a=[];return{append:b,toString:c,clear:d}},exports.stringIterator=function(a){function c(a){exports.assert(a<=g(),"!(",a," <= ",g(),")")}function d(d){c(d);var e=a.substr(b,d);return b+=d,e}function e(d){c(d);var e=a.substr(b,d);return e}function f(a){c(a),b+=a}function g(){return a.length-b}var b=0;return{take:d,skip:f,remaining:g,peek:e}},exports.stringAssembler=function(){function b(b){a.push(String(b))}function c(){return a.join("")}var a=[];return{append:b,toString:c}},exports.textLinesMutator=function(a){function f(b){a.splice.apply(a,b)}function g(){return a.toSource()}function h(b){return a.get?a.get(b):a[b]}function i(b,c){return a.slice?a.slice(b,c):[]}function j(){return typeof a.length=="number"?a.length:a.length()}function k(){b[0]=d,b[1]=0,e>0&&o(),c=!0}function l(){f(b),b.length=2,b[0]=b[1]=0,c=!1}function m(){return d-b[0]<b.length-2}function n(a){print(a+": "+b.toSource()+" / "+d+","+e+" / "+g())}function o(){return m()||(b.push(h(b[0]+b[1])),b[1]++),2+d-b[0]}function p(a,b){if(a)if(b){c||k();for(var f=0;f<a;f++)e=0,o(),d++}else c&&(a>1?l():o()),d+=a,e=0}function q(a,b,d){a&&(b?p(b,d):(d&&!c&&k(),c&&o(),e+=a))}function r(a){var d="";if(a){c||k();function f(a){var c=b[0]+b[1];return i(c,c+a).join("")}if(m())if(e==0)d=b[b.length-1],b.length--,d+=f(a-1),b[1]+=a-1;else{d=f(a-1),b[1]+=a-1;var g=b.length-1;d=b[g].substring(e)+d,b[g]=b[g].substring(0,e)+h(b[0]+b[1]),b[1]+=1}else d=f(a),b[1]+=a}return d}function s(a,d){var f="";if(a){if(d)return r(d);c||k();var g=o();f=b[g].substring(e,e+a),b[g]=b[g].substring(0,e)+b[g].substring(e+a)}return f}function t(a,f){if(a){c||k();if(f){var g=exports.splitTextLines(a);if(m()){var h=b.length-1,i=b[h],j=e;b[h]=i.substring(0,j)+g[0],d++,g.splice(0,1),Array.prototype.push.apply(b,g),d+=g.length,b.push(i.substring(j)),e=0}else Array.prototype.push.apply(b,g),d+=g.length}else{var h=o();b[h]=b[h].substring(0,e)+a+b[h].substring(e),e+=a.length}}}function u(){var a=j();return c&&(a+=b.length-2-b[1]),d<a}function v(){c&&l()}var b=[0,0],c=!1,d=0,e=0,w={skip:q,remove:s,insert:t,close:v,hasMore:u,removeLines:r,skipLines:p};return w},exports.applyZip=function(a,b,c,d,e){var f=exports.opIterator(a,b),g=exports.opIterator(c,d),h=exports.smartOpAssembler(),i=exports.newOp(),j=exports.newOp(),k=exports.newOp();while(i.opcode||f.hasNext()||j.opcode||g.hasNext())!i.opcode&&f.hasNext()&&f.next(i),!j.opcode&&g.hasNext()&&g.next(j),e(i,j,k),k.opcode&&(h.append(k),k.opcode="");return h.endDocument(),h.toString()},exports.unpack=function(a){var b=/Z:([0-9a-z]+)([><])([0-9a-z]+)|/,c=b.exec(a);(!c||!c[0])&&exports.error("Not a exports: "+a);var d=exports.parseNum(c[1]),e=c[2]==">"?1:-1,f=exports.parseNum(c[3]),g=d+e*f,h=c[0].length,i=a.indexOf("$");return i<0&&(i=a.length),{oldLen:d,newLen:g,ops:a.substring(h,i),charBank:a.substring(i+1)}},exports.pack=function(a,b,c,d){var e=b-a,f=e>=0?">"+exports.numToString(e):"<"+exports.numToString(-e),g=[];return g.push("Z:",exports.numToString(a),f,c,"$",d),g.join("")},exports.applyToText=function(a,b){var c=exports.unpack(a);exports.assert(b.length==c.oldLen,"mismatched apply: ",b.length," / ",c.oldLen);var d=exports.opIterator(c.ops),e=exports.stringIterator(c.charBank),f=exports.stringIterator(b),g=exports.stringAssembler();while(d.hasNext()){var h=d.next();switch(h.opcode){case"+":g.append(e.take(h.chars));break;case"-":f.skip(h.chars);break;case"=":g.append(f.take(h.chars))}}return g.append(f.take(f.remaining())),g.toString()},exports.mutateTextLines=function(a,b){var c=exports.unpack(a),d=exports.opIterator(c.ops),e=exports.stringIterator(c.charBank),f=exports.textLinesMutator(b);while(d.hasNext()){var g=d.next();switch(g.opcode){case"+":f.insert(e.take(g.chars),g.lines);break;case"-":f.remove(g.chars,g.lines);break;case"=":f.skip(g.chars,g.lines,!!g.attribs)}}f.close()},exports.composeAttributes=function(a,b,c,d){if(!a&&c)return b;if(!b)return a;var e=[];a.replace(/\*([0-9a-z]+)/g,function(a,b){return e.push(d.getAttrib(exports.parseNum(b))),""}),b.replace(/\*([0-9a-z]+)/g,function(a,b){var f=d.getAttrib(exports.parseNum(b)),g=!1;for(var h=0;h<e.length;h++){var i=e[h];if(i[0]==f[0]){f[1]||c?i[1]=f[1]:e.splice(h,1),g=!0;break}}return!g&&(f[1]||c)&&e.push(f),""}),e.sort();var f=exports.stringAssembler();for(var g=0;g<e.length;g++)f.append("*"),f.append(exports.numToString(d.putAttrib(e[g])));return f.toString()},exports._slicerZipperFunc=function(a,b,c,d){if(a.opcode=="-")exports.copyOp(a,c),a.opcode="";else if(!a.opcode)exports.copyOp(b,c),b.opcode="";else switch(b.opcode){case"-":b.chars<=a.chars?(a.opcode=="="&&(c.opcode="-",c.chars=b.chars,c.lines=b.lines,c.attribs=""),a.chars-=b.chars,a.lines-=b.lines,b.opcode="",a.chars||(a.opcode="")):(a.opcode=="="&&(c.opcode="-",c.chars=a.chars,c.lines=a.lines,c.attribs=""),b.chars-=a.chars,b.lines-=a.lines,a.opcode="");break;case"+":exports.copyOp(b,c),b.opcode="";break;case"=":b.chars<=a.chars?(c.opcode=a.opcode,c.chars=b.chars,c.lines=b.lines,c.attribs=exports.composeAttributes(a.attribs,b.attribs,a.opcode=="=",d),b.opcode="",a.chars-=b.chars,a.lines-=b.lines,a.chars||(a.opcode="")):(c.opcode=a.opcode,c.chars=a.chars,c.lines=a.lines,c.attribs=exports.composeAttributes(a.attribs,b.attribs,a.opcode=="=",d),a.opcode="",b.chars-=a.chars,b.lines-=a.lines);break;case"":exports.copyOp(a,c),a.opcode=""}},exports.applyToAttribution=function(a,b,c){var d=exports.unpack(a);return exports.applyZip(b,0,d.ops,0,function(a,b,d){return exports._slicerZipperFunc(a,b,d,c)})},exports.mutateAttributionLines=function(a,b,c){function j(){return i&&i.hasNext()||h.hasMore()}function k(a){if((!i||!i.hasNext())&&h.hasMore()){var b=h.removeLines(1);i=exports.opIterator(b)}i&&i.hasNext()?i.next(a):a.opcode=""}function m(a){l||(l=exports.mergingOpAssembler()),l.append(a),a.lines>0&&(exports.assert(a.lines==1,"Can't have op.lines of ",a.lines," in attribution lines"),h.insert(l.toString(),1),l=null)}var d=exports.unpack(a),e=exports.opIterator(d.ops),f=d.charBank,g=0,h=exports.textLinesMutator(b),i=null,l=null,n=exports.newOp(),o=exports.newOp(),p=exports.newOp();while(n.opcode||e.hasNext()||o.opcode||j()){!n.opcode&&e.hasNext()&&e.next(n);if(!n.opcode&&!o.opcode&&!l&&(!i||!i.hasNext()))break;if(n.opcode=="="&&n.lines>0&&!n.attribs&&!o.opcode&&!l&&(!i||!i.hasNext()))h.skipLines(n.lines),n.opcode="";else if(n.opcode=="+"){if(n.lines>1){var q=f.indexOf("\n",g)+1-g;exports.copyOp(n,p),n.chars-=q,n.lines--,p.lines=1,p.chars=q}else exports.copyOp(n,p),n.opcode="";m(p),g+=p.chars,p.opcode=""}else!o.opcode&&j()&&k(o),exports._slicerZipperFunc(o,n,p,c),p.opcode&&(m(p),p.opcode="")}exports.assert(!l,"line assembler not finished"),h.close()},exports.joinAttributionLines=function(a){var b=exports.mergingOpAssembler();for(var c=0;c<a.length;c++){var d=a[c],e=exports.opIterator(d);while(e.hasNext())b.append(e.next())}return b.toString()},exports.splitAttributionLines=function(a,b){function g(a){d.append(a),a.lines>0&&(e.push(d.toString()),d.clear()),f+=a.chars}var c=exports.opIterator(a),d=exports.mergingOpAssembler(),e=[],f=0;while(c.hasNext()){var h=c.next(),i=h.chars,j=h.lines;while(j>1){var k=b.indexOf("\n",f)+1;exports.assert(k>0,"newlineEnd <= 0 in splitAttributionLines"),h.chars=k-f,h.lines=1,g(h),i-=h.chars,j-=h.lines}j==1&&(h.chars=i,h.lines=1),g(h)}return e},exports.splitTextLines=function(a){return a.match(/[^\n]*(?:\n|[^\n]$)/g)},exports.compose=function(a,b,c){var d=exports.unpack(a),e=exports.unpack(b),f=d.oldLen,g=d.newLen;exports.assert(g==e.oldLen,"mismatched composition");var h=e.newLen,i=exports.stringIterator(d.charBank),j=exports.stringIterator(e.charBank),k=exports.stringAssembler(),l=exports.applyZip(d.ops,0,e.ops,0,function(a,b,d){var e=a.opcode,f=b.opcode;e=="+"&&f=="-"&&i.skip(Math.min(a.chars,b.chars)),exports._slicerZipperFunc(a,b,d,c),d.opcode=="+"&&(f=="+"?k.append(j.take(d.chars)):k.append(i.take(d.chars)))});return exports.pack(f,h,l,k.toString())},exports.attributeTester=function(a,b){function e(a){return!1}if(!b)return e;var c=b.putAttrib(a,!0);if(c<0)return e;var d=new RegExp("\\*"+exports.numToString(c)+"(?!\\w)");return function(a){return d.test(a)}},exports.identity=function(a){return exports.pack(a,a,"","")},exports.makeSplice=function(a,b,c,d,e,f){var g=a.length;b>=g&&(b=g-1),c>a.length-b-1&&(c=a.length-b-1);var h=a.substring(b,b+c),i=g+d.length-h.length,j=exports.smartOpAssembler();return j.appendOpWithText("=",a.substring(0,b)),j.appendOpWithText("-",h),j.appendOpWithText("+",d,e,f),j.endDocument(),exports.pack(g,i,j.toString(),d)},exports.toSplices=function(a){var b=exports.unpack(a),c=[],d=0,e=exports.opIterator(b.ops),f=exports.stringIterator(b.charBank),g=!1;while(e.hasNext()){var h=e.next();h.opcode=="="?(d+=h.chars,g=!1):(g||(c.push([d,d,""]),g=!0),h.opcode=="-"?(d+=h.chars,c[c.length-1][1]+=h.chars):h.opcode=="+"&&(c[c.length-1][2]+=f.take(h.chars)))}return c},exports.characterRangeFollow=function(a,b,c,d){var e=b,f=c,g=exports.toSplices(a),h=0;for(var i=0;i<g.length;i++){var j=g[i],k=j[0]+h,l=j[1]+h,m=j[2].length,n=m-(l-k);k<=e&&l>=f?d?e=f=k:e=f=k+m:l<=e?(e+=n,f+=n):k>=f||(k>=e&&l<=f?f+=n:l<f?(e=k+m,f+=n):f=k),h+=n}return[e,f]},exports.moveOpsToNewPool=function(a,b,c){var d=a.indexOf("$");d<0&&(d=a.length);var e=a.substring(0,d),f=a.substring(d);return e.replace(/\*([0-9a-z]+)/g,function(a,d){var e=exports.parseNum(d),f=b.getAttrib(e),g=c.putAttrib(f);return"*"+exports.numToString(g)})+f},exports.makeAttribution=function(a){var b=exports.smartOpAssembler();return b.appendOpWithText("+",a),b.toString()},exports.eachAttribNumber=function(a,b){var c=a.indexOf("$");c<0&&(c=a.length);var d=a.substring(0,c);d.replace(/\*([0-9a-z]+)/g,function(a,c){return b(exports.parseNum(c)),""})},exports.filterAttribNumbers=function(a,b){return exports.mapAttribNumbers(a,b)},exports.mapAttribNumbers=function(a,b){var c=a.indexOf("$");c<0&&(c=a.length);var d=a.substring(0,c),e=d.replace(/\*([0-9a-z]+)/g,function(a,c){var d=b(exports.parseNum(c));return d===!0?a:typeof d=="number"?"*"+exports.numToString(d):""});return e+a.substring(c)},exports.makeAText=function(a,b){return{text:a,attribs:b||exports.makeAttribution(a)}},exports.applyToAText=function(a,b,c){return{text:exports.applyToText(a,b.text),attribs:exports.applyToAttribution(a,b.attribs,c)}},exports.cloneAText=function(a){return{text:a.text,attribs:a.attribs}},exports.copyAText=function(a,b){b.text=a.text,b.attribs=a.attribs},exports.appendATextToAssembler=function(a,b){var c=exports.opIterator(a.attribs),d=exports.newOp();while(c.hasNext()){c.next(d);if(!c.hasNext())if(d.lines<=1)d.lines=0,d.chars--,d.chars&&b.append(d);else{var e=a.text.lastIndexOf("\n",a.text.length-2)+1,f=a.text.length-e-1;d.lines--,d.chars-=f+1,b.append(d),d.lines=0,d.chars=f,d.chars&&b.append(d)}else b.append(d)}},exports.prepareForWire=function(a,b){var c=new AttributePool,d=exports.moveOpsToNewPool(a,b,c);return{translated:d,pool:c}},exports.isIdentity=function(a){var b=exports.unpack(a);return b.ops==""&&b.oldLen==b.newLen},exports.opAttributeValue=function(a,b,c){return exports.attribsAttributeValue(a.attribs,b,c)},exports.attribsAttributeValue=function(a,b,c){var d="";return a&&exports.eachAttribNumber(a,function(a){c.getAttribKey(a)==b&&(d=c.getAttribValue(a))}),d},exports.builder=function(a){var b=exports.smartOpAssembler(),c=exports.newOp(),d=exports.stringAssembler(),e={keep:function(a,d,f,g){return c.opcode="=",c.attribs=f&&exports.makeAttribsString("=",f,g)||"",c.chars=a,c.lines=d||0,b.append(c),e},keepText:function(a,c,d){return b.appendOpWithText("=",a,c,d),e},insert:function(a,c,f){return b.appendOpWithText("+",a,c,f),d.append(a),e},remove:function(a,d){return c.opcode="-",c.attribs="",c.chars=a,c.lines=d||0,b.append(c),e},toString:function(){b.endDocument();var c=a+b.getLengthChange();return exports.pack(a,c,b.toString(),d.toString())}};return e},exports.makeAttribsString=function(a,b,c){if(!b)return"";if(typeof b=="string")return b;if(c&&b&&b.length){b.length>1&&(b=b.slice(),b.sort());var d=[];for(var e=0;e<b.length;e++){var f=b[e];(a=="="||a=="+")&&d.push("*"+exports.numToString(c.putAttrib(f)))}return d.join("")}},exports.subattribution=function(a,b,c){function i(){if(g.chars)while(g.opcode&&(f.opcode||d.hasNext()))f.opcode||d.next(f),g.opcode&&f.opcode&&g.chars>=f.chars&&f.lines>0&&g.lines<=0&&g.lines++,exports._slicerZipperFunc(f,g,h,null),h.opcode&&(e.append(h),h.opcode="")}var d=exports.opIterator(a,0),e=exports.smartOpAssembler(),f=exports.newOp(),g=exports.newOp(),h=exports.newOp();g.opcode="-",g.chars=b,i();if(c===undefined){f.opcode&&e.append(f);while(d.hasNext())d.next(f),e.append(f)}else g.opcode="=",g.chars=c-b,i();return e.toString()},exports.inverse=function(a,b,c,d){function e(a){return b.get?b.get(a):b[a]}function f(){return typeof b.length=="number"?b.length:b.length()}function g(a){return c.get?c.get(a):c[a]}function h(){return typeof c.length=="number"?c.length:c.length()}function q(a,b){if(!k||l!=i){k=exports.opIterator(g(i)),l=i;var c=0,d=!1;while(!d)k.next(m),c+m.chars>=j?(m.chars-=j-c,d=!0):c+=m.chars}while(a>0){!m.chars&&!k.hasNext()&&(i++,j=0,l=i,m.chars=0,k=exports.opIterator(g(i))),m.chars||k.next(m);var e=Math.min(a,m.chars);b(e,m.attribs,e==m.chars&&m.lines>0),a-=e,m.chars-=e,j+=e}!m.chars&&!k.hasNext()&&(i++,j=0)}function r(a,b){b?(i+=b,j=0):k&&l==i?q(a,function(){}):j+=a}function s(a){var b=0,c=exports.stringAssembler(),d=e(i).substring(j);b+=d.length,c.append(d);var f=i+1;while(b<a){var g=e(f);b+=g.length,c.append(g),f++}return c.toString().substring(0,a)}function t(a){var b={};return function(c){return b[c]||(b[c]=a(c)),b[c]}}var i=0,j=0,k=null,l,m=exports.newOp("+"),n=exports.unpack(a),o=exports.opIterator(n.ops),p=exports.builder(n.newLen),u=[],v=[];while(o.hasNext()){var w=o.next();if(w.opcode=="=")if(w.attribs){u.length=0,v.length=0,exports.eachAttribNumber(w.attribs,function(a){u.push(d.getAttribKey(a)),v.push(d.getAttribValue(a))});var x=t(function(a){var b=[];for(var c=0;c<u.length;c++){var e=u[c],f=v[c],g=exports.attribsAttributeValue(a,e,d);f!=g&&b.push([e,g])}return exports.makeAttribsString("=",b,d)});q(w.chars,function(a,b,c){p.keep(a,c?1:0,x(b))})}else r(w.chars,w.lines),p.keep(w.chars,w.lines);else if(w.opcode=="+")p.remove(w.chars,w.lines);else if(w.opcode=="-"){var y=s(w.chars),z=0;q(w.chars,function(a,b,c){p.insert(y.substr(z,a),b),z+=a})}}return exports.checkRep(p.toString())},exports.follow=function(a,b,c,d){var e=exports.unpack(a),f=exports.unpack(b),g=e.oldLen,h=f.oldLen;exports.assert(g==h,"mismatched follow");var i=exports.stringIterator(e.charBank),j=exports.stringIterator(f.charBank),k=e.newLen,l=0,m=0,n=exports.attributeTester(["insertorder","first"],d),o=exports.applyZip(e.ops,0,f.ops,0,function(a,b,e){if(a.opcode=="+"||b.opcode=="+"){var f;if(b.opcode!="+")f=1;else if(a.opcode!="+")f=2;else{var g=i.peek(1),h=j.peek(1),k=n(a.attribs),o=n(b.attribs);k&&!o?f=1:o&&!k?f=2:g=="\n"&&h!="\n"?f=2:g!="\n"&&h=="\n"?f=1:c?f=2:f=1}f==1?(i.skip(a.chars),e.opcode="=",e.lines=a.lines,e.chars=a.chars,e.attribs="",a.opcode=""):(j.skip(b.chars),exports.copyOp(b,e),b.opcode="")}else a.opcode=="-"?b.opcode?a.chars<=b.chars?(b.chars-=a.chars,b.lines-=a.lines,a.opcode="",b.chars||(b.opcode="")):(a.chars-=b.chars,a.lines-=b.lines,b.opcode=""):a.opcode="":b.opcode=="-"?(exports.copyOp(b,e),a.opcode?b.chars<=a.chars?(a.chars-=b.chars,a.lines-=b.lines,b.opcode="",a.chars||(a.opcode="")):(e.lines=a.lines,e.chars=a.chars,b.lines-=a.lines,b.chars-=a.chars,a.opcode=""):b.opcode=""):a.opcode?b.opcode?(e.opcode="=",e.attribs=exports.followAttributes(a.attribs,b.attribs,d),a.chars<=b.chars?(e.chars=a.chars,e.lines=a.lines,b.chars-=a.chars,b.lines-=a.lines,a.opcode="",b.chars||(b.opcode="")):(e.chars=b.chars,e.lines=b.lines,a.chars-=b.chars,a.lines-=b.lines,b.opcode="")):(exports.copyOp(a,e),a.opcode=""):(exports.copyOp(b,e),b.opcode="");switch(e.opcode){case"=":l+=e.chars,m+=e.chars;break;case"-":l+=e.chars;break;case"+":m+=e.chars}});return m+=k-l,exports.pack(k,m,o,f.charBank)},exports.followAttributes=function(a,b,c){if(!b||!c)return"";if(!a)return b;var d=[];b.replace(/\*([0-9a-z]+)/g,function(a,b){return d.push(c.getAttrib(exports.parseNum(b))),""}),a.replace(/\*([0-9a-z]+)/g,function(a,b){var e=c.getAttrib(exports.parseNum(b));for(var f=0;f<d.length;f++){var g=d[f];if(e[0]==g[0]){e[1]<=g[1]&&d.splice(f,1);break}}return""});var e=exports.stringAssembler();for(var f=0;f<d.length;f++)e.append("*"),e.append(exports.numToString(c.putAttrib(d[f])));return e.toString()},exports.composeWithDeletions=function(a,b,c){var d=exports.unpack(a),e=exports.unpack(b),f=d.oldLen,g=d.newLen;exports.assert(g==e.oldLen,"mismatched composition");var h=e.newLen,i=exports.stringIterator(d.charBank),j=exports.stringIterator(e.charBank),k=exports.stringAssembler(),l=exports.applyZip(d.ops,0,e.ops,0,function(a,b,d){var e=a.opcode,f=b.opcode;e=="+"&&f=="-"&&i.skip(Math.min(a.chars,b.chars)),exports._slicerZipperFuncWithDeletions(a,b,d,c),d.opcode=="+"&&(f=="+"?k.append(j.take(d.chars)):k.append(i.take(d.chars)))});return exports.pack(f,h,l,k.toString())},exports._slicerZipperFuncWithDeletions=function(a,b,c,d){if(a.opcode=="-")exports.copyOp(a,c),a.opcode="";else if(!a.opcode)exports.copyOp(b,c),b.opcode="";else switch(b.opcode){case"-":b.chars<=a.chars?(a.opcode=="="&&(c.opcode="-",c.chars=b.chars,c.lines=b.lines,c.attribs=b.attribs),a.chars-=b.chars,a.lines-=b.lines,b.opcode="",a.chars||(a.opcode="")):(a.opcode=="="&&(c.opcode="-",c.chars=a.chars,c.lines=a.lines,c.attribs=b.attribs),b.chars-=a.chars,b.lines-=a.lines,a.opcode="");break;case"+":exports.copyOp(b,c),b.opcode="";break;case"=":b.chars<=a.chars?(c.opcode=a.opcode,c.chars=b.chars,c.lines=b.lines,c.attribs=exports.composeAttributes(a.attribs,b.attribs,a.opcode=="=",d),b.opcode="",a.chars-=b.chars,a.lines-=b.lines,a.chars||(a.opcode="")):(c.opcode=a.opcode,c.chars=a.chars,c.lines=a.lines,c.attribs=exports.composeAttributes(a.attribs,b.attribs,a.opcode=="=",d),a.opcode="",b.chars-=a.chars,b.lines-=a.lines);break;case"":exports.copyOp(a,c),a.opcode=""}}
}
, "ep_etherpad-lite/static/js/domline.js": function (require, exports, module) {
var Security=require("./security"),hooks=require("./pluginfw/hooks"),_=require("./underscore"),lineAttributeMarker=require("./linestylefilter").lineAttributeMarker,Ace2Common=require("./ace2_common"),noop=Ace2Common.noop,rtlChars=/[\u0590-\u06FF]/,domline={};domline.addToLineClass=function(a,b){return b.replace(/\S+/g,function(b){b.indexOf("line:")==0&&(a=(a?a+" ":"")+b.substring(5))}),a},domline.createDomLine=function(a,b,c,d,e){function m(a){return domline.processSpaces(a,b)}function q(){var b=o(i.join(""));b||(!h||!c?b+="&nbsp;":g.msie||(b+="<br/>")),a&&(b=(j||"")+b+(k||"")),i=j=k="",b!==l&&(l=b,f.node.innerHTML=l),p!==null&&(f.node.className=p),hooks.callAll("acePostWriteDomLineHTML",{node:f.node})}var f={node:null,appendSpan:noop,prepareForAdd:noop,notifyAdded:noop,clearSpans:noop,finishUpdate:noop,checkAttribs:noop,appendData:noop,lineMarker:0},g=c||{},h=d;h?f.node=h.createElement("div"):f.node={innerHTML:"",className:""};var i=[],j="",k="",l=null,n=b?_.identity:m,o=b?m:_.identity,p="ace-line";return f.appendSpan=function(a,b,c){var d=!1;if(b.indexOf(lineAttributeMarker)>=0){var g=/(?:^| )list:(\S+)/.exec(b),h=/(?:^| )start:(\S+)/.exec(b),l=/(?:^| )alc:(\S+)/.exec(b),m=~b.indexOf("hide-bullets");g&&(g=g[1],h=h?'start="'+Security.escapeHTMLAttribute(h[1])+'"':"",g&&g!="none"&&(g.indexOf("number")<0?(j='<ul class="list-'+Security.escapeHTMLAttribute(g)+(m?" hide-bullets":"")+(l&&l[1]?" "+l[1]:"")+'"><li>',k="</li></ul>"):(j="<ol "+h+' class="list-'+Security.escapeHTMLAttribute(g)+'"><li>',k="</li></ol>")),d=!0),_.map(hooks.callAll("aceDomLineProcessLineAttributes",{domline:domline,cls:b}),function(a){j+=a.preHtml,k+=a.postHtml,d|=a.processedMarker});if(d){f.lineMarker+=a.length;return}}var o=null;b.indexOf("tag")>=0&&(b=b.replace(/(^| )tag:(\S+)/g,function(a,b,c){return o||(o=[]),o.push(c.toLowerCase()),b+c}));var q="",r="",s=!1,t=!1;_.map(hooks.callAll("aceCreateDomLine",{domline:domline,cls:b,txt:a,spanData:c,html:i,result:f,onlyHtml:e}),function(a){b+=" "+a.cls,q+=a.extraOpenTags,r=a.extraCloseTags+r,a.hiddenSymbol&&(s=!0),a.dontAppendText&&(t=!0)});if(t)return;!a&&b?p=domline.addToLineClass(p,b):a&&(o&&(o.sort(),q=q+"<"+o.join("><")+">",o.reverse(),r="</"+o.join("></")+">"+r),s&&(a=""),rtlChars.test(a)&&(p=domline.addToLineClass(p,"line:ace-line-hebrew")),i.push('<span class="',Security.escapeHTMLAttribute(b||""),'">',q,n(Security.escapeHTML(a)),r,"</span>"))},f.clearSpans=function(){i=[],p="",f.lineMarker=0},f.prepareForAdd=q,f.finishUpdate=q,f.getInnerHTML=function(){return l||""},f},domline.processSpaces=function(a,b){if(a.indexOf("<")<0&&!b)return a.replace(/ /g,"&nbsp;");var c=[];a.replace(/<[^>]*>?| |[^ <]+/g,function(a){c.push(a)});if(b){var d=!0,e=!1;for(var f=c.length-1;f>=0;f--){var g=c[f];if(g==" "){if(d||e)c[f]="&nbsp;";d=!1,e=!0}else g.charAt(0)!="<"&&(d=!1,e=!1)}for(var f=0;f<c.length;f++){var g=c[f];if(g==" "){c[f]="&nbsp;";break}if(g.charAt(0)!="<")break}}else for(var f=0;f<c.length;f++){var g=c[f];g==" "&&(c[f]="&nbsp;")}return c.join("")},exports.domline=domline
}
, "ep_etherpad-lite/static/js/AttributeManager.js": function (require, exports, module) {
var Changeset=require("./Changeset"),ChangesetUtils=require("./ChangesetUtils"),_=require("./underscore"),lineMarkerAttribute="lmkr",lineAttributes=[lineMarkerAttribute,"list"],AttributeManager=function(a,b){this.rep=a,this.applyChangesetCallback=b,this.author=""};AttributeManager.lineAttributes=lineAttributes,AttributeManager.prototype=_(AttributeManager.prototype).extend({applyChangeset:function(a,b){if(!this.applyChangesetCallback)return a;var c=a.toString();return Changeset.isIdentity(c)||this.applyChangesetCallback(c,!1,b),a},setAttributesOnRange:function(a,b,c){var d=Changeset.builder(this.rep.lines.totalWidth());return ChangesetUtils.buildKeepToStartOfRange(this.rep,d,a),ChangesetUtils.buildKeepRange(this.rep,d,a,b,c,this.rep.apool),this.applyChangeset(d,c)},lineHasMarker:function(a){var b=this;return _.find(lineAttributes,function(c){return b.getAttributeOnLine(a,c)!=""})!==undefined},getAttributeOnLine:function(a,b){var c=this.rep.alines[a];if(c){var d=Changeset.opIterator(c);if(d.hasNext())return Changeset.opAttributeValue(d.next(),b,this.rep.apool)||""}return""},setAttributeOnLine:function(a,b,c){var d=[0,0],e=Changeset.builder(this.rep.lines.totalWidth()),f=this.lineHasMarker(a);return ChangesetUtils.buildKeepRange(this.rep,e,d,d=[a,0]),f?ChangesetUtils.buildKeepRange(this.rep,e,d,d=[a,1],[[b,c]],this.rep.apool):e.insert("*",[["author",this.author],["insertorder","first"],[lineMarkerAttribute,"1"],[b,c]],this.rep.apool),this.applyChangeset(e)},removeAttributeOnLine:function(a,b,c){var d=[0,0],e=Changeset.builder(this.rep.lines.totalWidth()),f=this.lineHasMarker(a);return f&&(ChangesetUtils.buildKeepRange(this.rep,e,d,d=[a,0]),ChangesetUtils.buildRemoveRange(this.rep,e,d,d=[a,1])),this.applyChangeset(e)},toggleAttributeOnLine:function(a,b,c){return this.getAttributeOnLine(b)?this.removeAttributeOnLine(a,b):this.setAttributeOnLine(a,b,c)}}),module.exports=AttributeManager
}
, "ep_etherpad-lite/static/js/linestylefilter.js": function (require, exports, module) {
var Changeset=require("./Changeset"),hooks=require("./pluginfw/hooks"),linestylefilter={},_=require("./underscore"),AttributeManager=require("./AttributeManager"),Security=require("./security");linestylefilter.ATTRIB_CLASSES={bold:"tag:b",italic:"tag:i",underline:"tag:u",strikethrough:"tag:s"};var lineAttributeMarker="lineAttribMarker";exports.lineAttributeMarker=lineAttributeMarker,linestylefilter.getAuthorClassName=function(a){return"author-"+a},linestylefilter.getLineStyleFilter=function(a,b,c,d){if(a==0)return c;var e=c,f=function(){function c(b){var c="",e=!1;return a={},Changeset.eachAttribNumber(b,function(b){var f=d.getAttribKey(b),g;f&&(g=d.getAttribValue(b),a[f]=g,g&&(!e&&_.indexOf(AttributeManager.lineAttributes,f)>=0&&(e=!0),f=="author"?c+=" "+linestylefilter.getAuthorClassName(g):f=="list"?c+=" list:"+g:f=="start"?c+=" start:"+g:linestylefilter.ATTRIB_CLASSES[f]?c+=" "+linestylefilter.ATTRIB_CLASSES[f]:c+=hooks.callAllStr("aceAttribsToClasses",{linestylefilter:linestylefilter,key:f,value:g}," "," ","")))}),e&&(c+=" "+lineAttributeMarker),c.substring(1)}var a;return function(d,f){var g=Changeset.opIterator(b),h,i="",j=d,k;while(g.hasNext())h=g.next(),i=h.opcode&&c(h.attribs),k=j.substring(0,h.chars),j=j.substring(h.chars),e(k,(f&&f+" ")+i,a),a=null;j&&console.log("some text left",j)}}();return f},linestylefilter.getAtSignSplitterFilter=function(a,b){var c=/@/g;c.lastIndex=0;var d=null,e;while(e=c.exec(a))d||(d=[]),d.push(e.index);return d?linestylefilter.textAndClassFuncSplitter(b,d):b},linestylefilter.getRegexpFilter=function(a,b){return function(c,d){function j(a){for(var b=0;b<e.length;b++){var c=e[b];if(a>=c[0]&&a<c[0]+c[1].length)return c[1]}return!1}a.lastIndex=0;var e=null,f=null,g;while(g=a.exec(c)){e||(e=[],f=[]);var h=g.index,i=g[0];e.push([h,i]),f.push(h,h+i.length)}if(!e)return d;var k=function(){var a=0;return function(c,e,f){var g=c.length,h=e,i=j(a);i&&(h+=" "+b+":"+Security.escapeURL(i)),d(c,h,f),a+=g}}();return linestylefilter.textAndClassFuncSplitter(k,f)}},linestylefilter.REGEX_WORDCHAR=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC\|]/,linestylefilter.REGEX_URLCHAR=new RegExp("("+/[-:@a-zA-Z0-9_.,~%+\/\\?=\{\}&#;$\*\!]/.source+"|"+linestylefilter.REGEX_WORDCHAR.source+")"),linestylefilter.REGEX_URL=new RegExp("(((?:"+Security.urlSchemeRegEx.source+")"+linestylefilter.REGEX_URLCHAR.source+"*(?![:.,;])"+linestylefilter.REGEX_URLCHAR.source+")|("+Security.docugateRegEx.source+")|("+Security.dmsRegEx.source+"))","gi"),linestylefilter.getURLFilter=linestylefilter.getRegexpFilter(linestylefilter.REGEX_URL,"url"),linestylefilter.textAndClassFuncSplitter=function(a,b){function e(f,g,h){if(!b||c>=b.length)a(f,g,h),d+=f.length;else{var i=b,j=i[c]-d,k=f.length;j>=k?(a(f,g,h),d+=f.length,j==k&&c++):(j>0&&(a(f.substring(0,j),g,h),d+=j),c++,e(f.substring(j),g))}}var c=0,d=0;while(b&&c<b.length&&b[c]==0)c++;return e},linestylefilter.getFilterStack=function(a,b,c){var d=linestylefilter.getURLFilter(a,b),e=hooks.callAll("aceGetFilterStack",{linestylefilter:linestylefilter,browser:c});return _.map(e,function(b){d=b(a,d)}),c!==undefined&&c.msie&&(d=linestylefilter.getAtSignSplitterFilter(a,d)),d},linestylefilter.populateDomLine=function(a,b,c,d){function g(a,b,c){c&&c.author&&(f||(f=c.author,d.lineAuthor=f)),d.appendSpan(a,b,c)}var e=a,f;e.slice(-1)=="\n"&&(e=e.substring(0,e.length-1));var h=linestylefilter.getFilterStack(e,g);h=linestylefilter.getLineStyleFilter(e.length,b,h,c),h(e,"")},exports.linestylefilter=linestylefilter
}
, "ep_etherpad-lite/static/js/AttributePool.js": function (require, exports, module) {
var AttributePool=function(){this.numToAttrib={},this.attribToNum={},this.nextNum=0};AttributePool.prototype.putAttrib=function(a,b){var c=String(a);if(c in this.attribToNum)return this.attribToNum[c];if(b)return-1;var d=this.nextNum++;return this.attribToNum[c]=d,this.numToAttrib[d]=[String(a[0]||""),String(a[1]||"")],d},AttributePool.prototype.getAttrib=function(a){var b=this.numToAttrib[a];return b?[b[0],b[1]]:b},AttributePool.prototype.getAttribKey=function(a){var b=this.numToAttrib[a];return b?b[0]:""},AttributePool.prototype.getAttribValue=function(a){var b=this.numToAttrib[a];return b?b[1]:""},AttributePool.prototype.eachAttrib=function(a){for(var b in this.numToAttrib){var c=this.numToAttrib[b];a(c[0],c[1])}},AttributePool.prototype.toJsonable=function(){return{numToAttrib:this.numToAttrib,nextNum:this.nextNum}},AttributePool.prototype.fromJsonable=function(a){this.numToAttrib=a.numToAttrib,this.nextNum=a.nextNum,this.attribToNum={};for(var b in this.numToAttrib)this.attribToNum[String(this.numToAttrib[b])]=Number(b);return this},module.exports=AttributePool
}
, "ep_etherpad-lite/static/js/ChangesetUtils.js": function (require, exports, module) {
exports.buildRemoveRange=function(a,b,c,d){var e=a.lines.offsetOfIndex(c[0]),f=a.lines.offsetOfIndex(d[0]);d[0]>c[0]?(b.remove(f-e-c[1],d[0]-c[0]),b.remove(d[1])):b.remove(d[1]-c[1])},exports.buildKeepRange=function(a,b,c,d,e,f){var g=a.lines.offsetOfIndex(c[0]),h=a.lines.offsetOfIndex(d[0]);d[0]>c[0]?(b.keep(h-g-c[1],d[0]-c[0],e,f),b.keep(d[1],0,e,f)):b.keep(d[1]-c[1],0,e,f)},exports.buildKeepToStartOfRange=function(a,b,c){var d=a.lines.offsetOfIndex(c[0]);b.keep(d,c[0]),b.keep(c[1])}
}
, "ep_etherpad-lite/static/js/slider/slider.js": function (require, exports, module) {
var AttribPool=require("../AttributePool"),Changeset=require("../Changeset"),PadContents=require("./padcontents").PadContents,RequestLoader=require("./requestloader").RequestLoader,RevisionInfo=require("./revision").RevisionInfo,Slider=function(a){this.setOpts(a),this.enable()};Slider.prototype.setOpts=function(a){a=a||{};var b=this;return this.clientVars=a.clientVars,this.collabClient=a.collabClient,this.revisionInfo=new RevisionInfo(Slider.toLoadCount),this.requestLoader=new RequestLoader({collabClient:this.collabClient,padId:this.clientVars.padId,onMessage:function(a){b.onMessage(a)}}),this.changesetsToCatch=[],this.started=!1,a.visualizer&&this.setVisualizer(a.visualizer),this},Slider.prototype.enable=function(){return this.enabled=!0,this},Slider.prototype.disable=function(){return this.enabled=!1,this},Slider.prototype.setVisualizer=function(a){var b=this;return this.visualizer=a,this.visualizer.on("slidermove",function(a){b.goToRevision(a)}),this.visualizer.on("slidersave",function(a){b.revertId=Math.random(),b.collabClient.sendClientMessage({t:"revert",rev:a,reqId:b.revertId})}),this},Slider.prototype.applyState=function(a,b,c){if(!this.visualizer)return;c=c||{};var d=b||this.revisionInfo&&this.revisionInfo.latest,e={range:[1,d],start:d,step:+this.requestLoader.granularity,silent:a,state:c};this.visualizer.applyState(e)},Slider.prototype.appendData=function(a){if(!this.visualizer)return;this.visualizer.appendData(a)},Slider.prototype.start=function(){var a=this,b=this.collabClient.getCurrentRevisionNumber()||1,c=b+1-Slider.toLoadCount;this.started=!1,this.padContents=null,this.visualizer&&this.visualizer.fireEvent("loadingstart"),this.requestLoader.load({from:c,to:null,needCollabVars:!0},function(b){a.handleLoad(b)})},Slider.prototype.handleLoad=function(a){if(a.t=="error"||!a.forward||!a.backward||isNaN(a.start)||!a.apool){this.applyState(null,null,{error:"loadError"});return}if(!this.started){var b=a.cv.rev+1;this.authorsColors=a.cv.authorsColors,this.started=!0,this.padContents=new PadContents({clientVars:a.cv}),this.visualizer&&this.padContents.setMasterEl(this.visualizer.masterEl),this.padContents.targetRevision=b,this.padContents.currentRevision=b,this.addChangesets(a),this.applyState(null,b),this.appendData({activeAuthors:this.padContents.getActiveAuthors(),authorsColors:this.authorsColors,time:this.padContents.currentTime})}else this.addChangesets(a)},Slider.prototype.onMessage=function(a){a.t=="n_changes"?this.addNewChanges(a):a.t=="error"&&a.st=="revert"&&a.revert&&a.revert==this.revertId&&(this.applyState(null,null,{error:"revertError"}),this.revertId=null)},Slider.prototype.addChangesets=function(a){var b=a;this.visualizer&&this.visualizer.fireEvent("loadingend");var c=(new AttribPool).fromJsonable(b.apool);for(var d=0;d<b.forward.length;d++){var e=b.start+d,f=b.start+(d+1);f>b.actualEndNum-1&&(f=b.actualEndNum);var g=Changeset.moveOpsToNewPool(b.forward[d],c,this.padContents.apool),h=Changeset.moveOpsToNewPool(b.backward[d],c,this.padContents.apool);this.revisionInfo.addChangeset(e,f,g,h,b.timeDeltas[d])}a.atext&&this.revisionInfo.addAText(a.atext);for(var d=0,i;i=this.changesetsToCatch[d];d++)this.addNewChanges(i);this.changesetsToCatch=[],console.log("after load current is ",this.padContents.currentRevision," and target is ",this.padContents.targetRevision),this.padContents.targetRevision!=this.padContents.currentRevision&&this.goToRevision(this.padContents.targetRevision)},Slider.prototype.addNewChanges=function(a){if(!this.enabled)return;if(!this.started){this.changesetsToCatch.push(a);return}var b=(new AttribPool).fromJsonable(a.a),c=Changeset.moveOpsToNewPool(a.c,b,this.padContents.apool),d=Changeset.inverse(a.c,this.padContents.lastLines,this.padContents.lastALines,this.padContents.apool);this.padContents.applyChangesetSilent(c);if(b.nextNum!=0)try{d=Changeset.moveOpsToNewPool(d,b,this.padContents.apool)}catch(e){console.log("apool move error",e)}this.revisionInfo.addChangeset(a.rev,a.rev+1,c,d,a.td);var f=!1;a.revert&&a.revert==this.revertId&&(this.revertId=null,f=!0),this.applyState(!0,null,{revert:f})},Slider.prototype.goToRevision=function(a){if(!this.started||this.padContents.currentRevision==a)return;this.padContents.targetRevision=a,console.log("go from ",this.padContents.currentRevision," to ",a);var b=this.revisionInfo.getPath(this.padContents.currentRevision,a),c=this;b.status=="complete"?this.padContents.applyRevisionsFromPath(b,this.padContents.apool):b.status=="atext"?(this.padContents.applyAText(this.revisionInfo[b.atext].atext,b.atext,this.revisionInfo[b.atext].time),b=this.revisionInfo.goThrough(this.padContents.currentRevision,a),this.padContents.applyRevisionsFromPath(b,this.padContents.apool)):b.status=="partial"&&(this.visualizer&&this.visualizer.fireEvent("loadingstart"),this.padContents.applyRevisionsFromPath(b,this.padContents.apool),this.requestLoader.load({from:b.load.from,to:b.load.to},function(a){c.handleLoad(a)})),this.appendData({activeAuthors:this.padContents.getActiveAuthors(),authorsColors:this.authorsColors,time:this.padContents.currentTime})},Slider.prototype.destroy=function(){this.enabled=!1,this.clientVars=null,this.collabClient=null,this.revisionInfo=null,this.requestLoader.destroy(),this.requestLoader=null,this.padContents=null},Slider.toLoadCount=110,exports.Slider=Slider
}
, "ep_etherpad-lite/static/js/slider/padcontents.js": function (require, exports, module) {
function PadContents(a){if(!a.clientVars)throw new Error("pad content misconfigured");this.currentTime=a.clientVars.time,this.currentDivs=null,this.applyAText(a.clientVars.initialAttributedText),this.apool=(new AttribPool).fromJsonable(a.clientVars.apool),this.lastLines=Changeset.splitTextLines(a.clientVars.initialAttributedText.text),this.lastALines=Changeset.splitAttributionLines(a.clientVars.initialAttributedText.attribs,a.clientVars.initialAttributedText.text),this.silentMode=!1,this.currentDivs=[]}var AttribPool=require("../AttributePool"),Changeset=require("../Changeset"),linestylefilter=require("../linestylefilter").linestylefilter,_=require("../underscore"),domline=require("../domline").domline;PadContents.prototype.applyAText=function(a,b,c){this.currentLines=Changeset.splitTextLines(a.text),this.alines=Changeset.splitAttributionLines(a.attribs,a.text),b&&(this.currentRevision=b+1),c&&(this.currentTime=c),this.masterEl&&(this.masterEl.innerHTML="",this.initialApply())},PadContents.prototype.applySpliceToDivs=function(a,b,c){if(!this.masterEl)return;for(var d=0,e;e=this.currentDivs[d];d++)e.setAttribute("rel","");for(var d=a;d<a+b&&d<this.currentDivs.length;d++)this.currentDivs[d].parentNode.removeChild(this.currentDivs[d]);this.currentDivs.splice(a,b);var f=[],g,h=0;for(var d=0;d<c.length;d++)f.push(this.lineToElement(c[d],this.alines[a+d])),d==0&&f[0].setAttribute("rel","new-additions");f.length==0&&console.log("no new divs",a,b),g=this.currentDivs[a-1]||null,a==0&&f[0]&&this.currentDivs[0]&&(this.masterEl.insertBefore(f[0],this.currentDivs[0]),g=f[0],h=1);for(var d=h;d<f.length;d++)g&&g.nextSibling?this.masterEl.insertBefore(f[d],g.nextSibling):this.masterEl.appendChild(f[d]),g=f[d];return f.unshift(0),f.unshift(a),this.currentDivs.splice.apply(this.currentDivs,f),this},PadContents.prototype.lineToElement=function(a,b){var c=document.createElement("div"),d=a=="\n",e=domline.createDomLine(!d,!0,null,null,!0);return linestylefilter.populateDomLine(a,b,this.apool,e),e.prepareForAdd(),c.className=e.node.className+(e.lineAuthor?" ace-line-"+e.lineAuthor:""),c.innerHTML=e.node.innerHTML,c},PadContents.prototype.splice=function(a,b,c){var d=_.map(Array.prototype.slice.call(arguments,2),function(a){return a});this.silentMode?this.lastLines.splice.apply(this.lastLines,arguments):(this.applySpliceToDivs(a,b,d),d.unshift(b),d.unshift(a),this.currentLines.splice.apply(this.currentLines,arguments))},PadContents.prototype.get=function(a){return this.silentMode?this.lastLines[a]:this.currentLines[a]},PadContents.prototype.length=function(){return this.silentMode?this.lastLines.length:this.currentLines.length},PadContents.prototype.setMasterEl=function(a){a?(this.masterEl=a,this.initialApply()):this.masterEl=null},PadContents.prototype.initialApply=function(){this.currentDivs=[];for(var a=0;a<this.currentLines.length;a++){var b=this.lineToElement(this.currentLines[a],this.alines[a]);this.currentDivs.push(b),this.masterEl.appendChild(b)}},PadContents.prototype.applyChangeset=function(a,b,c,d){try{Changeset.mutateAttributionLines(a,this.alines,this.apool)}catch(e){console.log(e)}Changeset.mutateTextLines(a,this),this.currentRevision=b,this.currentTime+=d,console.log("applying changeset",this.currentTime,b)},PadContents.prototype.applyChangesetSilent=function(a){this.silentMode=!0;try{Changeset.mutateAttributionLines(a,this.lastALines,this.apool)}catch(b){console.log(b)}Changeset.mutateTextLines(a,this),this.silentMode=!1},PadContents.prototype.applyRevisionsFromPath=function(a,b){var c=a.changesets,d,e;if(!c.length)return;e=c[0],d=a.times[0];for(var f=1;f<c.length;f++)e=Changeset.compose(e,c[f],b),d+=a.times[f];e&&this.applyChangeset(e,a.rev,!0,d)},PadContents.prototype.getActiveAuthors=function(){var a=this,b=[],c={},d=a.alines;for(var e=0;e<d.length;e++)Changeset.eachAttribNumber(d[e],function(d){if(!c[d]){c[d]=!0;if(a.apool.getAttribKey(d)=="author"){var e=a.apool.getAttribValue(d);e&&b.push(e)}}});return b.sort(),b},exports.PadContents=PadContents
}
, "ep_etherpad-lite/static/js/slider/requestloader.js": function (require, exports, module) {
function RequestLoader(a){a=a||{};var b=this;this.collabClient=a.collabClient,this.padId=a.padId||1,this.onMessage=a.onMessage,this.granularity=1,this.requests={},this.collabClient.setOnServerMessage(function(a){b.handleMessageFromServer(a)})}RequestLoader.prototype.load=function(a,b){a=a||{};var c=a.from,d=a.to,e=this;c<0&&(c=0);var f=c+"_"+(d||"max");if(this.requests[f]){var g=this.requests[f];g.loaded?console.warn("request loader: already loaded",f):(console.warn("request loader: loading",f),g.callback=b);return}return this.requests[f]={callback:b,loaded:!1,timeout:setTimeout(function(){var a=e.requests[f];a&&(a.callback&&a.callback({t:"error",msg:"request timed out"}),delete a.callback)},RequestLoader.requestTimeout)},this.collabClient.sendMessage({t:"ch_req",start:c,end:d,cv:a.needCollabVars||null,reqId:f}),this},RequestLoader.prototype.handleMessageFromServer=function(a){if(a.t!="ch_resp"&&a.t!="error"||!this.requests[a.reqId])(a.t=="n_changes"||a.t=="error"&&a.st=="revert")&&this.onMessage(a);else{var b=this.requests[a.reqId];clearTimeout(b.timeout),b.callback&&b.callback(a),delete b.callback,b.loaded=!0}},RequestLoader.prototype.destroy=function(){this.collabClient.setOnServerMessage(function(){})},RequestLoader.requestTimeout=2e4,exports.RequestLoader=RequestLoader
}
, "ep_etherpad-lite/static/js/slider/revision.js": function (require, exports, module) {
function Revision(a){this.rev=a,this.changesets={}}function RevisionInfo(a){this.latest=0,this.areaChangesetsCount=a}Revision.prototype.addChangeset=function(a,b,c){var d=a-this.rev;if(this.changesets[d==-1?"b":"f"])return;this.changesets[d==-1?"b":"f"]={ch:b,td:c},this.changesets.b&&this.changesets.f&&(this.complete=!0)},RevisionInfo.prototype.addChangeset=function(a,b,c,d,e){var f=this[a]||this.createNew(a),g=this[b]||this.createNew(b);f.addChangeset(b,c,e),g.addChangeset(a,d,-1*e)},RevisionInfo.prototype.addAText=function(a){this[a.rev].atext=a.atext,this[a.rev].time=a.time},RevisionInfo.prototype.createNew=function(a){return this[a]=new Revision(a),a>this.latest&&(this.latest=a),this[a]},RevisionInfo.prototype.goThrough=function(a,b){var c=[],d=[],e=this[a]||this.createNew(a),f=!(a<b);if(a!=b)while(e&&(e.rev<b&&!f||e.rev>b&&f)){if(f&&!e.changesets.b||!f&&!e.changesets.f)break;c.push(e.changesets[f?"b":"f"].ch),d.push(e.changesets[f?"b":"f"].td),e=this[e.rev+(f?-1:1)]}return{rev:e.rev,changesets:c,times:d}},RevisionInfo.prototype.getPath=function(a,b){var c=this.goThrough(a,b),d=this.checkATextAvailability(b),e,f;if(c.rev==b||d)d&&Math.abs(b-d)<Math.abs(a-b)?f="atext":f="complete";else{f="partial";var g=Math.round(this.areaChangesetsCount/2),h=b-g,i=b+g;h<1&&(i-=h,h=1);for(var j=h;j<i;j++){if(!this[j]||!this[j].complete)break;h=j}for(var j=i;j>h;j--){if(!this[j]||!this[j].complete)break;i=j}e={from:h,to:i}}return{fromRev:a,rev:c.rev,status:f,changesets:c.changesets,times:c.times,atext:d,load:e}},RevisionInfo.prototype.checkATextAvailability=function(a){var b=100,c=a-a%b,d=c-100,e=a+100-a%b,f=null,g=null;if(this[c]&&this[c].atext){f=!1;for(var h=c;h<a;h++)if(!this[h]||!this[h].changesets.f){f=!0;break}}else if(this[d]&&this[d].atext){f=!1;for(var h=d;h<a;h++)if(!this[h]||!this[h].changesets.f){f=!0;break}f||(c=d)}if(this[e]&&this[e].atext){g=!1;for(var h=e;h>a;h--)if(!this[h]||!this[h].changesets.b){g=!0;break}}return f===!1&&g===!1?Math.abs(a-c)>Math.abs(e-a)?e:c:f===!1?c:g===!1?e:null},exports.RevisionInfo=RevisionInfo
}
, "ep_etherpad-lite/static/js/ace2_common": null
, "ep_etherpad-lite/static/js/ace2_inner": null
, "ep_etherpad-lite/static/js/skiplist": null
, "ep_etherpad-lite/static/js/virtual_lines": null
, "ep_etherpad-lite/static/js/cssmanager": null
, "ep_etherpad-lite/static/js/colorutils": null
, "ep_etherpad-lite/static/js/undomodule": null
, "ep_etherpad-lite/static/js/contentcollector": null
, "ep_etherpad-lite/static/js/changesettracker": null
, "ep_etherpad-lite/static/js/jquery": null
, "ep_etherpad-lite/static/js/rjquery": null
, "ep_etherpad-lite/static/js/underscore": null
, "ep_etherpad-lite/static/js/security": null
, "ep_etherpad-lite/static/js/pluginfw/plugins": null
, "ep_etherpad-lite/static/js/pluginfw/hooks": null
, "ep_etherpad-lite/static/js/pluginfw/async": null
, "ep_etherpad-lite/static/js/pluginfw/parent_require": null
, "ep_etherpad-lite/static/js/Changeset": null
, "ep_etherpad-lite/static/js/domline": null
, "ep_etherpad-lite/static/js/AttributeManager": null
, "ep_etherpad-lite/static/js/linestylefilter": null
, "ep_etherpad-lite/static/js/AttributePool": null
, "ep_etherpad-lite/static/js/ChangesetUtils": null
, "ep_etherpad-lite/static/js/slider/slider": null
, "ep_etherpad-lite/static/js/slider/padcontents": null
, "ep_etherpad-lite/static/js/slider/requestloader": null
, "ep_etherpad-lite/static/js/slider/revision": null
});
require.define({
  "ep_etherpad-lite/static/js/pad.js": function (require, exports, module) {
function getParams(){var a=getUrlVars(),b=a.showControls,c=a.userName,d=a.showLineNumbers,e=a.useMonospaceFont,f=a.noColors,g=a.rtl;f&&f=="true"&&(settings.noColors=!0,$("#clearAuthorship").hide()),b&&b=="false"&&($("#"+pad.idSettings.editbar).hide(),$("#"+pad.idSettings.editorcontainer).css({top:"0px"})),d&&d=="false"&&(settings.LineNumbersDisabled=!0),e&&e=="true"&&(settings.useMonospaceFontGlobal=!0),c&&(settings.globalUserName=decodeURIComponent(c)),g&&g=="true"&&(settings.rtlIsTrue=!0)}function getUrlVars(){var a=[],b,c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var d=0;d<c.length;d++)b=c[d].split("="),a.push(b[0]),a[b[0]]=b[1];return a}function setChannelState(a,b){pad&&pad.collabClient&&pad.collabClient.setChannelState(a,b)}function onConnect(){clearTimeout(disconnectTimeout),setChannelState("CONNECTED"),padeditbar.setReconnectingStatus(0,!1)}function onMessage(a){if(disposed)return;if(!this.receivedClientVars&&a.accessStatus){if(a.accessStatus=="deny"){$("#"+pad.idSettings.editorloadingbox).css("visibility","hidden"),$("#"+pad.idSettings.editorpermissionbox).css("visibility","visible"),pad.fireEvent("state.noPermission");return}}else if(a.t=="pad_data"){readyBackOff.stop(),forceResendClientReady=!1,this.receivedClientVars=!0,pad.clientVars=a;var b=a;b.userAgent="Anonymous",pad._afterHandshake(b),$("body").addClass(b.readonly?"readonly":"readwrite"),padeditor.ace.callWithAce(function(a){a.ace_setEditable(!b.readonly)}),settings.LineNumbersDisabled==1&&pad.changeViewOption("showLineNumbers",!1),settings.noColors==1&&pad.changeViewOption("noColors",!0),settings.rtlIsTrue==1&&pad.changeViewOption("rtl",!0),settings.useMonospaceFontGlobal==1&&pad.changeViewOption("useMonospaceFont",!0),settings.globalUserName!==!1&&(pad.notifyChangeName(settings.globalUserName),pad.myUserInfo.name=settings.globalUserName,$("#myusernameedit").attr({value:settings.globalUserName})),pad.fireEvent("client.vars.received",a.collab_client_vars)}else a.disconnect?(console.warn("FORCED TO DISCONNECT"),console.warn(a),forceResendClientReady=!0,pad.fireEvent("forced.disconnection",a.disconnect)):a.t=="rcnt"?a.available===!1?readyBackOff.start():sendClientReady():(a.t=="reconnect_ok"&&readyBackOff.stop(),pad.collabClient&&pad.collabClient.handleMessageFromServer(a))}function sendClientReady(){lastPadId!=padId&&(forceResendClientReady=!0);var a={t:"ready",padId:padId,task_id:padId,le2_redirect_support:!0,account_id:pad.accountId,token:userId};!forceResendClientReady&&pad.collabClient&&pad.collabClient.getCurrentRevisionNumber()&&lastPadId==padId&&(a.client_rev=pad.collabClient.getCurrentRevisionNumber(),a.reconnect=!0),lastPadId=padId;var b="live_editor";pad.connection.send(JSON.stringify(a),b)}function getURLParameter(a){return decodeURIComponent(((new RegExp("[?|&]"+a+"="+"([^&;]+?)(&|#|;|$)")).exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function padOnClose(a,b){console.log("socket closed",a),a&&a[0]&&(b=a[1]||{},a=a[0]);if(a=="forced close")setChannelState("DISCONNECTED");else if(a=="transport error"){var c=(b||{}).description==403;c&&!pad.handshakeForbidden&&(pad.handshakeForbidden=!0,pad.fireEvent("pad.handshakeForbidden"))}else{function d(){console.log("disconnect event"),setChannelState("DISCONNECTED","reconnect_timeout")}setChannelState("RECONNECTING"),clearTimeout(disconnectTimeout),disconnectTimeout=setTimeout(d,disconnectTimeoutTime)}}function handshake(a){var b=pad.connection&&socket!=pad.connection.socket,c=!socket;if(c||b){if(!pad.connection){var d=document.location,e,f,g="",h=require("./connection").Connection;(e=eio.util.parseUri(exports.baseURL))&&e.host&&e.protocol?(f=e,f.path&&f.path.indexOf("engine.io")==-1&&(f.path+="engine.io"),g=f.protocol+"://"+f.host+(f.port?":"+f.port:"")):(f={host:"",path:exports.baseURL+"engine.io",timestampRequests:!0,timestampParam:"t"},pad.ai&&(f.query={ai:pad.ai}),g=d.protocol+"//"+d.hostname),pad.padURI=g,pad.connection=new h({transportParams:f,autoReconnect:!0,pingUrl:exports.baseURL+"ping"})}pad.connection.connect(),socket=pad.connection.socket,pad.connection.padListeners||(pad.connection.padListeners=!0,pad.connection.on("open",function(){onConnect(),sendClientReady()}),pad.connection.on("reconnecting",function(a){padeditbar.setReconnectingStatus(a,!0)}),pad.connection.on("close",padOnClose),pad.connection.addMessageHandler(onMessage))}pad.connection.isConnected()?(onConnect(),sendClientReady()):pad.connection.isClosed()&&!pad.handshakeForbidden&&pad.connection.connect()}function init(a,b,c,d){return pad.init(a,b,c,d)}function dispose(){return pad.dispose()}function clear(){padeditor&&padeditor.clearPadText(),forceResendClientReady=!0}window.unwrap||(window.unwrap=function(a){return a});var socket,getCollabClient=require("./collab_client").getCollabClient,getUserColor=require("./collab_client").getUserColor,padcookie=require("./pad_cookie").padcookie,padeditbar=require("./pad_editbar").padeditbar,padeditor=require("./pad_editor").padeditor,CursorHandler=require("./pad_cursorhandler").CursorHandler,padutils=require("./pad_utils").padutils,Slider=require("./slider/slider").Slider,makeObservable=require("./Observable").makeObservable,hooks=require("./pluginfw/hooks"),BackOff=require("./BackOff").BackOff,readyBackOff=new BackOff(300,3e4,function(a,b){console.log("Ready try #"+a+", delay "+b+"ms"),sendClientReady()}),padId="default-pad",lastPadId,userId,forceResendClientReady=!1,disposed=!1,padCursorHandler=new CursorHandler,disconnectTimeoutTime=1e4,disconnectTimeout,pad={collabClient:null,myUserInfo:null,diagnosticInfo:{},initTime:0,isMobile:!1,clientTimeOffset:null,preloadedImages:!1,accountId:null,padOptions:{},clientVars:{},getPadId:function(){return this.clientVars.padId},getClientIp:function(){return this.clientVars.clientIp},getIsProPad:function(){return this.clientVars.isProPad},getDisplayUserAgent:function(){return padutils.uaDisplay(this.clientVars.userAgent)},getIsDebugEnabled:function(){return this.clientVars.debugEnabled},getPrivilege:function(a){return this.clientVars.accountPrivs[a]},getUserIsGuest:function(){return this.clientVars.userIsGuest},getUserId:function(){return pad.myUserInfo.userId},getUserName:function(){return pad.myUserInfo.name},sendClientMessage:function(a){pad.collabClient.sendClientMessage(a)},init:function(a,b,c,d){disposed=!1,padId=a?""+a:padId,userId=b,pad.accountId=d,pad.baseURL=exports.baseURL,pad.ai=c,pad.jQuerySrc=exports.jQuerySrc,pad.connection=pad.connection||exports.connection,pad.fireEvent("pad.init",padId),padeditor.disable(null,!0),pad.collabClient&&(pad.collabClient.clearTimeouts(),pad.collabClient.handleUserChanges(!0)),getParams(),handshake()},handshake:handshake,_afterHandshake:function(a){function b(){padeditbar.init(pad),hooks.aCallAll("postAceInit",{ace:padeditor.ace}),padeditor.enable()}pad.fireEvent("after.handshake",a),pad.clientTimeOffset=(new Date).getTime()-a.ct,pad.initTime=+(new Date),pad.padOptions=a.initialOptions,padcookie.init(a.cookiePrefsToSet,this),pad.myUserInfo={userId:a.userId,name:a.userName,ip:pad.getClientIp(),color:getUserColor(a.userId),userAgent:pad.getDisplayUserAgent()},a.specialKey&&(pad.myUserInfo.specialKey=a.specialKey,a.specialKeyTranslation&&$("#specialkeyarea").html("mode: "+String(a.specialKeyTranslation).toUpperCase())),padeditor&&!padeditor.ace?(padCursorHandler.init(padeditor),padeditor.init(b,pad.padOptions.view||{},this)):(padeditor.enable(),padeditor.setViewOptions(pad.padOptions.view||{}),padCursorHandler.clearCursors()),pad.collabClient=getCollabClient(padeditor,a.collab_client_vars,pad.myUserInfo,{},pad),pad.collabClient.setOnClientMessage(pad.handleClientMessage),pad.collabClient.setOnServerMessage(pad.handleServerMessage),pad.collabClient.setOnChannelStateChange(pad.handleChannelStateChange),pad.collabClient.setOnInternalAction(pad.handleCollabAction),pad.padeditbar=padeditbar,padeditor.ace.on("ace.paste",function(a){window.__acePasteEvent=a,pad.fireEvent("ace.pasted")})},dispose:function(){pad.collabClient=null,padeditor.dispose(),this.destroyListeners(),disposed=!0},freeze:function(){pad.connection&&pad.connection.disconnect(),forceResendClientReady=!0,disposed=!0},notifyChangeName:function(a){pad.myUserInfo.name=a,pad.collabClient.updateUserInfo(pad.myUserInfo)},notifyChangeColor:function(a){pad.myUserInfo.color=a,pad.collabClient.updateUserInfo(pad.myUserInfo)},handleSaveDescription:function(a){pad.collabClient.sendClientMessage({t:"descr",descr:a})},changePadOption:function(a,b){var c={};c[a]=b,pad.handleOptionsChange(c),pad.collabClient.sendClientMessage({type:"padoptions",options:c,changedBy:pad.myUserInfo.name||"unnamed"})},changeViewOption:function(a,b){var c={view:{}};c.view[a]=b,pad.handleOptionsChange(c)},handleOptionsChange:function(a){if(a.view){pad.padOptions.view||(pad.padOptions.view={});for(var b in a.view)pad.padOptions.view[b]=a.view[b];padeditor.setViewOptions(pad.padOptions.view)}a.guestPolicy&&(pad.padOptions.guestPolicy=a.guestPolicy)},getPadOptions:function(){return pad.padOptions},isPadPublic:function(){return!pad.getIsProPad()||pad.getPadOptions().guestPolicy=="allow"},openSlider:function(a){a||(a=window.__aceSliderHandler),pad.slider||(pad.slider=new Slider({collabClient:pad.collabClient,clientVars:pad.clientVars})),pad.slider.setOpts({collabClient:pad.collabClient,clientVars:pad.clientVars}),a.on("destroy",function(){pad.slider.destroy(),pad.slider=null}),pad.slider.setVisualizer(a).enable().start()},suggestUserName:function(a,b){pad.collabClient.sendClientMessage({type:"suggestUserName",unnamedId:a,newName:b})},handleUserJoin:function(a){},handleUserUpdate:function(a){},handleUserLeave:function(a){},handleClientMessage:function(a){if(a.type=="suggestUserName")a.unnamedId==pad.myUserInfo.userId&&a.newName&&!pad.myUserInfo.name&&pad.notifyChangeName(a.newName);else if(a.type!="newRevisionList"&&a.type!="revisionLabel"&&a.type=="padoptions"){var b=a.options;pad.handleOptionsChange(b)}},dmesg:function(a,b){if(pad.getIsDebugEnabled()){var c="#djs";if($(c).get(0)){a&&(a=a.replace(/^([\w_-]+):/,"<b>$1</b>:"));var d="logPanel",e="logPanelContent",f="logPanelClear";if(!$("#"+d)[0]){var g='<p id="logPanel"><span style="cursor: pointer" id="'+f+'">clear</span><p id="'+e+'" /></p>';$(c).prepend(g),$("#"+f).click(function(){$("#"+e).html("")})}var h=djs.scrollTop-(djs.scrollHeight-$(djs).height())>=-20,i="<p>"+a+"</p>";b&&(b=JSON.stringify(b,null,4),i+="<p>"+b+"</p>"),i='<p style="border-bottom: 1px solid #ccc;">'+i+"</p>",$("#"+e).prepend(i),h&&(djs.scrollTop=djs.scrollHeight)}}},handleServerMessage:function(a){a.type=="NOTICE"&&(a.text&&alertBar.displayMessage(function(b){b.find("#servermsgdate").html(" ("+padutils.simpleDateTime(new Date)+")"),b.find("#servermsgtext").html(a.text)}),a.js&&window.eval(a.js))},handleChannelStateChange:function(a,b){a=="CONNECTED"?padeditor.enable():a=="DISCONNECTED"&&(padeditor.disable(!0),padeditbar.disable())},handleIsFullyConnected:function(a,b){a&&!pad.preloadedImages&&window.setTimeout(function(){pad.preloadedImages||(pad.preloadImages(),pad.preloadedImages=!0)},1e3),pad.determineAuthorshipColorsVisibility()},determineAuthorshipColorsVisibility:function(){var a=padcookie.getPref("showAuthorshipColors");a?(pad.changeViewOption("showAuthorColors",!0),$("#options-colorscheck").prop("checked",!0)):$("#options-colorscheck").prop("checked",!1)},handleCollabAction:function(a){a=="commitPerformed"?padeditbar.setSyncStatus("syncing"):a=="newlyIdle"&&padeditbar.setSyncStatus("done")},hideServerMessage:function(){alertBar.hideMessage()},toggleWidthPref:function(){var a=!padcookie.getPref("fullWidth");padcookie.setPref("fullWidth",a),$("#widthprefcheck").toggleClass("widthprefchecked",!!a).toggleClass("widthprefunchecked",!a),pad.handleWidthChange()},handleWidthChange:function(){var a=padcookie.getPref("fullWidth");if(a)$("body").addClass("fullwidth").removeClass("limwidth").removeClass("squish1width").removeClass("squish2width");else{$("body").addClass("limwidth").removeClass("fullwidth");var b=$(window).width();$("body").toggleClass("squish1width",b<912&&b>812).toggleClass("squish2width",b<=812)}},handleImportExportFrameCall:function(a,b){},callWhenNotCommitting:function(a){pad.collabClient.callWhenNotCommitting(a)},getCollabRevisionNumber:function(){return pad.collabClient.getCurrentRevisionNumber()},addHistoricalAuthors:function(a){pad.collabClient?pad.collabClient.addHistoricalAuthors(a):window.setTimeout(function(){pad.addHistoricalAuthors(a)},1e3)},preloadImages:function(){function b(){if(a.length==0)return;var b=new Image;b.src=a.shift(),b.complete?c():$(b).bind("error load onreadystatechange",c)}function c(){window.setTimeout(b,0)}var a=[];c()}};makeObservable(pad);var alertBar=function(){function b(a){a==-1?$("#alertbar").css("opacity",0).css("display","block"):a==0?$("#alertbar").css("opacity",1):a==1?$("#alertbar").css("opacity",0).css("display","none"):a<0?$("#alertbar").css("opacity",a+1):a>0&&$("#alertbar").css("opacity",1-a)}var a=padutils.makeShowHideAnimator(b,!1,25,400),c={displayMessage:function(b){a.show(),b($("#alertbar"))},hideMessage:function(){a.hide()}};return c}(),settings={LineNumbersDisabled:!1,noColors:!1,useMonospaceFontGlobal:!1,globalUserName:!1,rtlIsTrue:!1},idSettings={editorcontainer:"editorcontainer",editorloadingbox:"editorloadingbox",editorpermissionbox:"editorpermissionbox",editbar:"editbar",reconnectstatus:"reconnectstatus",syncstatussyncing:"syncstatussyncing",syncstatusdone:"syncstatusdone"};pad.settings=settings,pad.idSettings=idSettings,pad.scriptsVersion=1,pad.editorContainerId=null,exports.baseURL="",exports.jQuerySrc="",exports.settings=settings,exports.getParams=getParams,exports.getUrlVars=getUrlVars,exports.handshake=handshake,exports.pad=pad,exports.init=init,exports.clear=clear,exports.dispose=dispose,exports.alertBar=alertBar
}
, "ep_etherpad-lite/static/js/pad_utils.js": function (require, exports, module) {
function randomString(a){var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",c="";a=a||20;for(var d=0;d<a;d++){var e=Math.floor(Math.random()*b.length);c+=b.substring(e,e+1)}return c}function createCookie(a,b,c,d){if(c){var e=new Date;e.setTime(e.getTime()+c*24*60*60*1e3);var f="; expires="+e.toGMTString()}else var f="";d||(d="/"),document.cookie=a+"="+b+f+"; path="+d}function readCookie(a){var b=a+"=",c=document.cookie.split(";");for(var d=0;d<c.length;d++){var e=c[d];while(e.charAt(0)==" ")e=e.substring(1,e.length);if(e.indexOf(b)==0)return e.substring(b.length,e.length)}return null}function setupGlobalExceptionHandler(){globalExceptionHandler||(globalExceptionHandler=function(b,c,d){var e=randomString(20);$("#editorloadingbox").attr("display")!="none"&&($("#editorloadingbox").css("padding","10px"),$("#editorloadingbox").css("padding-top","45px"),$("#editorloadingbox").html("<div style='text-align:left;color:red;font-size:16px;'><b>An error occured</b><br>The error was reported with the following id: '"+e+"'<br><br><span style='color:black;font-weight:bold;font-size:16px'>Please send this error message to us: </span><div style='color:black;font-size:14px'>'"+"ErrorId: "+e+"<br>UserAgent: "+navigator.userAgent+"<br>"+b+" in "+c+" at line "+d+"'</div></div>"));var f={errorInfo:JSON.stringify({errorId:e,msg:b,url:c,linenumber:d,userAgent:navigator.userAgent})},g=document.location,c=g.protocol+"//"+g.hostname+":"+g.port+"/"+g.pathname.substr(1,g.pathname.indexOf("/p/"))+"jserror";return $.post(c,f),!1})}var Security=require("./security"),padutils={escapeHtml:function(a){return Security.escapeHTML(String(a))},uaDisplay:function(a){function c(a){var b=16;return a=a.replace(/[^a-zA-Z0-9\.]/g,""),a.length>b&&(a=a.substr(0,b)),a}function d(b){var d=a.match(RegExp(b+"\\/([\\d\\.]+)"));return d&&d.length>1?c(b+d[1]):null}var b;if(d("Firefox"))return d("Firefox");b=a.match(/compatible; ([^;]+);/);if(b&&b.length>1)return c(b[1]);if(a.match(/\(iPhone;/))return"iPhone";if(d("Chrome"))return d("Chrome");b=a.match(/Safari\/[\d\.]+/);if(b){var e="?";return b=a.match(/Version\/([\d\.]+)/),b&&b.length>1&&(e=b[1]),c("Safari"+e)}var f=a.split(" ")[0];return c(f)},simpleDateTime:function(a){var b=new Date(+a),c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][b.getDay()],d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getMonth()],e=b.getDate(),f=b.getFullYear(),g=b.getHours()+":"+("0"+b.getMinutes()).slice(-2);return c+" "+d+" "+e+" "+f+" "+g},findURLs:function(a){function e(a){d.lastIndex=0;var b=null,c;while(c=d.exec(a)){b=b||[];var e=c.index,f=c[0];b.push([e,f])}return b}var b=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/,c=new RegExp("("+/[-:@a-zA-Z0-9_.,~%+\/?=&#;()$]/.source+"|"+b.source+")"),d=new RegExp("(?:"+Security.urlSchemeRegEx.source+")"+c.source+"*(?![:.,;])"+c.source,"g");return e(a)},escapeHtmlWithClickableLinks:function(a,b){function f(b){b>c&&(d.push(Security.escapeHTML(a.substring(c,b))),c=b)}var c=0,d=[],e=padutils.findURLs(a);if(e)for(var g=0;g<e.length;g++){var h=e[g][0],i=e[g][1];f(h),d.push("<a ",b?'target="'+Security.escapeHTMLAttribute(b)+'" ':"",'href="',Security.escapeHTMLAttribute(i),'">'),f(h+i.length),d.push("</a>")}return f(a.length),d.join("")},bindEnterAndEscape:function(a,b,c){b&&a.keypress(function(a){a.which==13&&b(a)}),c&&a.keydown(function(a){a.which==27&&c(a)})},timediff:function(a){function c(a,b){return a=Math.round(a),""+a+" "+b+(a!=1?"s":"")+" ago"}var b=require("./pad").pad;return a=Math.max(0,(+(new Date)- +a-b.clientTimeOffset)/1e3),a<60?c(a,"second"):(a/=60,a<60?c(a,"minute"):(a/=60,a<24?c(a,"hour"):(a/=24,c(a,"day"))))},makeAnimationScheduler:function(a,b,c){function e(){d||(d=window.setTimeout(function(){d=null;var b=c,f=!0;while(f&&b>0)f=a(),b--;f&&e()},b*c))}c===undefined&&(c=1);var d=null;return{scheduleAnimation:e}},makeShowHideAnimator:function(a,b,c,d){function i(){e=-1,a(e),h()}function j(){e<-1?e=-1:e<=0?e=e:e=Math.max(-1,Math.min(0,-e)),a(e),h()}function k(){e>=-1&&e<=0&&(e=1e-6,h())}function l(){if(e<-1||e==0)return!1;if(e<0)return e+=g,e>=0?(e=0,a(e),!1):(a(e),!0);if(e>0)return e+=g,e>=1?(e=1,a(e),e=-2,!1):(a(e),!0)}var e=b?0:-2,f=1e3/c,g=f/d,h=padutils.makeAnimationScheduler(l,f).scheduleAnimation;return{show:i,hide:k,quickShow:j}},_nextActionId:1,uncanceledActions:{},getCancellableAction:function(a,b){var c=padutils.uncanceledActions[a];c||(c={},padutils.uncanceledActions[a]=c);var d=padutils._nextActionId++;return c[d]=!0,function(){var c=padutils.uncanceledActions[a];c&&c[d]&&b()}},cancelActions:function(a){var b=padutils.uncanceledActions[a];b&&delete padutils.uncanceledActions[a]},makeFieldLabeledWhenEmpty:function(a,b){function c(){a.addClass("editempty"),a.val(b)}return a=$(a),a.focus(function(){a.hasClass("editempty")&&a.val(""),a.removeClass("editempty")}),a.blur(function(){a.val()||c()}),{clear:c}},getCheckbox:function(a){return $(a).is(":checked")},setCheckbox:function(a,b){b?$(a).attr("checked","checked"):$(a).removeAttr("checked")},bindCheckboxChange:function(a,b){$(a).bind("click change",b)},encodeUserId:function(a){return a.replace(/[^a-y0-9]/g,function(a){return a=="."?"-":"z"+a.charCodeAt(0)+"z"})},decodeUserId:function(a){return a.replace(/[a-y0-9]+|-|z.+?z/g,function(a){return a=="-"?".":a.charAt(0)=="z"?String.fromCharCode(Number(a.slice(1,-1))):a})}},globalExceptionHandler=undefined;padutils.setupGlobalExceptionHandler=setupGlobalExceptionHandler,padutils.binarySearch=require("./ace2_common").binarySearch,exports.randomString=randomString,exports.createCookie=createCookie,exports.readCookie=readCookie,exports.padutils=padutils
}
, "ep_etherpad-lite/static/js/pad_cookie.js": function (require, exports, module) {
var padcookie=function(){function a(){if(!document.cookie)return null;var a=document.cookie.match(/(?:^|;)\s*prefs=([^;]*)(?:;|$)/);return!a||!a[1]?null:a[1]}function b(a){var b=new Date;b.setFullYear(3e3),document.cookie="prefs="+a+";expires="+b.toGMTString()}function c(a){try{var b=JSON.parse(unescape(a));return b}catch(c){return null}}function d(a){return escape(JSON.stringify(a))}function e(){if(!i)return;b(d(g)),j.getIsProPad()&&!a()&&!h&&(alert("Warning: it appears that your browser does not have cookies enabled. EtherPad uses cookies to keep track of unique users for the purpose of putting a quota on the number of active users.  Using EtherPad without  cookies may fill up your server's user quota faster than expected."),h=!0)}var f=!0,g={},h=!1,i=!1,j=undefined,k={init:function(b,d){j=d;var h=a();if(h){var k=c(h);k&&(f=!1,delete k.userId,delete k.name,delete k.color,g=k)}for(var l in b)g[l]=b[l];i=!0,e()},wasNoCookie:function(){return f},getPref:function(a){return g[a]},setPref:function(a,b){g[a]=b,e()}};return k}();exports.padcookie=padcookie
}
, "ep_etherpad-lite/static/js/Observable.js": function (require, exports, module) {
var makeObservable=function(a){a.listeners=[],a.on=function(a,b,c){return this.listeners||(this.listeners=[]),a&&b?(this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push({func:b,scope:c||this}),!0):!1},a.un=function(a,b){if(!this.listeners)return this.listeners=[],!1;if(a&&this.listeners[a]){for(var c=0,d;d=this.listeners[a][c];c++)if(d.func===b){this.listeners[a].splice(c,1);break}this.listeners[a].length||delete this.listeners[a]}return!1},a.fireEvent=function(a){if(!this.listeners)return this.listeners=[],!1;if(a&&this.listeners&&this.listeners[a]){var b=Array.prototype.slice.call(arguments,1);for(var c=0,d;d=this.listeners[a][c];c++)d.func.apply(d.scope,b)}},a.destroyListeners=function(){delete this.listeners}};exports.makeObservable=makeObservable
}
, "ep_etherpad-lite/static/js/BackOff.js": function (require, exports, module) {
var BackOff=function(a,b,c){this._minDelay=a,this._maxDelay=b,this.onBackOff=c,this._delay=0,this._retry=0,this._timeoutId=-1};BackOff.prototype.start=function(){this._schedule()},BackOff.prototype.stop=function(){this._timeoutId!=-1&&(clearTimeout(this._timeoutId),this._timeoutId=-1,this._delay=0,this._retry=0)},BackOff.prototype._onBackOff=function(){this._retry++,this.onBackOff(this._retry,this._delay)},BackOff.prototype._schedule=function(){this._nextDelay();var a=this;this._timeoutId=setTimeout(function(){a._onBackOff()},this._delay)},BackOff.prototype._nextDelay=function(){this._delay==0?this._delay=this._minDelay:this._delay*=2;var a=1+Math.random()*.3;this._delay=Math.round(this._delay*a),this._delay=Math.min(this._delay,this._maxDelay)},exports.BackOff=BackOff
}
, "ep_etherpad-lite/static/js/pad_editor.js": function (require, exports, module) {
var padcookie=require("./pad_cookie").padcookie,padutils=require("./pad_utils").padutils,makeObservable=require("./Observable").makeObservable,padeditor=function(){var a=undefined,b=undefined,c=undefined,d={ace:null,viewZoom:100,init:function(e,f,g){function i(){function f(a){var b=window.__aceWindow.getBoundingClientRect(),c=a.clientX+b.left,d=a.clientY+b.top;if(typeof Event=="function")var e=new MouseEvent(a.type,{bubbles:a.bubbles,cancelable:a.cancelable,clientX:c,clientY:d});else{var e=document.createEvent("MouseEvent");e.initMouseEvent(a.type,!0,!0,window.__aceWindow,0,0,0,c,d,!1,!1,!1,!1,0,null)}document.body.dispatchEvent(e)}$("#"+b.idSettings.editorloadingbox).css("visibility","hidden"),e&&e();var a=d.ace.getFrame(),c=a.contentWindow.document.getElementsByTagName("iframe")[0].contentWindow;window.__aceBody=c.document.body,window.__aceWindow=a,window.__aceDocument=d.ace.getDocument().body,window.__aceBody.addEventListener("mousedown",f),window.__aceBody.addEventListener("mousewheel",f),window.__aceBody.addEventListener("mouseup",f),window.__aceBody.addEventListener("mousemove",f),h.fireEvent("ace.ready")}a=require("./ace").Ace2Editor,b=g,c=b.settings;var h=this;d.ace=new a,g.isMobile&&d.ace.setIsMobile(),d.fireEvent("ace.beforeinit",d.ace),d.ace.init(b.editorContainerId||b.idSettings.editorcontainer,"",g.scriptsVersion,g.baseURL,i),d.ace.setProperty("wraps",!0),b.getIsDebugEnabled()&&d.ace.setProperty("dmesg",b.dmesg),d.initViewOptions(),d.setViewOptions(f),$("#viewbarcontents").show(),d.initialized=!0},initViewOptions:function(){padutils.bindCheckboxChange($("#options-linenoscheck"),function(){b.changeViewOption("showLineNumbers",padutils.getCheckbox($("#options-linenoscheck")))}),padutils.bindCheckboxChange($("#options-colorscheck"),function(){padcookie.setPref("showAuthorshipColors",padutils.getCheckbox("#options-colorscheck")),b.changeViewOption("showAuthorColors",padutils.getCheckbox("#options-colorscheck"))}),$("#viewfontmenu").change(function(){b.changeViewOption("useMonospaceFont",$("#viewfontmenu").val()=="monospace")})},setViewOptions:function(a){function b(b,c){var d=String(a[b]);return d=="true"?!0:d=="false"?!1:c}d.ace.setProperty("rtlIsTrue",c.rtlIsTrue);var e;e=b("showAuthorColors",!0),d.ace.setProperty("showsauthorcolors",e),padutils.setCheckbox($("#options-colorscheck"),e),c.noColors!==!1&&d.ace.setProperty("showsauthorcolors",!c.noColors),e=b("useMonospaceFont",!1),d.ace.setProperty("textface",e?"monospace":"Arial, sans-serif"),$("#viewfontmenu").val(e?"monospace":"normal")},dispose:function(){b&&b.idSettings&&$("#"+b.idSettings.editorloadingbox).show(),d.ace&&(d.ace.destroy(),d.ace=null),d.destroyListeners(),d.initialized=!1},disable:function(a,c){d.ace&&(b.fireEvent("padeditor.disable",a),!c&&d.ace.setProperty("grayedOut",!0),d.ace.setEditable(!1))},enable:function(){d.ace&&(b.fireEvent("padeditor.enable"),d.ace.setProperty("grayedOut",!1),d.ace.setEditable(!0))},clearPadText:function(){d.ace&&d.ace.clearText()},getAuthorName:function(a){return""},restoreRevisionText:function(a){b.addHistoricalAuthors(a.historicalAuthorData),d.ace.importAText(a.atext,a.apool,!0)}};return makeObservable(d),d}();exports.padeditor=padeditor
}
, "ep_etherpad-lite/static/js/pad_cursorhandler.js": function (require, exports, module) {
window.unwrap||(window.unwrap=function(a){return a});var CursorHandler=function(){function f(a,d){if(b[a])return b[a];var f=window.unwrap(document.createElement("span")),g=window.unwrap(document.createElement("span"));return f.className="ace-cursor",f.style.borderColor=d.color,f.id=a,f.setAttribute("rel",d.userId),g.innerHTML=e.getAuthorName(d.userId),g.style.backgroundColor=d.color,g.className="cursor-inactive",f.appendChild(g),c.appendChild(f),b[a]={cursor:f,author:g,authorHideTimeout:null,inactiveTimeout:null},b[a]}function g(b){if(!c||!d)return;var g=b.pos,i=b.id,j=a[i];if(g&&g[0]&&j&&j.userId&&j.color){var k=f(i,j),l=k.cursor;if(g[0]=="BLUR"){l.style.display="none";return}if(g[0]=="LEAVE"){h(i);return}if(!g[1])return;var m=g[0],n=e.ace.getPointForLineAndChar(m),o=d.createRange(),p;m[1]==0&&n.node.firstChild?p={0:{top:n.node.firstChild.offsetTop,left:n.node.firstChild.offsetLeft}}:(o.setStart(n.node,n.index),o.setEnd(n.node,n.index),p=o.getClientRects());if(!p||!p[0]||p[0].top==0&&p[0].left==0)l.style.display="none";else{clearTimeout(k.authorHideTimeout),clearTimeout(k.inactiveTimeout),k.cursor.style.display="block",k.author.className=(k.author.className||"").replace("cursor-inactive","cursor-active"),k.authorHideTimeout=setTimeout(function(){k.author.className=(k.author.className||"").replace("cursor-active","cursor-inactive")},1500),k.inactiveTimeout=setTimeout(function(){k.cursor.style.display="none"},18e4);var q=$(n.node).parent().css("font-size"),r=p[0].top,s=parseInt(q)+2;r<13?k.cursor.className+=" bottom":k.cursor.className=(k.cursor.className||"").replace(/bottom/ig,""),l.style.height=s+"px",l.style.display="block",l.style.top=r+"px",l.style.left=p[0].left-1+"px"}}}function h(a){b[a]&&(b[a].cursor.parentNode.removeChild(b[a].cursor),delete b[a])}var a={},b={},c,d,e;this.clearCursors=function(){if(b){for(var a in b){var c=b[a];c&&c.cursor&&c.cursor.parentNode&&c.cursor.parentNode.removeChild(c.cursor)}b={}}},this.init=function(b){var f=this;this.clearCursors(),e=b,c=null,document.createRange&&b&&(b.on("ace.ready",function(){c=e.ace.getFrame().contentDocument.body,d=e.ace.getDocument()}),b.on("new.cursor",function(a){a.pos&&a.id&&g(a)}),b.on("user.leave",function(a){var b=a.userId;h(b)}),b.on("new.user",function(b){var c;b.userId&&(a[b.id]={userId:b.userId,color:b.color},g(b))}),b.on("reconnect",function(){f.clearCursors()}))}};exports.CursorHandler=CursorHandler
}
, "ep_etherpad-lite/static/js/pad_editbar.js": function (require, exports, module) {
function indexOf(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return c;return-1}var padutils=require("./pad_utils").padutils,padeditor=require("./pad_editor").padeditor,padeditbar=function(){var a,b=function(){var b=-100,c=100,d=c,e=25,f=1/e,g=-0.5,h=1,i=1.5,j=padutils.makeAnimationScheduler(function(){return d==b||d==c?!1:d>=i?(d=c,$("#"+a.idSettings.syncstatussyncing).css("display","none"),$("#"+a.idSettings.syncstatusdone).css("display","none"),a.fireEvent("state.sync.done"),!1):d<0?(d+=f,d>=0&&($("#"+a.idSettings.syncstatussyncing).css("display","none"),$("#"+a.idSettings.syncstatusdone).css("display","block").css("opacity",1),a.fireEvent("state.sync.ready")),!0):(d+=f,d>=h&&$("#"+a.idSettings.syncstatusdone).css("opacity",(i-d)/(i-h)),!0)},f*1e3);return{syncing:function(){d=b,$("#"+a.idSettings.syncstatussyncing).css("display","block"),$("#"+a.idSettings.syncstatusdone).css("display","none"),a.fireEvent("state.sync.syncing")},done:function(){d=g,j.scheduleAnimation()}}}(),c={init:function(b){var c=this;a=b,$("#"+a.idSettings.editbar+" .editbarbutton").attr("unselectable","on"),$("#"+a.idSettings.editbar).removeClass("disabledtoolbar").addClass("enabledtoolbar"),$("#"+a.idSettings.editbar+" [data-key]").each(function(a,b){$(b).click(function(a){c.toolbarClick($(b).attr("data-key")),a.preventDefault()})}),this.initialized=!0},isEnabled:function(){return!0},disable:function(){},toolbarClick:function(a,b){c.isEnabled()&&(a=="showusers"?c.toogleDropDown("users"):a=="settings"?c.toogleDropDown("settings"):a=="embed"?(c.setEmbedLinks(),$("#linkinput").focus().select(),c.toogleDropDown("embed")):a=="import_export"?c.toogleDropDown("importexport"):a!="savedRevision"&&padeditor.ace.callWithAce(function(c){var d=!!navigator.userAgent.match(/(webkit)[ \/]([\w.]+)/i),e=d;a=="bold"||a=="italic"||a=="underline"||a=="strikethrough"?c.ace_toggleAttributeOnSelection(a,b):a=="undo"||a=="redo"?c.ace_doUndoRedo(a):a=="insertunorderedlist"?c.ace_doInsertUnorderedList():a=="insertorderedlist"?c.ace_doInsertOrderedList():a=="indent"?c.ace_doIndentOutdent(!1)||c.ace_doInsertUnorderedList():a=="outdent"?c.ace_doIndentOutdent(!0):a=="link"&&(e=!1),e&&c.ace_focus()},a,!0)),padeditor.ace&&padeditor.ace.focus()},toogleDropDown:function(a){var b=["settings","importexport","embed","users"];if(a=="none")for(var c=0;c<b.length;c++){if(b[c]=="users")continue;var d=$("#"+b[c]);d.css("display")!="none"&&($("#"+b[c]+"link").removeClass("selected"),d.slideUp("fast"))}else for(var c=0;c<b.length;c++){var d=$("#"+b[c]);d.css("display")!="none"?($("#"+b[c]+"link").removeClass("selected"),d.slideUp("fast")):b[c]==a&&($("#"+b[c]+"link").addClass("selected"),d.slideDown("fast"))}},setSyncStatus:function(a){a=="syncing"?b.syncing():a=="done"&&b.done()},setReconnectingStatus:function(c,d){if(!this.initialized)return;d?(b.done(),$("#"+a.idSettings.reconnectstatus).css("display","block").find("span").html(c),a.fireEvent("state.sync.reconnecting")):($("#"+a.idSettings.reconnectstatus).hide(),a.fireEvent("state.sync.reconnectingDone"))},setEmbedLinks:function(){if($("#readonlyinput").is(":checked")){var a=document.location.href.substring(0,document.location.href.indexOf("/p/")),b=a+"/p/"+clientVars.readOnlyId;$("#embedinput").val("<iframe name='embed_readonly' src='"+b+"?showControls=true&showChat=true&showLineNumbers=true&useMonospaceFont=false' width=600 height=400>"),$("#linkinput").val(b)}else{var c=window.location.href.split("?")[0];$("#embedinput").val("<iframe name='embed_readwrite' src='"+c+"?showControls=true&showChat=true&showLineNumbers=true&useMonospaceFont=false' width=600 height=400>"),$("#linkinput").val(c)}}};return c}();exports.padeditbar=padeditbar
}
, "ep_etherpad-lite/static/js/ace.js": function (require, exports, module) {
function Ace2Editor(){function g(a,b){return function(){var c=this,d=arguments,g=function(){return a.apply(c,d)};b&&b.apply(c,d);if(e)return g();f.push(g)}}function h(){_.each(f,function(a,b){a()}),f=[]}function j(a){var b=[],c=[];if(Ace2Editor.EMBEDED)for(var d=0,e=a.length;d<e;d++){var f=a[d];Object.prototype.hasOwnProperty.call(Ace2Editor.EMBEDED,f)?b.push(f):c.push(f)}else c=a;return{embeded:b,remote:c}}function k(a){a.push('<script type="text/javascript">var LE_ETHERPAD_FILES = '+JSON.stringify(b)+"</script>");var c=b.le_ace_bundle_js;a.push('<script type="text/javascript" src="'+c+'"></script>')}function l(a,b){var c=j(b),d=c.embeded,e=c.remote;if(d.length>0){a.push('<style type="text/css">');for(var f=0,g=d.length;f<g;f++){var h=d[f];a.push(Ace2Editor.EMBEDED[h].replace(/<\//g,"<\\/"))}a.push("</style>")}for(var f=0,g=e.length;f<g;f++){var h=e[f];a.push('<link rel="stylesheet" type="text/css" href="'+h+'"/>')}}function m(a){var b=/iPad|iPhone|iPod/.test(navigator.userAgent);b&&(a.style["-webkit-overflow-scrolling"]="touch",a.style["overflow-y"]="auto");var c=a.style.height,d=!c||["auto","inherit","initial","unset"].indexOf(c)==-1;d&&console.warn("LE editor container is missing height attribute - this may cause iframe scroll issue in iOS Safari.")}var a=Ace2Editor,b,c={};makeObservable(c);var d={editor:c,isMobile:!1,isAddin:!1,isDartWidget:!1,id:a.registry.nextId++,eventListener:function(a){c.fireEvent.apply(c,arguments)}},e=!1,f=[];a.registry[d.id]=d;var i=["importText","importAText","focus","setEditable","getFormattedCode","setOnKeyPress","setOnKeyDown","setNotifyDirty","setProperty","setBaseText","setBaseAttributedText","clearText","updateChangeSetTracker","applyChangesToBase","applyPreparedChangesetToBase","setHeight","markNodeClean","insertWidget","pasteHtmlAtCaret","setUserChangeNotificationCallback","setAuthorInfo","getDocument","handleCursorPosition","doTabKey","getPointForLineAndChar","setAuthorSelectionRange","callWithAce","execCommand","replaceRange","getSelection","setSelection","getRep","getLineAndCharForPoint","applyAttributesToRange","performDocumentApplyAttributesToCharRange","editorChangedSize","setEditBodyPadding"];return _.each(i,function(a,b){var e="ace_",f=e+a;c[a]=g(function(){return d[e+a].apply(this,arguments)})}),c.exportText=function(){return e?d.ace_exportText():"(awaiting init)\n"},c.getFrame=function(){return d.frame||null},c.getDebugProperty=function(a){return d.ace_getDebugProperty(a)},c.prepareUserChangeset=function(){return!e||!d?null:d.ace_prepareUserChangeset()},c.getUnhandledErrors=function(){return e?d.ace_getUnhandledErrors():[]},c.destroy=g(function(){c.destroyListeners(),d.ace_dispose(),d.frame.parentNode.removeChild(d.frame),delete a.registry[d.id],d=null}),c.setIsMobile=function(){d.isMobile=!0},c.setIsAddin=function(a){d.isAddin=a},c.setIsDartWidget=function(a){d.isDartWidget=a},c.setBodyAdditionalClass=function(a){bodyAdditionalClass=a},c.getBodyAdditionalClass=function(){return bodyAdditionalClass},c.setOuterBodyAdditionalClass=function(a){outerBodyAdditionalClass=a},c.getOuterBodyAdditionalClass=function(){return outerBodyAdditionalClass},c.setWidgetAdditionalClass=function(a){widgetAdditionalClass=a},c.getWidgetAdditionalClass=function(){return widgetAdditionalClass},c.getScriptsVersion=function(){return scriptsVersion},c.setSize=function(a,b){var c=this.getFrame();c&&(a&&(c.style.width=a+"px"),b&&(c.style.height=b+"px"),b&&d.ace_setHeight(b))},c._initFilesPaths=function(a){b=window.LE_ETHERPAD_FILES;if(!b)throw new Error("LE_ETHERPAD_FILES must be defined in global scope!")},c.init=function(a,f,g,i,j){baseURL=i,scriptsVersion=g,c._initFilesPaths(baseURL),c.importText(f),d.onEditorReady=function(){e=!0,h(),j()},function(){var c="<!doctype html>",e=[];e.push(c),e.push("<html><head>");var f=[];b.le_styles?(d.isMobile&&f.push(b.le_styles_mobile),f.push(b.le_styles)):window.console.warn("No LE styles declared in LE_ETHERPAD_FILES section"),f.push("https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i,700,700i,800,800i&subset=cyrillic,greek"),l(e,f),k(e),e.push('<script type="text/javascript">window.onload = function(){  window.__etherpadLegacy.require.setRootURI("'+baseURL+'javascripts/src");\n  window.__etherpadLegacy.require.setLibraryURI("'+baseURL+'javascripts/lib");\n  window.__etherpadLegacy.require.setGlobalKeyPath("require");\n  window.__jqueryFactory = window.parent.__jqueryFactory;\n  window.parent.__injectJQuery(window);\n  parent_req = window.__etherpadLegacy.require("ep_etherpad-lite/static/js/pluginfw/parent_require");  parent_req.getRequirementFromParent(window.__etherpadLegacy.require, "ep_etherpad-lite/static/js/pluginfw/hooks");  parent_req.getRequirementFromParent(window.__etherpadLegacy.require, "ep_etherpad-lite/static/js/pluginfw/plugins");  window.__etherpadLegacy.require("ep_etherpad-lite/static/js/ace2_inner");}</script>'),e.push('<style type="text/css" title="dynamicsyntax"></style>'),hooks.callAll("aceInitInnerdocbodyHead",{iframeHTML:e}),e.push('</head><body id="innerdocbody" class="syntax '+bodyAdditionalClass+'" spellcheck="true">'+(d.isMobile?'<div id="mobile-wrapper"></div>':"&nbsp;")+"</body></html>");var g="ChildAccessibleAce2Editor";(function(){return this})()[g]=Ace2Editor;var h='window.parent.__injectJQuery(window);       editorId = "'+d.id+'";       editorInfo = parent.'+g+".registry[editorId];       window.onload = function() "+"{         window.onload = null;         setTimeout"+"(function() "+'{           var iframe = document.createElement("IFRAME");           iframe.className = "ace-inner-iframe";           iframe.name = "ace_inner";           iframe.scrolling = "no";           var outerdocbody = document.getElementById("outerdocbody");           iframe.frameBorder = 0;           iframe.allowTransparency = true; '+"editorInfo.ace_outerWin = window;           outerdocbody.insertBefore(iframe, outerdocbody.firstChild);           readyFunc = function() {             editorInfo.onEditorReady();             readyFunc = null;             editorInfo = null;           };           var doc = iframe.contentWindow.document;           doc.open();           var text = ("+JSON.stringify(e.join("\n"))+");           doc.write(text);           doc.close();        }, 0);       }",i=[c,"<html><head>"];l(i,f),i.push('<link rel="stylesheet" type="text/css" href="data:text/css,"/>',"<script>\n",h.replace(/<\//g,"<\\/"),"\n</script>",'</head><body id="outerdocbody"'+(outerBodyAdditionalClass?' class="'+outerBodyAdditionalClass+'"':"")+'><div id="sidediv"><!-- --></div><div id="linemetricsdiv">x</div><div id="overlaysdiv"><!-- --></div></body></html>');var j=document.createElement("IFRAME");j.name="ace_outer",j.frameBorder=0,j.style.height="10px",d.frame=j;var n=document.getElementById(a);n.appendChild(j),m(n),j.style.width="100%";var o=j.contentWindow.document;o.open(),o.write(i.join("")),o.close()}()},c}Ace2Editor.registry={nextId:1};var hooks=require("./pluginfw/hooks"),_=require("./underscore"),makeObservable=require("./Observable").makeObservable,baseURL="",scriptsVersion="",bodyAdditionalClass="",outerBodyAdditionalClass="",widgetAdditionalClass="";exports.Ace2Editor=Ace2Editor
}
, "ep_etherpad-lite/static/js/collab_client.js": function (require, exports, module) {
function getSocket(){return pad&&pad.connection}function stringHashCode(a){var b=0;if(!a)return b;var c;for(var d=0;d<a.length;d++)c=a.charCodeAt(d),b=(b<<5)-b+c,b&=b;return b}function getUserColor(a){var b=Math.abs(stringHashCode(a))%colorPalette.length;return colorPalette[b]}function getCollabClient(a,b,c,d,e){function A(a){typeof window.ajlog=="string"&&(window.ajlog+=a+"\n"),v.push(a)}function B(){return g}function C(a){z=!1;if(y)return;if(!getSocket()||k=="CONNECTING"){k=="CONNECTING"&&+(new Date)-n>2e5?T("DISCONNECTED","initsocketfail"):x.push(setTimeout(G("setTimeout(handleUserChanges)",C),1e3));return}var b=+(new Date);if(h!="IDLE"){h=="COMMITTING"&&b-m>2e5?T("DISCONNECTED","slowcommit"):h=="COMMITTING"&&b-m>5e3?w.onConnectionTrouble("SLOW"):x.push(setTimeout(G("setTimeout(handleUserChanges)",C),3e3));return}if(!a){var c=m+500;if(b<c){x.push(setTimeout(G("setTimeout(handleUserChanges)",C),c-b));return}}var d=!1,e=f.prepareUserChangeset();if(e&&e.changeset){var l;e.apool&&e.apool.numToAttrib&&e.apool.nextNum&&(l={a:e.apool.numToAttrib,n:e.apool.nextNum}),l||(l=e.apool),m=b,h="COMMITTING",i={t:"c_changes",br:g,c:e.changeset,a:l},j=p;var o;(o=f.getRep())&&o.selStart&&o.selEnd&&(clearTimeout(L),M=f.focused?[o.selStart,o.selEnd]:["BLUR"],i.pos=M),F(i),d=!0,w.onInternalAction("commitPerformed")}z=!0,d&&x.push(setTimeout(G("setTimeout(handleUserChanges)",C),3e3))}function D(){E=0,T("CONNECTED"),Y(),n=+(new Date)}function F(a){a&&(a.task_id=pad&&pad.clientVars&&(pad.clientVars.task_id||pad.clientVars.padId));var b="live_editor",c=getSocket(),d=typeof c._multidomainsFallbackDone=="undefined"?"erlang":"legacy";c.send(JSON.stringify(a),b)}function G(a,b){return function(){try{return b.apply(this,Array.prototype.slice.call(arguments))}catch(c){throw s.push(c),t.push(a),u.push(+(new Date)),c}}}function H(a,b){try{G(a,b)()}catch(c){}}function I(b){var c=b.id;q[c]||(q[c]=b,b.userId=c,b.color=getUserColor(c),w.onUserJoin(b),O(b),a.fireEvent("new.user",b))}function J(b){if(!getSocket())return;if(b.t=="reconnect_ok"){setTimeout(function(){y=!1,bb(),C(),a.fireEvent("reconnect")},2e3);return}if(b.t=="n_changes"){var c=b.rev,d=b.c,h=b.au||"",i=b.a;y=!1;if(c!=g+1){A("bad message revision on NEW_CHANGES: "+c+" not "+(g+1)),T("DISCONNECTED","badmessage_newchanges");return}g=c,f.applyChangesToBase(d,h,i),b.pos&&b.id&&(I(b),a.fireEvent("new.cursor",b)),e.fireEvent("new.changes",c,b)}else if(b.t=="accept"){var c=b.rev;if(c!=g+1){A("bad message revision on ACCEPT_COMMIT: "+c+" not "+(g+1)),T("DISCONNECTED","badmessage_acceptcommit");return}y=!1,g=c,f.applyPreparedChangesetToBase(),bb(),H("onInternalAction",function(){w.onInternalAction("commitAcceptedByServer")}),H("onConnectionTrouble",function(){w.onConnectionTrouble("OK")}),C(),e.fireEvent("accept.changes",c,b)}else b.t=="cursor"&&(I(b),a.fireEvent("new.cursor",b));w.onServerMessage(b)}function K(a){a.userId=o,q[o]=a,O(a);if(!getSocket())return;F({t:"user_update",info:a})}function N(a){if(!z||!getSocket()||!a||!a[0]||!f.focused)return;clearTimeout(L),M=a,L=setTimeout(function(){pad.collabClient&&F({t:"cursor",br:pad.collabClient.getRevision(),pos:a})},300)}function O(a){P(a.userId,a.color)}function P(a,b,c){var d=b;c?f.setAuthorInfo(a,{bgcolor:d,fade:.5}):f.setAuthorInfo(a,{bgcolor:d})}function Q(a){P(a.userId,a.color,!0)}function R(){return V(q)}function S(a){for(var b in a){var c=a[b];q[b]||P(b,c.color,!0)}}function T(a,b){if(a!=k){if(a=="RECONNECTING"||a=="DISCONNECTED")y=!0;k=a,w.onChannelStateChange(k,b)}}function U(a){var b=[];return $.each(a,function(a,c){b.push(a)}),b}function V(a){var b=[];return $.each(a,function(a,c){b.push(c)}),b}function X(a,b){return function(){function e(){a.apply(c,d)}var c=this,d=arguments;e.tag=b,k=="CONNECTING"?W.push(e):e()}}function Y(a){var b=[];for(var c=0;c<W.length;c++){var d=W[c];!a||a==d.tag?d():b.push(d)}W=b}function Z(a){F({t:"message",msg:a})}function _(){return g}function ba(){var a={};a.userInfo=q[o],a.baseRev=g,h=="COMMITTING"&&i&&(a.committedChangeset=i.changeset,a.committedChangesetAPool=i.apool,a.committedChangesetSocketId=j,f.applyPreparedChangesetToBase());var b=f.prepareUserChangeset();return b.changeset&&(a.furtherChangeset=b.changeset,a.furtherChangesetAPool=b.apool),a}function bb(){h="IDLE",w.onInternalAction("newlyIdle"),be()}function bc(a){bd.push(a),be()}function be(){setTimeout(function(){if(h=="IDLE")while(bd.length>0){var a=bd.shift();a()}},0)}var f=a.ace;pad=e;var g=b.rev,h="IDLE",i,j,k="CONNECTING",l=null,m=0,n=0,o=c.userId,p,q={};q[o]=c;var r=[],s=[],t=[],u=[],v=[];document.createRange&&!f.collabClientHandling&&(f.on("cursor.change",function(a,b,c,d){var e=a===null?null:[a,b],f=c===null?null:[c,d];N([e,f])}),f.on("blur",function(){N(["BLUR"]),f.focused=!1}),f.on("focus",function(){f.focused=!0}),f.collabClientHandling=!0),S(b.historicalAuthorData),O(c);var w={onUserJoin:function(){},onUserLeave:function(){},onUpdateUserInfo:function(){},onChannelStateChange:function(){},onClientMessage:function(){},onInternalAction:function(){},onConnectionTrouble:function(){},onServerMessage:function(){}};f.updateChangeSetTracker(),f.setProperty("userAuthor",o),f.setBaseAttributedText(b.initialAttributedText,b.apool),f.setUserChangeNotificationCallback(G("handleUserChanges",C));var x=[],y=!1,z=!0,E=0,L,M,W=[],bd=[],bf={setOnUserJoin:function(a){w.onUserJoin=a},setOnUserLeave:function(a){w.onUserLeave=a},setOnUpdateUserInfo:function(a){w.onUpdateUserInfo=a},setOnChannelStateChange:function(a){w.onChannelStateChange=a},setOnClientMessage:function(a){w.onClientMessage=a},setOnInternalAction:function(a){w.onInternalAction=a},setOnConnectionTrouble:function(a){w.onConnectionTrouble=a},setOnServerMessage:function(a){w.onServerMessage=a},clearTimeouts:function(){if(x&&x.length){for(var a=0,b=x.length;a<b;a++)clearTimeout(x[a]);x=[]}},updateUserInfo:X(K),handleUserChanges:C,handleMessageFromServer:J,getConnectedUsers:R,sendClientMessage:Z,sendMessage:F,getCurrentRevisionNumber:_,getMissedChanges:ba,callWhenNotCommitting:bc,addHistoricalAuthors:S,setChannelState:T,handleCursorChange:N,getRevision:B};return D(),bf}var pad=undefined,colorPalette=["#ffc7c7","#fff1c7","#e3ffc7","#c7ffd5","#c7ffff","#c7d5ff","#e3c7ff","#ffc7f1","#ff8f8f","#ffe38f","#c7ff8f","#8fffab","#8fffff","#8fabff","#c78fff","#ff8fe3","#d97979","#d9c179","#a9d979","#79d991","#79d9d9","#7991d9","#a979d9","#d979c1","#d9a9a9","#d9cda9","#c1d9a9","#a9d9b5","#a9d9d9","#a9b5d9","#c1a9d9","#d9a9cd","#4c9c82","#12d1ad","#2d8e80","#7485c3","#a091c7","#3185ab","#6818b4","#e6e76d","#a42c64","#f386e5","#4ecc0c","#c0c236","#693224","#b5de6a","#9b88fd","#358f9b","#496d2f","#e267fe","#d23056","#1a1a64","#5aa335","#d722bb","#86dc6c","#b5a714","#955b6a","#9f2985","#4b81c8","#3d6a5b","#434e16","#d16084","#af6a0e","#8c8bd8"];exports.getCollabClient=getCollabClient,exports.getUserColor=getUserColor
}
, "ep_etherpad-lite/static/js/connection.js": function (require, exports, module) {
var makeObservable=require("./Observable").makeObservable,Connection=function(a){makeObservable(this),a=a||{},this.autoReconnect=!!a.autoReconnect,this.pingUrl=a.pingUrl||"/ledit/ping",this.pingTimeout=a.pingTimeout||5e3,this.transportParams=a.transportParams||{},this.messageHandlers=[],this.pingCount=0};Connection.prototype.connect=function(){console.log("live notifier :: connection",this.transportParams);if(!(!this.socket||this.socket.readyState!="open"&&this.socket.readyState!="opening")){console.log("live notifier :: trying to connect but socket is ",this.socket.readyState),this.onConnect();return}this.disconnect(),delete this.closeFromDisconnect,clearTimeout(this.pinger),clearTimeout(this.finalDisconnectTimeout);if(this.socket){this.socket.open();return}this.socket=new eio.Socket(this.transportParams),this.socket.on("open",this.onConnect.bind(this)),this.socket.on("message",this.onMessage.bind(this)),this.socket.on("error",this.onError.bind(this)),this.socket.on("close",this.onClose.bind(this))},Connection.prototype.reconnect=function(){},Connection.prototype.disconnect=function(){if(this.socket)try{this.closeFromDisconnect=!0,this.socket.close();if(this.socket.transport&&this.socket.transport.pollXhr){var a=this.socket;this.finalDisconnectTimeout=setTimeout(function(){a.transport.pollXhr.abort()},100)}}catch(b){console.log(b)}},Connection.prototype.ping=function(){function c(){b&&b.abort(),a.pingCount++,a.fireEvent("reconnecting",a.pingCount),console.log("live notifier :: pinging ",a.pingTimeout,a.pingCount),b=$.get(a.pingUrl,function(b){a.pingCount=0,a.pinging=!1,a.connect()}),clearTimeout(a.pinger),a.pinger=c.defer(a.pingCount>3?a.pingTimeout*2:a.pingTimeout)}if(!this.socket||this.pinging)return;console.log("live notifier :: ping start");var a=this,b;this.pinging=!0,a.pinger=c.defer(a.pingTimeout,a)},Connection.prototype.send=function(a){console.log("live notifier :: sending data",a),this.socket&&this.socket.send(a)},Connection.prototype.onConnect=function(){console.log("live notifier :: connected",arguments),this.pingCount=0,this.pinging=!1,this.fireEvent("open",arguments)},Connection.prototype.onError=function(a){console.log("live notifier :: error",a),!this.autoReconnect},Connection.prototype.onMessage=function(a){try{a=$.parseJSON(a)}catch(b){console.error("json decode error",b)}console.log("live notifier :: got message",a);for(var c=0,d;d=this.messageHandlers[c++];)d.fn.call(d.scope||null,a||{})},Connection.prototype.onClose=function(){console.log("live notifier :: disconnect"),this.fireEvent("close",arguments),this.autoReconnect&&!this.closeFromDisconnect&&this.ping(),delete this.closeFromDisconnect},Connection.prototype.isConnected=function(){return this.socket&&this.socket.readyState=="open"},Connection.prototype.isClosed=function(){return this.socket&&this.socket.readyState=="closed"},Connection.prototype.addMessageHandler=function(a,b){this.messageHandlers.push({fn:a,scope:b})},exports.Connection=Connection
}
, "ep_etherpad-lite/static/js/widget.js": function (require, exports, module) {
var isClient=typeof global!="object",padeditor=require("ep_etherpad-lite/static/js/pad_editor").padeditor,Widget=function(a,b){this.ace=a,b=b||{},this.id="liveeditor-widget-"+Widget.ids++,this.url=b.url,this.domline=b.domline,this.checkAttribs=b.checkAttribs||function(){return!1},this.initialData=b.initialData;var c=this;this.domline.widgetDomline=!0,this.domline.node.setAttribute("contenteditable",!1),this.domline.lineMarker=1,this.domline.appendData=function(a){return!a||!a.numToAttrib||!a.numToAttrib[0]?!1:(this.node.frameWindow.appendData(a.numToAttrib),!0)},this.domline.notifyAdded=function(){var d=!1,e=c.domline.node.getElementsByTagName("iframe")[0];(function f(){if(!e||!e.contentWindow){setTimeout(f,100);return}if(!d)try{e.contentWindow.document.open(),e.contentWindow.document.write(c.generateWidgetContent()),e.contentWindow.document.close(),d=!0,setTimeout(f,100);return}catch(g){console.error(g)}if(!e.contentWindow.onWidgetLoaded){setTimeout(f,100);return}c.domline.node.iframe=e,c.domline.node.frameWindow=e.contentWindow,c.domline.node.frameWindow.widgetData={bodyAdditionalClass:padeditor.ace.getWidgetAdditionalClass(),initialState:b.initialData,isEditable:function(){return a.ace_isEditable()},applyChanges:function(a){c.applyChanges(a)}},c.domline.node.frameWindow.onWidgetLoaded()})()},this.domline.checkAttribs=function(a){return a&&a.numToAttrib&&a.numToAttrib[0]?c.checkAttribs(a.numToAttrib):!1},a.editor.on("editable.change",this.setEditable.bind(this))};Widget.prototype.setEditable=function(a){this.domline&&this.domline.node&&this.domline.node.frameWindow&&this.domline.node.frameWindow.widgetData&&this.domline.node.frameWindow.widgetData.setEditable&&this.domline.node.frameWindow.widgetData.setEditable(a)},Widget.prototype.applyChanges=function(a){if(!a||!a[0])return;var b=this.ace.ace_getLineAndCharForPoint({node:this.domline.node.iframe,index:1,maxIndex:1});this.ace.ace_applyAttributesToRange(b,[b[0],b[1]+1],a),this.ace.ace_markNodeClean(this.domline.node)},Widget.prototype.generateWidgetIFrame=function(a){return a=a||{},a.additionalCss=a.additionalCss||"",a.initialHeight=a.initialHeight||"10px",a.initialWidth=a.initialWidth||"100%",this.html='<iframe class="liveeditor-widget-frame '+a.additionalCss+'" frameborder="0" style="-webkit-user-select: none; height: '+a.initialHeight+"; width: "+a.initialWidth+';"></iframe>',this.html},Widget.prototype.generateWidgetContent=function(a){var b=LE_ETHERPAD_FILES,c=[b.jquery_handsontable_styles,"https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i,700,700i,800,800i&subset=cyrillic,greek"],d=[b.jquery_handsontable_code],e=["<!doctype html>","<html><head>"];e.push('<script type="text/javascript">window.parent.__injectJQuery(window);</script>');for(var f=0;f<c.length;f++)e.push('<link rel="stylesheet" media="screen" href="'+c[f]+'" />');for(var f=0;f<d.length;f++)e.push('<script type="text/javascript" src="'+d[f]+'"></script>');return e.push("</head>"),e.push('<body><div id="table" contenteditable="false"></div></body>'),e.push("</html>"),e.join("\n")},Widget.prototype.getDataForDomline=function(a){return{extraOpenTags:this.generateWidgetIFrame(a),extraCloseTags:"",cls:"ace-invisible ace-iframe-widget",hiddenSymbol:!0}},Widget.ids=0,exports.Widget=Widget
}
, "ep_links/static/js/links.js": function (require, exports, module) {
function handleKeyEvent(a){var b=a.which,c=this;this.ace_inCallStackIfNecessary("handleKeyEvent",function(){String.fromCharCode(b).toLowerCase()=="k"&&(a.metaKey||a.ctrlKey)&&(c.ace_fastIncorp(13),a.preventDefault(),padEditor.fireEvent("link.dialog"))})}function handleClick(a){var b=getLinkNode(a.target);if(b){var c=b.getAttribute("rel");c=c.substring(relHrefPrefix.length,c.length),(a.ctrlKey||a.metaKey)&&a.button!=2&&a.button!=3?openLink(c):showLinkBubble.call(this,b,c,a),a.preventDefault()}else hideLinkBubble()}function openLink(a){if(ace.isAddin){ace.eventListener.apply(ace,["link-open",a]);return}padEditor.fireEvent("link.open",a);try{var b=window.open();b.opener=null,b.location=a,b.focus()}catch(c){}}function showLinkBubble(a,b,c){var d="",e="";try{b=decodeURI(b)}catch(f){}d=b,b.length>50&&(e=b,d=b.substring(0,50)+"...");var g={href:b,linkTitle:e,visibleHref:d,Security:Security};linkBubble=linkBubble||{};var h=this.frame.contentDocument||this.frame.Document,i;ace.isDartWidget||!ace.ace_isEditable()?i=linkBubbleTplNoControls(g):i=linkBubbleTpl(g);if(!linkBubble.el){$(h.body).append('<div class="ep-links-bubble">'+i+"</div>"),linkBubble.el=$(h.body).find("div.ep-links-bubble");var j=this;linkBubble.el.click(function(a){if(!a.ctrlKey&&a.button!=2&&a.button!=3){var b=a.target;if(b){if((b.tagName||"").toLowerCase()=="a"&&b.href){openLink(b.href),a.preventDefault();return}if((b.tagName||"").toLowerCase()=="span"&&b.getAttribute("rel")){switch(b.getAttribute("rel")){case"change":padEditor.fireEvent("link.dialog"),hideLinkBubble();break;case"remove":j.ace_doRemoveLink(),hideLinkBubble()}return}}}})}else linkBubble.href!=b&&linkBubble.el.html(i);linkBubble.href=b,linkBubble.node=a,linkBubble.isVisible=!0;var k={left:c.pageX,top:c.pageY},l=$(a).offset(),m={display:"",left:k.left+10,top:l.top-10};linkBubble.el.css({top:-1e3,left:-1e3,display:""});var n=$(h.body).innerHeight(),o=$(h.body).innerWidth(),p=16,q=linkBubble.el.outerWidth(),r=linkBubble.el.outerHeight();m.top<0&&(m.top=0),k.left+q>o&&(m.left=o-q),linkBubble.el.css(m),$(document).on("click",hideLinkBubble)}function hideLinkBubble(){linkBubble&&linkBubble.el&&linkBubble.el.css("display","none"),linkBubble&&(linkBubble.isVisible=!1),$(document).off("click",hideLinkBubble)}function getLinkNode(a){while(a&&a.parentNode&&((a.tagName||"").toLowerCase()!="a"||!a.getAttribute("rel")||!a.getAttribute("rel").match(relHrefPrefix)))a=a.parentNode;return a&&(a.tagName||"").toLowerCase()=="a"&&a.getAttribute("rel")&&a.getAttribute("rel").match(relHrefPrefix)&&(a.parentNode.className||"").indexOf("ace-task-link")==-1?a:null}function determineSelection(a){var b=this.ace_getSelection(),c=this.ace_getRep(),d=c.selStart==null?[0,0]:a?c.selStart:[c.selStart[0],c.selStart[1]],e=c.selEnd==null?[0,0]:a?c.selEnd:[c.selEnd[0],c.selEnd[1]],f,g,h,i;b&&b.startPoint&&b.startPoint.node&&(f=getLinkNode(b.startPoint.node),g=f&&f.getAttribute("rel"),h=g&&g.substring(relHrefPrefix.length,g.length)),b&&b.endPoint&&b.endPoint.node&&(f=getLinkNode(b.endPoint.node),g=f&&f.getAttribute("rel"),i=g&&g.substring(relHrefPrefix.length,g.length));var j=h||i||"";j&&(h&&(d[1]-=b.startPoint.index,b.startPoint.index=0),i&&(e[1]+=b.endPoint.maxIndex-b.endPoint.index,b.endPoint.index=b.endPoint.maxIndex),a&&this.ace_setSelection(b));var k={linkValue:j,selStart:d,selEnd:e};return d[0]==e[0]?k.selectedText=c.lines.atIndex(d[0]).text.substring(d[1],e[1]):k.isMultiLine=!0,k}function doInsertLink(a,b,c){var d=this.editorInfo,e=this.editorInfo.ace_getRep();c?d.ace_replaceRange(e.selStart,e.selEnd,a,[["link",b]]):this.documentAttributeManager.setAttributesOnRange(e.selStart,e.selEnd,[["link",b]]),hideLinkBubble()}function doRemoveLink(){this.editorInfo.ace_callWithAce(function(a){a.links_determineSelection(!0),skipURLFilter=!0,a.ace_setAttributeOnSelection("link",null),a.ace_setAttributeOnSelection("url",null),skipURLFilter=!1},"insertlink",!0)}function doEscapeLink(a){return Security.escapeURL(a)}function doValidateLink(a){return Security.validateURL(a)}function onDispose(){linkBubble&&linkBubble.el&&linkBubble.el.remove(),$(document).unbind("click",hideLinkBubble),linkBubble=null,skipURLFilter=!1}var isClient=typeof global!="object",Security=require("ep_etherpad-lite/static/js/security.js"),Ace2Common=require("ep_etherpad-lite/static/js/ace2_common"),_=require("ep_etherpad-lite/static/js/underscore"),browser=Ace2Common.browser,cssFiles=["ep_links/static/css/ep_links.css"],skipURLFilter,ace,relHrefPrefix="eplinks_href",padEditor,baseTpl='<a rel="nofollow noreferrer noopener" target="_blank" title="<% print(obj.Security.escapeHTMLAttribute(linkTitle)) %>" href="<% print(obj.Security.escapeURLWithMailto(href)) %>"><% print(obj.Security.escapeHTML(unescape(visibleHref))) %></a>',linkBubbleTplNoControls=_.template(baseTpl),linkBubbleTpl=_.template(baseTpl+"<span>"+" &ndash; "+'<span class="ep-links-bubble-link" rel="change" unselectable="on">Change</span>'+" | "+'<span class="ep-links-bubble-link" rel="remove" unselectable="on">Remove</span>'+"</span>"),linkBubble;exports.collectContentPre=function(a,b){var c=b.tname,d=b.state,e=b.cc,f=b.node;if(b.cls.indexOf("synced")!==-1)return;if(c=="a"){var g=f.getAttribute("rel");g&&g.match(relHrefPrefix)?g=g.substring(relHrefPrefix.length,g.length):g=null,g?(f.className||"").match("link-forced")&&e.doAttrib(d,{name:"link",val:g}):(g=f.getAttribute("href"),g&&e.doAttrib(d,{name:"link",val:g}))}},exports.aceAttribsToClasses=function(a,b){if(b.key=="link")return"link:"+b.value},exports.aceCreateDomLine=function(a,b){var c,d,e=b.cls;e.indexOf("link")>=0&&(e=e.replace(/(^| )link:(\S+)/g,function(a,b,e){return c=e,d=!0,b+"link"}));if(c)e=e.replace(/(^| )url:(\S+)/g,"");else if(!c&&e.indexOf("url")>=0){if(skipURLFilter)return e=e.replace(/(^| )url:(\S+)/g,""),[{extraOpenTags:"",extraCloseTags:"",cls:e}];e=e.replace(/(^| )url:(\S+)/g,function(a,b,d){return c=d,b+"url"})}if(c){c=$.trim(c||"").substring(0,4e3);while(c.toLowerCase().indexOf("javascript:")===0)c=$.trim(c.substring(11))||"";while(c.toLowerCase().indexOf("data:")===0)c=$.trim(c.substring(5))||"";Security.validateURL(c)||(c="http://"+c);if(~c.indexOf("<script>")){var f=document.createElement("span");f.innerHTML=c,c=f.innerText||f.textContent||f.nodeValue||""}c=Security.escapeHTMLAttribute(c);var g={extraOpenTags:'<a href="'+c+'" rel="'+relHrefPrefix+c+'"'+(d?' class="link-forced"':"")+' target="_blank"'+">"+(browser.msie?"<span>":""),extraCloseTags:(browser.msie?"</span>":"")+"</a>",cls:e};return[g]}return},exports.postAceInit=function(a,b){b.ace.callWithAce(function(a){var b=a.ace_getDocument();try{b.execCommand("enableObjectResizing",!1,"false")}catch(c){}$(b).on(browser.msie||browser.safari?"keydown":"keypress",_(handleKeyEvent).bind(a)),$(b).find("#innerdocbody").on("click",_(handleClick).bind(a))})},exports.aceInitialized=function(a,b){skipURLFilter=!1;var c=b.editorInfo;c.ace_doEscapeLink=_(doEscapeLink).bind(b),c.ace_doValidateLink=_(doValidateLink).bind(b),c.ace_doInsertLink=_(doInsertLink).bind(b),c.ace_doRemoveLink=_(doRemoveLink).bind(b),c.links_determineSelection=_(determineSelection).bind(b.editorInfo),ace=c,padEditor=b.editorInfo.editor;var d=c.ace_dispose;c.ace_dispose=function(){return onDispose(),d.apply(c,arguments)};var e=c.ace_setEditable;c.ace_setEditable=function(a){return a||onDispose(),e.apply(c,arguments)}},exports.aceEditorCSS=function(){return cssFiles}
}
, "ep_headings/static/js/index.js": function (require, exports, module) {
function aceAttribsToClasses(a,b){if(b.key=="heading")return["heading:"+b.value]}function doInsertHeading(a){var b=this.rep,c=this.documentAttributeManager;if(!b.selStart||!b.selEnd||a>=0&&tags[a]===undefined)return;var d,e;d=b.selStart[0],e=Math.max(d,b.selEnd[0]-(b.selEnd[1]===0?1:0)),_(_.range(d,e+1)).each(function(b){a>=0?c.setAttributeOnLine(b,"heading",tags[a]):c.removeAttributeOnLine(b,"heading")})}function aceInitialized(a,b){var c=b.editorInfo;c.ace_doInsertHeading=_(doInsertHeading).bind(b)}function aceEditorCSS(){return cssFiles}var isClient=typeof global!="object",_=require("ep_etherpad-lite/static/js/underscore"),headingClass="heading",cssFiles=["ep_headings/static/css/editor.css"],tags=["h1","h2","h3","h4","h5","h6"],collectContentPre=function(a,b){var c=b.tname,d=b.state,e=d.lineAttributes,f=_.indexOf(tags,c);f>=0&&(e.heading=tags[f])},collectContentPost=function(a,b){var c=b.tname,d=b.state,e=d.lineAttributes,f=_.indexOf(tags,c);f>=0&&delete e.heading},aceRegisterBlockElements=function(){return tags},postAceInit=function(a,b){var c=$("#heading-selection");c.on("change",function(){var a=$(this).val(),d=parseInt(a,10);_.isNaN(d)||(b.ace.callWithAce(function(a){a.ace_doInsertHeading(d)},"insertheading",!0),c.val("dummy"))})},aceDomLineProcessLineAttributes=function(a,b){var c=b.cls,d=b.domline,e=/(?:^| )heading:([A-Za-z0-9]*)/.exec(c),f;e&&(f=_.indexOf(tags,e[1]));if(f!==undefined&&f>=0){var g=tags[f],h={preHtml:"<"+g+">",postHtml:"</"+g+">",processedMarker:!0};return[h]}return[]};exports.aceRegisterBlockElements=aceRegisterBlockElements,exports.collectContentPre=collectContentPre,exports.collectContentPost=collectContentPost,exports.aceInitialized=aceInitialized,exports.postAceInit=postAceInit,exports.aceDomLineProcessLineAttributes=aceDomLineProcessLineAttributes,exports.aceAttribsToClasses=aceAttribsToClasses,exports.aceEditorCSS=aceEditorCSS,exports.ccRegisterBlockElements=aceRegisterBlockElements
}
, "ep_taskhighlight/static/js/highlight.js": function (require, exports, module) {
function handleKeyEvent(a){var b=a.keyCode;this.countBlockNodes=!0,b==8?addSpace=!1:!browser.safari&&[37,38,39,40].indexOf(b)!=-1&&(this.countBlockNodes=!1)}function handleClick(a){this.countBlockNodes=!0;var b=$(a.target),c;if((c=b.parents(".ace-task-link"))&&c.length){var d=c.find("a");if(d.length)if(d.hasClass("resource-link-task")||d.hasClass("resource-link-folder"))padEditor.fireEvent("highlight.internal-link-open",d.attr("href")),window.__resourceTitleUpdater.evaluateUrl(d.attr("href")),a.preventDefault();else try{var e=window.open();e.opener=null,e.location=d.attr("href"),e.focus()}catch(f){}}}var isClient=typeof global!="object",Security=require("ep_etherpad-lite/static/js/security.js"),Ace2Common=require("ep_etherpad-lite/static/js/ace2_common"),_=require("ep_etherpad-lite/static/js/underscore"),browser=Ace2Common.browser,addSpace=!0,doc,ace,padEditor;exports.collectContentPre=function(a,b){var c=b.state,d=b.cc,e=b.ptc,f=b.node,g;f&&f.nodeName.toLowerCase()=="a"&&(g=window.__resourceTitleUpdater.validateUrl(f.getAttribute("href")||""))&&(d.doAttrib(c,{name:"link",val:f.getAttribute("href")}),e.set(f.getAttribute("href")))},exports.aceCreateDomLine=function(a,b){var c=b.txt||"",d,e;return c&&(d=window.__resourceTitleUpdater.validateUrl(c))&&(e=" ace-invisible ace-task-link block-node-"+c.length),d?[{extraOpenTags:"",extraCloseTags:"",cls:e}]:null};var authorRegex=/author-([^\s]+)/;exports.acePostWriteDomLineHTML=function(a,b){var c=$(b.node),d=c.find("a"),e,f;d.each(function(){var a=$(this),b;if(b=window.__resourceTitleUpdater.validateUrl(a.attr("href")||""))a.attr(window.__resourceTitleUpdater.metaAttributeName,b),a.attr("target","_blank"),e=a.parent(),f||(f=a.parent())})},exports.aceEditorCSS=function(){return["ep_taskhighlight/static/css/ep_taskhighlight.css"]},exports.aceEditEvent=function(a,b){},exports.postAceInit=function(a,b){ace=b.ace,ace.callWithAce(function(a){doc=a.ace_getDocument(),$(doc.body).on("keydown",_(handleKeyEvent).bind(a)),$(doc).find("#innerdocbody").on("click",_(handleClick).bind(a))})},exports.aceInitialized=function(a,b){window.__resourceTitleUpdater||(window.__resourceTitleUpdater={validateUrl:function(){return!1},evaluateUrl:function(){return!1},on:function(){return!1},un:function(){return!1}}),padEditor=b.editorInfo.editor}
}
, "ep_images/static/js/images.js": function (require, exports, module) {
function getDataFromAttachmentURL(a){if(a){var b=a.match(attachmentRegex);if(b){var c=b&&b[3];return isNaN(c)&&(c=c.split(".")[0].slice(1)),{attachmentId:c,folderPath:b[2],name:b[7]||""}}}return null}function replaceRangeWith(a,b){if(!currentTarget||!currentTarget[0])return;var c=ace.ace_getLineAndCharForPoint({node:currentTarget[0],index:1,maxIndex:1});c&&ace.ace_replaceRange(c,[c[0],c[1]+1],a,b)}function createBubble(){if(!frameDocument)return;bubble&&bubble.hide(),bubble||(bubble=$('<div class="ep-images-bubble menu-shown"><div class="ep-image-bubble-pimp"></div><div class="ep-image-bubble-menu"><a class="ep-images-bubble-preview"><span></span><i>Preview</i></a><a class="ep-images-bubble-enlarge"><span></span><i>Expand</i></a><a class="ep-images-bubble-remove"><span></span><i>Delete</i></a></div></div>'),bubble=$(unwrap(bubble[0])),bubble.menu=bubble.find(".ep-image-bubble-menu"),bubble.on("click",function(a){var b=$(a.target),c=!1;if(b.is(".ep-image-bubble-pimp"))bubble.toggleClass("menu-shown");else if(b.is(".ep-images-bubble-enlarge")||b.parent().is(".ep-images-bubble-enlarge")){if(!lastImageInfo.enlargable)return;lastImageInfo.isMinimized?replaceRangeWith("|",[["img","/attachments/"+lastImageInfo.id+(lastImageInfo.name?"/"+encodeURIComponent(lastImageInfo.name):"")]]):replaceRangeWith("|",[["img","/filemeta/thumb100/"+lastImageInfo.id+(lastImageInfo.name?"/"+encodeURIComponent(lastImageInfo.name):"")]]),c=!0}else if(b.is(".ep-images-bubble-remove")||b.parent().is(".ep-images-bubble-remove"))replaceRangeWith(""),c=!0;else if(b.is(".ep-images-bubble-preview")||b.parent().is(".ep-images-bubble-preview"))_onImageOpen(lastImageInfo.node),c=!0;c&&(a.preventDefault(),bubble.hide())}),bubble.on("mouseenter",function(){clearTimeout(hideTimeout)}),bubble.menu.on("mouseenter",function(){clearTimeout(hideTimeout)}),bubble.on("mouseleave",function(){clearTimeout(hideTimeout),hideTimeout=setTimeout(function(){bubble&&bubble.hide()},200)}),bubble.menu.on("mouseleave",function(){clearTimeout(hideTimeout),hideTimeout=setTimeout(function(){bubble&&bubble.hide()},200)}),frameDocument.appendChild(unwrap(bubble[0])),bubble.show(),bubble.menuWidth=bubble.menu.width()),bubble.find(".ep-images-bubble-enlarge")[lastImageInfo.enlargable?"show":"hide"](),lastImageInfo.enlargable&&(bubble.find(".ep-images-bubble-enlarge i").html(lastImageInfo.isMinimized?"Expand":"Minimize"),bubble.find(".ep-images-bubble-enlarge")[lastImageInfo.isMinimized?"removeClass":"addClass"]("ep-images-bubble-enlarge-minimize"))}function insertUploadProgressBar(a){this.ace_focus(),this.ace_replaceRange(undefined,undefined,"|",[["loader","0"],["id",a]],!0)}function updateUploadProgressBar(a,b){var c=$(innerFrameDocument).find("#"+a).get(0),d=Math.floor(b*100),e=c&&this.ace_getLineAndCharForPoint({node:c,index:1,maxIndex:1});if(!e)return;this.ace_applyAttributesToRange(e,[e[0],e[1]+1],[["loader",""+d]],!0)}function removeUploadProgressBar(a){var b=$(innerFrameDocument).find("#"+a).get(0),c=b&&this.ace_getLineAndCharForPoint({node:b,index:1,maxIndex:1});if(!c)return;this.ace_replaceRange(c,[c[0],c[1]+1],"",null,!0)}function finalizeUploadProgress(a,b){var c=$(innerFrameDocument).find("#"+a).get(0),d=c&&this.ace_getLineAndCharForPoint({node:c,index:1,maxIndex:1});if(!d)return;this.ace_replaceRange(d,[d[0],d[1]+1],"|",[["img",b]])}function _getImageOrder(){var a=[],b=ace.ace_getImageUrls();for(var c=0;c<b.length;c++){var d=b[c],e=getDataFromAttachmentURL(d);a.push(e.attachmentId)}return a}function _onImageOpen(a){var b={},c=a.src,d=getDataFromAttachmentURL(c);if(d){var e=d.attachmentId;e&&(b.id=e,b.title=decodeURIComponent(d.name)||decodeURIComponent(c),b.imageOrder=_getImageOrder())}padEditor.fireEvent("open.image",b)}var Security=require("ep_etherpad-lite/static/js/security.js"),_=require("ep_etherpad-lite/static/js/underscore"),cssFiles=["ep_images/static/css/ep_images.css"],bubble,currentTarget,currentWrapper,ace,padEditor,frameDocument,innerFrameDocument,attachmentRegex=/(.*)(thumb100|attachments)\/((\d+)|(F\d+\.A\d+))(\/(.*))?/,hideTimeout,lastImageInfo={node:null,id:null,name:"",enlargable:!1,isMinimized:!1};exports.aceInitialized=function(a,b){innerFrameDocument=b.editorInfo.ace_getDocument(),ace=b.editorInfo,frameDocument=b.editorInfo.frame.contentWindow.document.body,padEditor=b.editorInfo.editor,ace.images_insertUploadProgressBar=_(insertUploadProgressBar).bind(ace),ace.images_updateUploadProgressBar=_(updateUploadProgressBar).bind(ace),ace.images_removeUploadProgressBar=_(removeUploadProgressBar).bind(ace),ace.images_finalizeUploadProgress=_(finalizeUploadProgress).bind(ace);var c=b.editorInfo.ace_dispose;b.editorInfo.ace_dispose=function(){return bubble&&(bubble.remove(),bubble=null),c.apply(b.editorInfo,arguments)},$(innerFrameDocument).on("mouseup","img",function(a){_onImageOpen(a.target),a.preventDefault()}),$(innerFrameDocument).on("mouseleave",'span[class^="imagewrapper"]',function(){clearTimeout(hideTimeout),hideTimeout=setTimeout(function(){bubble&&bubble.hide()},200)}),$(innerFrameDocument).on("mousemove",'span[class^="imagewrapper"]',function(){if(currentWrapper===this&&bubble&&bubble.is(":visible")){clearTimeout(hideTimeout);return}var a=$(this),b=a.find("img"),c;if(!b.length)return;clearTimeout(hideTimeout),currentTarget=b,currentWrapper=this,lastImageInfo.enlargable=!1,lastImageInfo.node=b[0],lastImageInfo.name=b.attr("src");var d=currentTarget.attr("src"),e=d.length<1e3;if(e&&(c=getDataFromAttachmentURL(d))&&c.folderPath&&c.attachmentId){var f=currentTarget[0].width,g=currentTarget[0].height;lastImageInfo.id=c.attachmentId,lastImageInfo.name=c.name,lastImageInfo.isMinimized=c.folderPath==="thumb100",lastImageInfo.enlargable=!lastImageInfo.isMinimized||lastImageInfo.isMinimized&&(f===100||g===100)}if(ace.ace_isEditable()){createBubble();var h=a.offset(),i=h.left+a.width()-20,j={display:"",left:i,top:h.top+2},k={right:1,top:3};j.left+15-bubble.menuWidth<0&&(k.right-=bubble.menuWidth-j.left-15),bubble.removeClass("menu-shown"),bubble.css(j),bubble.menu.css(k)}})},exports.aceEditorCSS=function(){return cssFiles},exports.collectContentPre=function(a,b){var c=b.tname,d=b.node,e=b.cls;c==="img"&&(d.src.indexOf("webkit-fake-url")===0?(padEditor.fireEvent("image.upload.fail"),b.cAttribs.cancelCollection=!0):b.lines.appendAttrTextToApool("|",[["img",d.src]]));if(c==="span"&&e.indexOf("etherpad-loader")!==-1){var f=0;e=e.replace(/(^| )etherpad\-loader\-percent\-(\S+)/g,function(a,b,c){f=c});var g=[["loader",""+f]];d.id&&g.push(["id",d.id]),b.lines.appendAttrTextToApool("|",g)}},exports.aceCreateDomLine=function(a,b){var c=b.spanData||{},d=b.html;if(c.img){var e=c.img,f=(e||"").replace("https://www.wrike.com",""),g="imagewrapper-clean";return f.indexOf("/filemeta/thumb100")===0&&(g="imagewrapper-wrap"),e=Security.escapeHTMLAttribute(e),d.push('<span class="'+g+' block-node-1" unselectable="on" contenteditable="false">','<img src="'+e+'" />',"</span>"),{dontAppendText:!0}}return c.id&&c.loader?(d.push('<span id="'+c.id+'" class="block-node-1 etherpad-loader etherpad-loader-percent-'+c.loader+'" unselectable="on" contenteditable="false">','<span class="etherpad-loader-bar" style="width: '+c.loader+'%"></span>',"</span>"),{dontAppendText:!0}):null},exports.getDataFromAttachmentURL=getDataFromAttachmentURL
}
, "ep_tables/static/js/tables.js": function (require, exports, module) {
var Security=require("ep_etherpad-lite/static/js/security.js"),isClient=typeof global!="object",Widget=require("ep_etherpad-lite/static/js/widget").Widget,ace;exports.aceInitialized=function(a,b){ace=b.editorInfo},exports.collectContentPre=function(a,b){var c=b.tname,d=b.node;if(c==="table"){var e=d.getElementsByTagName("td"),f,g=-1,h=0,i=[];for(var j=0,k;k=e[j];j++)k.parentNode!==f&&(g++,h=0,f=k.parentNode),i.push([g+":"+h++,k.innerText||k.textContent||k.nodeValue||""]);i.length&&(b.lines.appendAttrTextToApool("|",i),b.cc.startNewLine(b.state),b.cAttribs.cancelCollection=!0)}},exports.aceCreateDomLine=function(a,b){var c=b.spanData||{},d=b.result,e=b.cls,f=[],g=0;for(var h in c){var i;(i=h.split(":"))&&i.length===2&&(f[i[0]]||(f[i[0]]=[]),f[i[0]][i[1]]=c[h],f[i[0]].length>g&&(g=f[i[0]].length))}if(!g)return null;var j,k,l;for(j=0,k=f.length;j<k;j++)f[j]||(f[j]=[]),f[j].length=g;if(isClient){if(b.onlyHtml){var m=["<table>"];for(j=0,l=f.length||1;j<l;j++)if(f[j]){m.push("<tr>");for(var n=0,o=f[j].length;n<o;n++){var p=Security.escapeHTML(f[j][n]||"");m.push("<td>"+p+"</td>")}m.push("</tr>")}m.push("</table>");var q={extraOpenTags:m.join(""),extraCloseTags:"",hiddenSymbol:!0};return[q]}var r=new Widget(ace,{initialData:f,domline:d,checkAttribs:function(a){var b=a[0][0].split(":");return b&&b.length===2?!0:!1}}),s=r.getDataForDomline({initialHeight:"38px"});return s.cls+=" "+e,s}}
}
, "ep_tasklist/static/js/tasklist.js": function (require, exports, module) {
function aceInitialized(a,b){var c=b.editorInfo;ace=c,documentAttributeManager=b.documentAttributeManager,c.ace_doInsertTaskList=_(exports.tasklist.doInsertTaskList).bind(b),c.ace_doToggleTaskListItem=_(exports.tasklist.doToggleTaskListItem).bind(b),padEditor=b.editorInfo.editor}var _=require("ep_etherpad-lite/static/js/underscore"),padEditor,documentAttributeManager,tags=["tasklist-not-done","tasklist-done"],_Y=String.fromCharCode(10003),_N=String.fromCharCode(9633),reChecked=new RegExp("^(\\*)?(\\s|&nbsp;)?("+_Y+"|&#10003;)"),reUnchecked=new RegExp("^(\\*)?(\\s|&nbsp;)?("+_N+"|&#9633;)"),iOSdevice=/iPad|iPhone|iPod/.test(navigator.userAgent),ace;exports.tasklist={init:function(a){a.ace.callWithAce(function(a){var b=a.ace_getDocument(),c="click";iOSdevice&&(c+=" touchstart"),$(b).find("#innerdocbody").on(c,_(exports.tasklist.doUpdateTaskList).bind(a))},"tasklist",!0)},doInsertTaskList:function(){if(!ace.ace_isEditable())return;var a=this.rep,b=this.documentAttributeManager;if(!a.selStart||!a.selEnd)return;var c=a.selStart[0],d=Math.max(c,a.selEnd[0]-(a.selEnd[1]===0?1:0));_(_.range(c,d+1)).each(function(a){var c=b.getAttributeOnLine(a,"tasklist");c?b.removeAttributeOnLine(a,"tasklist"):(b.setAttributeOnLine(a,"tasklist","N"),b.setAttributeOnLine(a,"list","bullet1"))})},doToggleTaskListItem:function(a){if(!ace.ace_isEditable())return;var b=this.rep;a===undefined&&(a=b.selEnd[0]);var c=this.documentAttributeManager;c.setAttributeOnLine(a,"tasklist",c.getAttributeOnLine(a,"tasklist")==="Y"?"N":"Y"),c.setAttributeOnLine(a,"list","bullet1")},doUpdateTaskList:function(a){if(!ace.ace_isEditable())return;var b=$(a.target),c=b.hasClass("tasklist-not-done")||b.hasClass("tasklist-done"),d;if(c){var e=b.parent();d=e.parent().find(">div").index(e),padEditor.callWithAce(function(a){a.ace_doToggleTaskListItem(d)},"tasklist",!0)}}};var aceNewLineList=function(a,b){var c=documentAttributeManager.getAttributeOnLine(b.lineNum,"tasklist");c&&documentAttributeManager.setAttributeOnLine(b.lineNum+1,"tasklist","N")},aceAttribsToClasses=function(a,b){if(b.key==="tasklist")return[" alc:"+(b.value==="Y"?"tasklist-done":"tasklist-not-done")+" hide-bullets"]};exports.aceInitialized=aceInitialized,exports.aceAttribsToClasses=aceAttribsToClasses,exports.aceNewLineList=aceNewLineList,exports.aceEditorCSS=function(a,b){return["ep_tasklist/static/css/tasklist.css"]},exports.postAceInit=function(a,b){exports.tasklist.init(b)},exports.collectContentPre=function(a,b){var c=b.node;c&&c.className&&(~c.className.indexOf("tasklist-not-done")||~c.className.indexOf("tasklist-done"))?(b.state.lineAttributes.tasklist=~c.className.indexOf("tasklist-done")?"Y":"N",b.state.lineAttributes.list="bullet1",b.cAttribs.skipList=!0):b.tname==="input"&&c.getAttribute("type")==="checkbox"&&(b.state.lineAttributes.tasklist=c.getAttribute("checked")?"Y":"N",b.state.lineAttributes.list="bullet1",b.cAttribs.skipList=!0)},exports.collectTextContentPre=function(a,b){var c=b.text||"";reChecked.test(c)?(b.text=c.replace(reChecked,""),b.state.lineAttributes.tasklist="Y",b.state.lineAttributes.list="bullet1",b.cAttribs.skipList=!0):reUnchecked.test(c)&&(b.text=c.replace(reUnchecked,""),b.state.lineAttributes.tasklist="N",b.state.lineAttributes.list="bullet1",b.cAttribs.skipList=!0)}
}
, "ep_colors/static/js/index.js": function (require, exports, module) {
function aceAttribsToClasses(a,b){if(b.key=="color")return["color-"+b.value.replace("#","")]}function doColorize(a){var b=this.rep,c=this.documentAttributeManager;if(!b.selStart||!b.selEnd)return;c.setAttributesOnRange(b.selStart,b.selEnd,[["color",a||null]])}function aceInitialized(a,b){var c=b.editorInfo;c.ace_doColorize=_(doColorize).bind(b)}function aceEditorCSS(){return cssFiles}var isClient=typeof global!="object",Security=require("ep_etherpad-lite/static/js/security.js"),_=require("ep_etherpad-lite/static/js/underscore"),cssFiles=["ep_headings/static/css/editor.css"],colorsHash={ALICEBLUE:"#F0F8FF",ANTIQUEWHITE:"#FAEBD7",AQUA:"#00FFFF",AQUAMARINE:"#7FFFD4",AZURE:"#F0FFFF",BEIGE:"#F5F5DC",BISQUE:"#FFE4C4",BLACK:"#000000",BLANCHEDALMOND:"#FFEBCD",BLUE:"#0000FF",BLUEVIOLET:"#8A2BE2",BROWN:"#A52A2A",BURLYWOOD:"#DEB887",CADETBLUE:"#5F9EA0",CHARTREUSE:"#7FFF00",CHOCOLATE:"#D2691E",CORAL:"#FF7F50",CORNFLOWERBLUE:"#6495ED",CORNSILK:"#FFF8DC",CRIMSON:"#DC143C",CYAN:"#00FFFF",DARKBLUE:"#00008B",DARKCYAN:"#008B8B",DARKGOLDENROD:"#B8860B",DARKGRAY:"#A9A9A9",DARKGREEN:"#006400",DARKKHAKI:"#BDB76B",DARKMAGENTA:"#8B008B",DARKOLIVEGREEN:"#556B2F",DARKORANGE:"#FF8C00",DARKORCHID:"#9932CC",DARKRED:"#8B0000",DARKSALMON:"#E9967A",DARKSEAGREEN:"#8FBC8F",DARKSLATEBLUE:"#483D8B",DARKSLATEGRAY:"#2F4F4F",DARKTURQUOISE:"#00CED1",DARKVIOLET:"#9400D3",DEEPPINK:"#FF1493",DEEPSKYBLUE:"#00BFFF",DIMGRAY:"#696969",DODGERBLUE:"#1E90FF",FIREBRICK:"#B22222",FLORALWHITE:"#FFFAF0",FORESTGREEN:"#228B22",FUCHSIA:"#FF00FF",GAINSBORO:"#DCDCDC",GHOSTWHITE:"#F8F8FF",GOLD:"#FFD700",GOLDENROD:"#DAA520",GRAY:"#808080",GREEN:"#008000",GREENYELLOW:"#ADFF2F",HONEYDEW:"#F0FFF0",HOTPINK:"#FF69B4",INDIANRED:"#CD5C5C",INDIGO:"#4B0082",IVORY:"#FFFFF0",KHAKI:"#F0E68C",LAVENDER:"#E6E6FA",LAVENDERBLUSH:"#FFF0F5",LAWNGREEN:"#7CFC00",LEMONCHIFFON:"#FFFACD",LIGHTBLUE:"#ADD8E6",LIGHTCORAL:"#F08080",LIGHTCYAN:"#E0FFFF",LIGHTGOLDENRODYELLOW:"#FAFAD2",LIGHTGRAY:"#D3D3D3",LIGHTGREEN:"#90EE90",LIGHTPINK:"#FFB6C1",LIGHTSALMON:"#FFA07A",LIGHTSEAGREEN:"#20B2AA",LIGHTSKYBLUE:"#87CEFA",LIGHTSLATEGRAY:"#778899",LIGHTSTEELBLUE:"#B0C4DE",LIGHTYELLOW:"#FFFFE0",LIME:"#00FF00",LIMEGREEN:"#32CD32",LINEN:"#FAF0E6",MAGENTA:"#FF00FF",MAROON:"#800000",MEDIUMAQUAMARINE:"#66CDAA",MEDIUMBLUE:"#0000CD",MEDIUMORCHID:"#BA55D3",MEDIUMPURPLE:"#9370DB",MEDIUMSEAGREEN:"#3CB371",MEDIUMSLATEBLUE:"#7B68EE",MEDIUMSPRINGGREEN:"#00FA9A",MEDIUMTURQUOISE:"#48D1CC",MEDIUMVIOLETRED:"#C71585",MIDNIGHTBLUE:"#191970",MINTCREAM:"#F5FFFA",MISTYROSE:"#FFE4E1",MOCCASIN:"#FFE4B5",NAVAJOWHITE:"#FFDEAD",NAVY:"#000080",OLDLACE:"#FDF5E6",OLIVE:"#808000",OLIVEDRAB:"#6B8E23",ORANGE:"#FFA500",ORANGERED:"#FF4500",ORCHID:"#DA70D6",PALEGOLDENROD:"#EEE8AA",PALEGREEN:"#98FB98",PALETURQUOISE:"#AFEEEE",PALEVIOLETRED:"#DB7093",PAPAYAWHIP:"#FFEFD5",PEACHPUFF:"#FFDAB9",PERU:"#CD853F",PINK:"#FFC0CB",PLUM:"#DDA0DD",POWDERBLUE:"#B0E0E6",PURPLE:"#800080",RED:"#FF0000",ROSYBROWN:"#BC8F8F",ROYALBLUE:"#4169E1",SADDLEBROWN:"#8B4513",SALMON:"#FA8072",SANDYBROWN:"#F4A460",SEAGREEN:"#2E8B57",SEASHELL:"#FFF5EE",SIENNA:"#A0522D",SILVER:"#C0C0C0",SKYBLUE:"#87CEEB",SLATEBLUE:"#6A5ACD",SLATEGRAY:"#708090",SNOW:"#FFFAFA",SPRINGGREEN:"#00FF7F",STEELBLUE:"#4682B4",TAN:"#D2B48C",TEAL:"#008080",THISTLE:"#D8BFD8",TOMATO:"#FF6347",TURQUOISE:"#40E0D0",VIOLET:"#EE82EE",WHEAT:"#F5DEB3",WHITE:"#FFFFFF",WHITESMOKE:"#F5F5F5",YELLOW:"#FFFF00",YELLOWGREEN:"#9ACD32"},collectContentPre=function(a,b){var c=b.state,d=b.cc;if(b.styl){var e=getColor(b.styl);e&&d.doAttrib(c,{name:"color",val:e})}},getColor=function(a){var b=getBackgroundColor(a),c;if(!b)return!1;if(~b.indexOf("RGBA"))c=convertRgbaToRgb(b),b=findNearestColor(c);else if(~b.indexOf("RGB"))c=b.replace(/RGB\s*\(/i,"").replace(")","").split(",",3),b=findNearestColor(c);else{if(!~b.indexOf("#")||b==="#FFFFFF")return!1;var d=b.replace("#","").match(/\S{2}/g);if(d.length!==3)return!1;c=_.map(d,function(a){return parseInt(a,16)}),b=findNearestColor(c)}return b==="#FFFFFF"?!1:b},convertRgbaToRgb=function(a){var b=a.replace(/RGBA\s*\(/i,"").replace(")","").split(",",4),c=[255,255,255],d=b[3];return[(1-d)*c[0]+d*b[0],(1-d)*c[1]+d*b[1],(1-d)*c[2]+d*b[2]]},getBackgroundColor=function(a){var b=/background-color:\s*([^;]+)/g.exec(a);if(!b||!b[1]){b=/background:\s*([^;]+)/g.exec(a);if(!b||!b[1])return!1}b=b[1].toUpperCase().replace(";","");var c=0,d,e;d=/RGB[^\)]+\)/g.exec(b);if(d&&d[0])return d[0];d=/#\S{3,6}/g.exec(b);if(d&&d[0]){if(d[0].length==4){var f="#";for(var c=1,g=d[0].length;c<g;c++)f+=d[0][c]+d[0][c]+"";d[0]=f}return d[0]}var h=b.split(" ");for(;e=h[c];++c)if(colorsHash[e]){d=colorsHash[e];break}return d},findNearestColor=function(a){var b=[[226,187,0],[70,191,255],[241,88,102],[150,106,240],[135,212,29],[61,72,94],[255,255,255]],c=1e6,d,e,f;if(a.length!==3)return"#FFFFFF";for(var g=0;d=b[g];++g)f=30*(a[0]-d[0])*(a[0]-d[0])+59*(a[1]-d[1])*(a[1]-d[1])+11*(a[2]-d[2])*(a[2]-d[2]),f<c&&(e=b[g],c=f);var h=_.map(e,function(a){var b=parseInt(a,10).toString(16);return b.length==1?"0"+b:b});return"#"+h.join("").toUpperCase()},convertColor=function(a){var b={CEA70A:"E2BB00","2985E0":"46BFFF",E40505:"F15866","9244F0":"966AF0","6ABB11":"87D41D","000000":"3D485E",FFFFFF:"FFFFFF"};return b[a.toUpperCase()]||a.toUpperCase()},aceCreateDomLine=function(a,b){var c=b.cls,d="";c.indexOf("color")>=0&&(c=c.replace(/(^| )color-(\S+)/g,function(a,b,c){return d=c,b+"color"}));if(d){var e=d==="FFFFFF"?"":"background-color: #"+convertColor(d)+" !important; color: #fff";e=Security.escapeHTMLAttribute(e);var f={extraOpenTags:'<span style="'+e+'">',extraCloseTags:"</span>",cls:c};return[f]}},postAceInit=function(a,b){};exports.collectContentPre=collectContentPre,exports.aceCreateDomLine=aceCreateDomLine,exports.aceInitialized=aceInitialized,exports.postAceInit=postAceInit,exports.aceAttribsToClasses=aceAttribsToClasses,exports.aceEditorCSS=aceEditorCSS
}
, "ep_etherpad-lite/static/js/pad": null
, "ep_etherpad-lite/static/js/pad_utils": null
, "ep_etherpad-lite/static/js/pad_cookie": null
, "ep_etherpad-lite/static/js/Observable": null
, "ep_etherpad-lite/static/js/BackOff": null
, "ep_etherpad-lite/static/js/pad_editor": null
, "ep_etherpad-lite/static/js/pad_cursorhandler": null
, "ep_etherpad-lite/static/js/pad_editbar": null
, "ep_etherpad-lite/static/js/ace": null
, "ep_etherpad-lite/static/js/collab_client": null
, "ep_etherpad-lite/static/js/connection": null
, "ep_etherpad-lite/static/js/widget": null
, "ep_links/static/js/links": null
, "ep_headings/static/js/index": null
, "ep_taskhighlight/static/js/highlight": null
, "ep_images/static/js/images": null
, "ep_tables/static/js/tables": null
, "ep_tasklist/static/js/tasklist": null
, "ep_colors/static/js/index": null
});
;window.__etherpadLegacy = {'require': require};})();


if (!!__originalDefine) {
  define = __originalDefine;
  __originalDefine = undefined; 
}
if (!!__originalRequireJs) {
  requirejs = __originalRequireJs;
  __originalRequireJs = undefined; 
}